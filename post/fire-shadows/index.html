<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "/"
        },
        "articleSection" : "post",
        "name" : "Humans and forests in a changing sea of fire",
        "headline" : "Humans and forests in a changing sea of fire",
        "description" : "This is a study recently completed by one of my MSc students, Annabelle Rogers, who I co-supervised with Prof Ed February and Glenn Moncrieff. We’re busy writing it up for publication, but here’s a little preview.
The study was inspired by this great paper published by Dr Coert Geldenhuys in 1994, explaining how fire determines the distribution of forests in the Southern Cape. You can also read about it, and get a nice intro to our forests, in this interesting SA Forestry Online article.",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2017",
        "datePublished": "2017-06-28 00:00:00 &#43;0000 UTC",
        "dateModified" : "2017-06-28 00:00:00 &#43;0000 UTC",
        "url" : "/post/fire-shadows/",
        "wordCount" : "2434",
        "image" : //img/forestyoung.jpg",
        "keywords" : [ "Blog" ]   
    }
    </script>


 <title>Humans and forests in a changing sea of fire </title>


<meta name="description" content="Ecological research and global change in South Africa" />



<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">
<link rel="stylesheet" href="/css/font-awesome.min.css" type='text/css' media='all'>

<link href="/css/style.css" rel="stylesheet" id="theme-stylesheet" type='text/css' media='all'>

<link href="/css/custom.css" rel="stylesheet" type='text/css' media='all'>
<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="/img/favicon.ico" type="image/x-icon">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-97038958-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>


<body class="post-template-default single single-post single-format-standard ct-body singular singular-post not-front standard">

  <div id="overflow-container" class="overflow-container">
    <a class="skip-content" href="#main">Skip to content</a>
    <header id="site-header" class="site-header" role="banner">
      <div class='top-navigation'>
        <div class='container'>

  <div id="menu-secondary" class="menu-container menu-secondary" role="navigation">
    <button id="toggle-secondary-navigation" class="toggle-secondary-navigation"><i class="fa fa-plus"></i></button>

    <div class="menu">

      <ul id="menu-secondary-items" class="menu-secondary-items">
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/interest">Interest</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/r-tutorials">R Tutorials</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/research">Research</a>
        </li>
        

      </ul>

    </div>

  </div>


  <ul class="social-media-icons">


    

    

    
    <li>
      <a href="https://twitter.com/JasperSlingsby" data-animate-hover="pulse" class="twitter" target="_blank">
        <i class="fa fa-twitter-square" title="twitter"></i>
        <span class="screen-reader-text">twitter</span>
      </a>
    </li>
    

    

    
    <li>
      <a href="mailto:jslingsby@gmail.com" data-animate-hover="pulse" class="email">
        <i class="fa fa-envelope" title="email"></i>
        <span class="screen-reader-text">email</span>
      </a>
    </li>
    

    

    


    
    <li>
      <a href="https://github.com/jslingsby/" data-animate-hover="pulse" class="github" target="_blank">
        <i class="fa fa-github" title="github"></i>
        <span class="screen-reader-text">github</span>
      </a>
    </li>
    


    

    
    <li>
      <a href="/index.xml" data-animate-hover="pulse" class="rss" target="_blank">
        <i class="fa fa-rss" title="rss"></i>
        <span class="screen-reader-text">rss</span>
      </a>
    </li>
    


  </ul></div>

      </div>

      <div class="container">
        <div id="title-info" class="title-info">
  <div id='site-title' class='site-title'>
    
    <a href="/"> Jasper Slingsby </a>
    </div>
  </div>
  <button id="toggle-navigation" class="toggle-navigation">
    <i class="fa fa-bars"></i>
  </button>

  <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
  <div id="menu-primary" class="menu-container menu-primary" role="navigation">
    
    <p class="site-description">Ecologist</p>
    

    <div class="menu">
      <ul id="menu-primary-items" class="menu-primary-items">
        
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/">Home</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/about/">About</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/research/">Research</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/students/">Students</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/publications/">Publications</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/contact/">Contact</a>
          
        </li>
        
      </ul>
    </div>

  </div>

      </div>
    </header>

    <div id="main" class="main" role="main">

      
  
  
    
  
  
  <div id="loop-container" class="loop-container">
    
    <div class="post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-standard-2 tag-tagalicious tag-travel entry full-without-featured odd excerpt-1">

      <div class='featured-image lazy lazy-bg-image'  data-background="/img/forestyoung.jpg">
      </div>
      
        <div class="entry-meta">
          <span class="date">28 June</span>	<span> / </span>

          <span class="author">
            <a href="/" title="Posts by " rel="author"></a>
          </span>


          
          <span class="category">
            <span> / </span>

            <a href="/categories/Research">Research</a>
          </span>
          
          <span class="category">
            <span> / </span>

            <a href="/categories/R%20Tutorials">R Tutorials</a>
          </span>
          


        </div>
        <div class='entry-header'>
          <h1 class='entry-title'> Humans and forests in a changing sea of fire</h1>
        </div>
        <div class="entry-container">
          <div class="entry-content">
            <article>
              <center>
<img src="/img/scienceinprogress/sip1.jpg" />
</center>
<p>This is a study recently completed by one of my MSc students, Annabelle Rogers, who I co-supervised with Prof <a href="http://www.biologicalsciences.uct.ac.za/bio/staff/academic/february"><strong>Ed February</strong></a> and <a href="https://scholar.google.co.za/citations?user=_FFdaCUAAAAJ&amp;hl=en"><strong>Glenn Moncrieff</strong></a>. We’re busy writing it up for publication, but here’s a little preview.</p>
<p>The study was inspired by <a href="https://researchspace.csir.co.za/dspace/handle/10204/2045"><strong>this great paper</strong></a> published by Dr Coert Geldenhuys in 1994, explaining how fire determines the distribution of forests in the Southern Cape. You can also read about it, and get a nice intro to our forests, in this interesting <a href="http://saforestryonline.co.za/articles/southern-cape-forests-survive-largely-unchanged-for-centuries/"><strong>SA Forestry Online article</strong></a>.</p>
<p>The premise of the Geldenhuys study was that certain parts of the landscape are protected from fire due to topographic features interacting with the prevailing winds to create “fire shadows”, where fires will rarely occur. Forests establish and expand in these areas, but are periodically “trimmed back” when severe conditions allow fires to burn into the otherwise non-flammable forest edge.</p>
<p>Our hypothesis, beyond confirming the work by Geldenhuys, was that land cover transformation (e.g. urban expansion) is altering the flow of fire through the landscape and creating new or larger fire shadows.</p>
<p>The footprint of the City of Cape Town has expanded quite drastically since the 1940s, providing a good site for this study. Here’s a little Youtube clip I put together using the 1:50 000 topo maps of the City made available by OpenStreetMaps <a href="http://htonl.dev.openstreetmap.org/50k-ct/#11/-34.1232/18.7066/c2010"><strong>here</strong></a>.</p>
<p><a href="https://youtu.be/qmscq6-25z0"><img src="https://i.ytimg.com/vi/qmscq6-25z0/0.jpg" alt="city of cape town" /></a></p>
<p>Another advantage is that <a href="https://www.researchgate.net/profile/Zoe_Poulsen/publication/279234745_Changes_in_the_distribution_of_indigenous_forest_in_Table_Mountain_National_Park_during_the_20th_Century/links/57a9c7b508aef300152aa8b3.pdf"><strong>Zoë Poulsen and Timm Hoffman</strong></a> mapped the change in indigenous forest extent in Table Mountain National Park over the period 1944 to 2008, providing the perfect dataset to validate our models and test our hypothesis.</p>
<p>So, we set Annabelle the task of modelling fire on the Cape Peninsula with and without (i.e. pre-settlement) transformation, to identify areas where the probability of burning may have been affected. This gives us a map of “change in burn probability” and highlights areas that have become fire shadows, which we can compare to the change in forest extent.</p>
<p>I’m not going to go into the details of the fire modelling, including topographic features, developing a fuel model, wind fields and iterations of random ignitions. If you’d like to know more, you’ll have to wait for the paper. Here I present the burn probability maps and quantify the change in burn probability in relation to forest expansion.</p>
<p>First, let’s look at the reduction in burn probabilities when we “disrupt” the fire catchments by making the transformed areas non-flammable. I’ll only present the simple case where we use a homogenous fuel model - i.e. all vegetation burns on the Peninsula in the same way. In reality the vegetation types can differ in flammability quite considerably, especially fynbos vs forest.</p>
<p>Here we present the burn probabilities without transformation, the burn probabilities with transformation, and the difference between the two.</p>
<p><strong>NOTE</strong>: I present the code from the R statistical programming language used to do the analysis. Just skip these if you are only interested in the story. I’ve tried to write this so that it makes sense without the code, but include the code for Annabelle and other students interested in performing this kind of analysis. Send me a comment below or <a href="http://www.ecologi.st/contact/"><strong>email</strong></a> if you feel I haven’t got this right. The code appears in grey boxes, and the output of the code appears either as the images or grey boxes with all lines preceeded by “##”.</p>
<pre class="r"><code>library(raster)
library(rgdal)
library(spBayes)
library(rgeos)
library(dplyr)
library(ggplot2)
library(cleangeo)

datwd &lt;- &quot;/Users/jasper/Dropbox/SAEON/Projects/Cape Peninsula/FireShadow/&quot;

#Get and stack files
change &lt;- raster(paste0(datwd,&quot;BP/changeHomog_clip.asc&quot;))
proj4string(change) &lt;- &quot;+proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;
transformed &lt;- raster(paste0(datwd,&quot;BP/trans_homog_clip.asc&quot;))
proj4string(transformed) &lt;- &quot;+proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;
untransformed &lt;- raster(paste0(datwd,&quot;BP/untrans_homog_clip.asc&quot;))
proj4string(untransformed) &lt;- &quot;+proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;
untransformed &lt;- projectRaster(untransformed, transformed)

bp &lt;- stack(untransformed, transformed, change)

par(mfrow=c(1,3))
plot(bp[[1]], main = &quot;Untransformed&quot;, col = rev(heat.colors(100)))
plot(bp[[2]], main = &quot;Transformed&quot;, col = rev(heat.colors(100)))
plot(bp[[3]], main = &quot;Change (U - T)&quot;, col = rev(heat.colors(100)))</code></pre>
<p><img src="/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>par(mfrow=c(1,1))</code></pre>
<p>So higher, “redder” values represent a greater probability of burning, but note that positive values in the “change” layer represent reduced burn probability, because it represents the difference <em>Untransformed - Transformed</em>. Also note that the funny numbers around the border are metres from the South Pole (y-axis) and from the Greenwich Meridian (x-axis), because the data are projected with the <a href="https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system"><strong>UTM 34S coordinate reference system</strong></a>.</p>
<p>Where’s your house?</p>
<p>Now let’s get the forest change layers from Poulsen and Hoffman 2015 and plot forest change around Table Mountain.</p>
<pre class="r"><code>f1944 &lt;- readOGR(paste0(datwd, &quot;forest/forestUTM1944.shp&quot;), &quot;forestUTM1944&quot;) #Get the layers</code></pre>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/jasper/Dropbox/SAEON/Projects/Cape Peninsula/FireShadow/forest/forestUTM1944.shp&quot;, layer: &quot;forestUTM1944&quot;
## with 224 features
## It has 7 fields</code></pre>
<pre class="r"><code>f2008 &lt;- readOGR(paste0(datwd, &quot;forest/forestUTM2008.shp&quot;), &quot;forestUTM2008&quot;)</code></pre>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/jasper/Dropbox/SAEON/Projects/Cape Peninsula/FireShadow/forest/forestUTM2008.shp&quot;, layer: &quot;forestUTM2008&quot;
## with 205 features
## It has 15 fields</code></pre>
<pre class="r"><code>###Ignore this code for now. It&#39;s a nicer way of plotting the map, but...
# f2008[205,] #Orangekloof polygon needs fixing!!!
# f1944@data$id = rownames(f1944@data)
# f1944=gUnionCascaded(f1944,id=f1944$id)%&gt;%
#   gSimplify(0.001,topologyPreserve = T) #Fix topology issues
# 
# f2008@data$id = rownames(f2008@data)
# f2008=gUnionCascaded(f2008,id=f2008$id)%&gt;%
#   gSimplify(0.001,topologyPreserve = T) #Fix topology issues

# map &lt;- ggplot(f2008) + 
# aes(long, lat, group = group, fill = &quot;#4393C3&quot;) + 
# geom_polygon(alpha = 0.5) +
# coord_equal() + 
# theme(legend.position=&quot;none&quot;)

sf1944 &lt;- crop(f1944, extent(255000, 270000, 6230000, 6240000))
#sf2008 &lt;- crop(f2008, extent(255000, 270000, 6230000, 6240000))

plot(sf1944, col = &quot;forestgreen&quot;, border = &quot;white&quot;)
plot(f2008, add = T, col = &quot;green&quot;, border = &quot;white&quot;)
plot(f1944, add = T, col = &quot;forestgreen&quot;)</code></pre>
<p><img src="/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here the dark green is the forest extent in 1944, while the light green indicates the additional forest extent in 2008 - lots of expansion!</p>
<p>Now I’d like to overlay the burn probabilities with the areas that were “stable fynbos” vs “stable forest” vs “forest expansion” over the 1944 to 2008 period and show you the difference as boxplots, but to work with them we’ll need them as raster data (i.e. gridded as opposed to polygons). So first I rasterize each layer to a 90m grid and plot fynbos (0 - grey), stable forest (2 - green) and areas of forest expansion (1 - yellow). Please ignore the confusing scale bar.</p>
<pre class="r"><code>fr1944 &lt;- rasterize(f1944, bp, fun = &quot;count&quot;, field = 1, background = 0) #create a raster with &quot;1&quot; where forest occurred
fr2008 &lt;- rasterize(f2008, bp, fun = &quot;count&quot;, field = 1, background = 0) #create a raster with &quot;1&quot; where forest occurred

frDelta &lt;- fr2008 + fr1944

plot(crop(frDelta, extent(255000, 270000, 6230000, 6240000)))</code></pre>
<p><img src="/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now we can extract them into one dataframe (i.e. a table of data) and bin them into vegetation change classes…</p>
<pre class="r"><code>dat &lt;- as.data.frame(na.omit(rasterToPoints(stack(bp, frDelta))))

dat$layer[which(dat$layer == 0)] &lt;- &quot;Stable Fynbos&quot;
dat$layer[which(dat$layer == 1)] &lt;- &quot;Forest Gain&quot;
dat$layer[which(dat$layer %in% c(2,3))] &lt;- &quot;Stable Forest&quot; #Note there is some erroneous overlap in the 2008 polygons

dat$layer &lt;- as.factor(dat$layer)

#write.csv(dat, &quot;/Users/jasper/Dropbox/SAEON/Projects/Cape Peninsula/FireShadow/spBayes/data.csv&quot;)

head(dat)</code></pre>
<pre><code>##        x       y untrans_homog_clip trans_homog_clip changeHomog_clip
## 1 259845 6244515           0.066660         0.009665         0.056995
## 2 259935 6244515           0.066940         0.008860         0.058080
## 3 260025 6244515           0.067385         0.008220         0.059165
## 4 260115 6244515           0.067505         0.007085         0.060420
## 5 259665 6244425           0.063040         0.010975         0.052065
## 6 259755 6244425           0.063715         0.010565         0.053150
##           layer
## 1 Stable Fynbos
## 2 Stable Fynbos
## 3 Stable Fynbos
## 4 Stable Fynbos
## 5 Stable Fynbos
## 6 Stable Fynbos</code></pre>
<p>So there’s the top few lines of the table above. Now we use these data to draw a box and whisker plot of the reduction in burn probability by class. Here the horizontal mid-line represents the midpoint of the observed values for each class (the median), the box represents the upper and lower quartiles (i.e. 50% of the records for each class fall inside the box), the “whiskers” represent ~75% of the data in each class, and the points (i.e. the black smudge above “Stable Fynbos”) represent outliers that are further from the rest of the data than we would expect.</p>
<pre class="r"><code>g &lt;- ggplot(dat)
g &lt;- g + stat_boxplot(aes(y = changeHomog_clip, x = layer, group = layer), position = &quot;dodge&quot;) + 
  ylab(&quot;Reduction in burn probability&quot;) + 
  xlab(&quot;Vegetation Change&quot;)
g #to plot</code></pre>
<p><img src="/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>That “Forest Gain” and “Stable Forest” have much higher medians and “boxes” clearly indicates that forest has remained stable and/or expanded in the areas where there has been a reduction in burn probability. There are many possible reasons for the “outliers” in the “Stable Fynbos” class, but the two main reasons are likely to be that a) not all fynbos sites that have suffered a reduction in burn probability are able to sustain forest (e.g. too dry), and b) these sites may well be transitioning to forest, but more time is needed for them to do so.</p>
<p>While this plot looks very convincing, unfortunately it would never fool journal reviewer number three…</p>
<p><a href="https://www.youtube.com/watch?v=-VRBWLpYCPY"><img src="http://img.youtube.com/vi/-VRBWLpYCPY/0.jpg" alt="journal reviewer number three" /></a></p>
<p>They’ll argue there’s spatial autocorrelation (i.e. things that are close in space are likely to be similar anyway) and will want to see some fancy spatially explicit statistics that don’t tell you any more than this boxplot.</p>
<p>So here are some convolutedly fancy stats for those of you who are interested. Skip to the brief discussion at the end if you’re not interested in the stats :)</p>
<p>We’ll start by thinning the data a little by subsampling. Running a spatially explicit Bayesian model on the ~34000 data points (i.e. 90m grid cells) we have requires a very very big computer, and this is just a blog post. Let’s try 10% of the data and plot it to check that it’s representative of the full dataset (as plotted above).</p>
<pre class="r"><code>set.seed(1) #Pick a string of random numbers so that we can replicate the sampling

sdat &lt;- dat[sample(1:nrow(dat), nrow(dat)/10),] #Take a 10% sample

g &lt;- ggplot(sdat)
g &lt;- g + stat_boxplot(aes(y = changeHomog_clip, x = layer, group = layer), position = &quot;dodge&quot;) + 
  ylab(&quot;Reduction in burn probability&quot;) + 
  xlab(&quot;Vegetation Change Class&quot;)
g #Plot the sample to see if it is representative of the whole</code></pre>
<p><img src="/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Looks pretty representative.</p>
<p>It turns out it takes ~12 hours to run the following code on the 10% subset of the data on a x86_64-apple-darwin13.4.0 MacBook Pro (so I’ve commented out the next code chunk so I don’t have to run it each time I compile this blog post). I think we’ll need to run the full dataset on a cluster…</p>
<p>Skip this section if you’re more interested in the results.</p>
<pre class="r"><code># ### Set up a convolutedly long set of model inputs which I won&#39;t eplain
# B &lt;- as.matrix(c(1:3))
# p &lt;- length(B)
# 
# sigma.sq &lt;- 2
# tau.sq &lt;- 0.1
# phi &lt;- 3/0.5
# 
# n.samples &lt;- 2000
# 
# starting &lt;- list(&quot;phi&quot;=3/0.5, &quot;sigma.sq&quot;=50, &quot;tau.sq&quot;=1)
# 
# tuning &lt;- list(&quot;phi&quot;=0.1, &quot;sigma.sq&quot;=0.1, &quot;tau.sq&quot;=0.1)
# 
# ### Set up 2 sets of different &quot;prior beliefs&quot; to see how much this affects the model - note that I&#39;ve just gone with some simple ones here and should really explore a bigger range
# priors.1 &lt;- list(&quot;beta.Norm&quot;=list(rep(0,p), diag(1000,p)),
#                  &quot;phi.Unif&quot;=c(3/1, 3/0.1), &quot;sigma.sq.IG&quot;=c(2, 2),
#                  &quot;tau.sq.IG&quot;=c(2, 0.1))
# 
# priors.2 &lt;- list(&quot;beta.Flat&quot;, &quot;phi.Unif&quot;=c(3/1, 3/0.1),
#                  &quot;sigma.sq.IG&quot;=c(2, 2), &quot;tau.sq.IG&quot;=c(2, 0.1))
# 
# ### Choose a model for the spatial autocorrelation
# cov.model &lt;- &quot;exponential&quot; #A very rapid decay model. This should be fair for our data, but I&#39;ll need to play with this for publication
# 
# n.report &lt;- 500
# verbose &lt;- TRUE
# 
# ###Run the models
# m.1 &lt;- spLM(changeHomog_clip~layer, coords=as.matrix(sdat[,1:2]),
#             data = sdat, starting=starting,
#             tuning=tuning, priors=priors.1, cov.model=cov.model,
#             n.samples=n.samples, verbose=verbose, n.report=n.report)
# 
# m.2 &lt;- spLM(changeHomog_clip~layer, coords=as.matrix(sdat[,1:2]),
#             data = sdat, starting=starting,
#             tuning=tuning, priors=priors.2, cov.model=cov.model,
#             n.samples=n.samples, verbose=verbose, n.report=n.report)
# 
# burn.in &lt;- 0.5*n.samples
# 
# ###Recover beta and spatial random effects
# m.1 &lt;- spRecover(m.1, start=burn.in, verbose=FALSE)
# m.2 &lt;- spRecover(m.2, start=burn.in, verbose=FALSE)
# 
# round(summary(m.1$p.theta.recover.samples)$quantiles[,c(3,1,5)],2)
# round(summary(m.2$p.theta.recover.samples)$quantiles[,c(3,1,5)],2)
# 
# round(summary(m.1$p.beta.recover.samples)$quantiles[,c(3,1,5)],2)
# round(summary(m.2$p.beta.recover.samples)$quantiles[,c(3,1,5)],2)
# 
# m.1.w.summary &lt;- summary(mcmc(t(m.1$p.w.recover.samples)))$quantiles[,c(3,1,5)]
# m.2.w.summary &lt;- summary(mcmc(t(m.2$p.w.recover.samples)))$quantiles[,c(3,1,5)]
#
# save(m.1, paste0(datwd, &quot;model1.RData&quot;))</code></pre>
<p>Here’s one I prepared earlier ;)</p>
<pre class="r"><code>load(paste0(datwd, &quot;model1.RData&quot;)) #Get previously run model output

#round(summary(m.1$p.theta.recover.samples)$quantiles,2) #If you&#39;re running this code this gives you the spatial autocorrelation estimates

round(summary(m.1$p.beta.recover.samples)$quantiles,3)</code></pre>
<pre><code>##                      2.5%    25%    50%    75%  97.5%
## (Intercept)         0.009  0.016  0.020  0.024  0.032
## layerStable Forest -0.015 -0.005  0.000  0.004  0.013
## layerStable Fynbos -0.031 -0.023 -0.019 -0.015 -0.008</code></pre>
<p>So this gives us the median (50%) and quantiles (0.025, 0.25, 0.75, 0.975) of the posterior probability distributions of the estimated average values for each class. “Forest Gain” is the intercept, which is all positive (i.e. lower probability of burning), and overlaps with “Stable Forest”, but does not overlap with “Stable Fynbos”, which confirms what we knew already! Although it’s a little difficult to interpret. Let’s try a boxplot to illustrate this more clearly.</p>
<pre class="r"><code>x &lt;- as.data.frame(round(summary(m.1$p.beta.recover.samples)$quantiles,3))

rownames(x) &lt;- levels(sdat$layer)
colnames(x) &lt;- c(&quot;min&quot;, &quot;lower&quot;, &quot;mid&quot;, &quot;upper&quot;, &quot;max&quot;)
  
#m.1.w.summary &lt;- summary(mcmc(t(m.1$p.w.recover.samples)))$quantiles[,c(3,1,5)]

Pa &lt;-  ggplot(x,aes(rownames(x))) +
  geom_boxplot(aes(ymin=min,lower=lower,middle=mid,upper=upper,ymax=max),
              stat=&quot;identity&quot;) +
   ylab(&quot;Reduction in burn probability&quot;) + xlab(&quot;Vegetation Change Class&quot;)

Pa</code></pre>
<p><img src="/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>So the forest expanded at sites where the probability of burning has been reduced, because land cover transformation has created new “fire shadows”. Null hypothesis accepted?</p>
<p>Note that there are a bunch of assumptions etc that I haven’t included here. E.g. having more people usually increases ignitions, resulting in more fires. This may also have a biased spatial pattern, like fires are most likely to start along the wildland-urban interface, etc.</p>
<p>Either way, I think there are many reasons why this analysis is interesting despite it’s flaws, and I suspect the story is at least partially true. The real question is how can we manage this? Do we allow these areas to succeed to forest, despite the loss of fynbos biodiversity at these sites? And the risk of catestrophically big fires if a fire is started in the ~50-100 year period while the fynbos is being invaded by forest and is incredibly flammable?</p>
<p>For the reviewer #3’s among you - here are the model diagnostics:</p>
<pre class="r"><code>plot(m.1$p.beta.recover.samples)</code></pre>
<p><img src="/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>It looks like the model converged nicely :)</p>
<p>And the session info:</p>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] cleangeo_0.2-2 maptools_0.9-3 ggplot2_3.0.0  dplyr_0.7.6   
##  [5] rgeos_0.3-28   spBayes_0.4-1  Formula_1.2-3  magic_1.5-8   
##  [9] abind_1.4-5    coda_0.19-1    rgdal_1.3-4    raster_2.6-7  
## [13] sp_1.3-1      
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.18     plyr_1.8.4       compiler_3.5.1   pillar_1.3.0    
##  [5] bindr_0.1.1      tools_3.5.1      digest_0.6.15    gtable_0.2.0    
##  [9] evaluate_0.11    tibble_1.4.2     lattice_0.20-35  pkgconfig_2.0.1 
## [13] rlang_0.2.1      yaml_2.2.0       blogdown_0.8     xfun_0.3        
## [17] bindrcpp_0.2.2   withr_2.1.2      stringr_1.3.1    knitr_1.20      
## [21] rprojroot_1.3-2  grid_3.5.1       tidyselect_0.2.4 glue_1.3.0      
## [25] R6_2.2.2         foreign_0.8-71   rmarkdown_1.10   bookdown_0.7    
## [29] purrr_0.2.5      magrittr_1.5     scales_0.5.0     backports_1.1.2 
## [33] htmltools_0.3.6  assertthat_0.2.0 colorspace_1.3-2 labeling_0.3    
## [37] stringi_1.2.4    lazyeval_0.2.1   munsell_0.5.0    crayon_1.3.4</code></pre>

            </article>
          </div>
          
      <div class='entry-meta-bottom'>
        

  <div class="entry-categories"><p><span>Categories</span>
    
    <a href="/categories/research" title="View all posts in Research">Research</a>
    <a href="/categories/r-tutorials" title="View all posts in R Tutorials">R Tutorials</a>
  </p>
</div>



<div class="entry-tags"><p><span>Tags</span>
  

</p></div>	</div>

	
<div class="author-meta">

  <div class="author">
    	
      <img alt='Jasper Slingsby' src="https://www.gravatar.com/avatar/10b0f8bbf16f471dc5acc8a221ad4a52?s=100&d=identicon" class='avatar avatar-72 photo' height='72' width='72'>
    
    <span>
      Written by:<a href="http://ecologi.st/" title="Posts by Jasper Slingsby" rel="author">Jasper Slingsby</a> </span>
    </div>
    <div class="bio">
      
      
      <p>An ecologist working on global change in terrestrial ecosystems.</p>
      
      
	






<a class="twitter" target="_blank"
href="https://twitter.com/JasperSlingsby">
<i class="fa fa-twitter-square"
title="twitter icon"></i>
</a>




<a class="email" target="_blank"
href="mailto:jslingsby@gmail.com">
<i class="fa fa-envelope"
title="email icon"></i>
</a>







<a class="github" target="_blank"
href="https://github.com/jslingsby/">
<i class="fa fa-github"
title="github icon"></i>
</a>







</div>
</div>

</div>
</div>

<section id="comments" class="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-jslingsby-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

  




</section>
</div>

 



    </div>

    <footer id="site-footer" class="site-footer" role="contentinfo">
	<h1>
    
    <a href=""> Jasper Slingsby </a>
    
	</h1>

			
			<p class="site-description">Ecologist</p>
			

		<div id="menu-footer" class="menu-container menu-footer" role="navigation">
		<div class="menu">

      <ul id="menu-footer-items" class="menu-footer-items">
        
</ul>

</div>	</div>

<ul class="social-media-icons">

        

        


        
        <li>
        <a href="https://twitter.com/JasperSlingsby"  class="twitter" target="_blank">
            <i class="fa fa-twitter-square" title="twitter"></i>
            <span class="screen-reader-text">twitter</span>
        </a>
        </li>
        

        

        
        <li>
        <a href="mailto:jslingsby@gmail.com"  class="email">
            <i class="fa fa-envelope" title="email"></i>
            <span class="screen-reader-text">email</span>
        </a>
        </li>
        

        

        


        
        <li>
        <a href="https://github.com/jslingsby/"  class="github" target="_blank">
            <i class="fa fa-github" title="github"></i>
            <span class="screen-reader-text">github</span>
        </a>
        </li>
        


        

        
        <li>
        <a href="/index.xml" data-animate-hover="pulse" class="rss" target="_blank">
            <i class="fa fa-rss" title="rss"></i>
            <span class="screen-reader-text">rss</span>
        </a>
        </li>
        

				</ul>	<div class="design-credit">
		
		<p>&copy; 2018 Jasper Slingsby</p>
		
		<p>Nederburg Hugo Theme by <a href="https://appernetic.io">Appernetic</a>.</p>
		
		<p>A port of Tracks by Compete Themes.</p>
		
	</div>
</footer>

  </div>
  <script src="/js/jquery.min.js"></script>
<script src="/js/jquerymigrate.js"></script>
<script src="/js/production.min.js"></script>

</body>
</html>
