<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Jasper Slingsby</title>
    <link>/index.xml</link>
    <description>Recent content on Jasper Slingsby</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy;2016 Your name or company</copyright>
    <lastBuildDate>Tue, 15 Aug 2017 00:00:00 +0000</lastBuildDate>
    <atom:link href="/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Drought Monitor for the Jonkershoek Valley, Western Cape, South Africa</title>
      <link>/post/2017-04-01-Langrivier/</link>
      <pubDate>Tue, 15 Aug 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-04-01-Langrivier/</guid>
      <description>&lt;script src=&#34;/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/jquery/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;/rmarkdown-libs/dygraphs/dygraph.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/dygraphs/dygraph-combined.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/moment/moment.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/moment-timezone/moment-timezone-with-data.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/moment-fquarter/moment-fquarter.min.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;/rmarkdown-libs/dygraphs-binding/dygraphs.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;&lt;img src=&#34;/img/SAEON_DST.png&#34; width=&#34;800px&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;This analysis was prepared by the &lt;a href=&#34;http://www.saeon-fynbos.org&#34;&gt;&lt;strong&gt;Fynbos Node&lt;/strong&gt;&lt;/a&gt; of &lt;a href=&#34;http://www.saeon.ac.za&#34;&gt;the &lt;strong&gt;South African Environmental Observation Network (SAEON)&lt;/strong&gt;&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Here we present the record of stream flow rates for the Langrivier catchment and rainfall from the Dwarsberg weather station in the Jonkershoek Valley for the period January 1961 to the end of July 2017. The Dwarsberg weather station is at 1214 metres above sea level on the boundary of the catchments of the Eerste, Berg and Sonderend rivers and is a good indicator of rainfall feeding the Berg and Theewaterskloof dams.&lt;/p&gt;
&lt;!--more--&gt;
&lt;p&gt;We plan to update this page monthly. For live weather data and the record over the past month please access the &lt;a href=&#34;http://lognet.saeon.ac.za:8088/Dwarsberg/index.html&#34;&gt;&lt;strong&gt;Dwarsberg weather station directly&lt;/strong&gt;&lt;/a&gt;. You may also be interested in our &lt;a href=&#34;http://lognet.saeon.ac.za:8088/Constantiaberg/index.html&#34;&gt;&lt;strong&gt;Constantiaberg weather station&lt;/strong&gt;&lt;/a&gt; on the Cape Peninsula or our &lt;a href=&#34;http://lognet.saeon.ac.za:8088/EngCed/index.html&#34;&gt;&lt;strong&gt;Engelsmanskloof weather station&lt;/strong&gt;&lt;/a&gt; in the Cederberg.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;PLEASE NOTE: We cannot guarantee that these data or analyses are error free, particularly with regards to the older historical data and the comparability of the older and newer instrumentation. Gaps in the data were filled using linear interpolation from the most recent data for up to a 30 day period. This filled all gaps other than the period August 2008 to September 2011 - these data exist in hardcopy, but are still being digitized. There are much better gap-filling techniques, but the appropriate method depends on the question being asked.&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;div id=&#34;streamflow-record&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Streamflow record&lt;/h2&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PLEASE NOTE THAT JULY’S STREAMFLOW IS YET TO BE ADDED! PLEASE BEAR WITH US…&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Here are the recent monthly streamflow values for Langrivier relative to averages across the entire time period (1961 to current).&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-Langrivier_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Black error bars around the mean (grey column) indicate 95% confidence intervals. Monthly values lower than the lower bar are among the lowest 5% of recorded flows for that month. January, February, March and May 2017 are the lowest streamflows ever recorded for their respective months. Note that missing months (e.g. October-November 2015) are those that overlap a data gap of over 30 days.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;We can also view this cumulatively:&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-Langrivier_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Or compare across all years on record:&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-Langrivier_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;768&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Note that “Summer” denotes the Austral summer (here defined as October - March), overlapping 2 years. In this figure we have lumped summers by the preceding year, e.g. summer 2016 represents the period October 2016 to March 2017, which incidentally has been the driest summer on record in terms of both streamflow and rainfall.&lt;/p&gt;
&lt;p&gt;*Data for October - December from the summer of 2015/2016 are missing due to vandalism of the weir, but January - March 2016 was among the lowest 10% of flows for that period, suggesting that 2015 was likely the driest year on record. Of those with complete data, 2003 was the driest year, followed by 1974.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;The following dynamic figures illustrate the mean monthly stream flow. You can hover over a piece of the time series to get the date and streamflow value, and adjust and zoom the window of interest by sliding the toggles in the bar at the bottom of each figure. Note the historical data (pre September 2011) has been infilled previously, but we still need to ascertain where the gaps were and what method was used.&lt;/p&gt;
&lt;hr /&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:672px;height:480px;&#34; class=&#34;dygraphs html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;attrs&#34;:{&#34;title&#34;:&#34;Langrivier Monthly Streamflow&#34;,&#34;xlabel&#34;:&#34;Date&#34;,&#34;ylabel&#34;:&#34;Streamflow (ML)&#34;,&#34;labels&#34;:[&#34;month&#34;,&#34;Streamflow Volume&#34;],&#34;legend&#34;:&#34;auto&#34;,&#34;retainDateWindow&#34;:false,&#34;axes&#34;:{&#34;x&#34;:{&#34;pixelsPerLabel&#34;:60}},&#34;showRangeSelector&#34;:true,&#34;rangeSelectorHeight&#34;:40,&#34;rangeSelectorPlotFillColor&#34;:&#34; #A7B1C4&#34;,&#34;rangeSelectorPlotStrokeColor&#34;:&#34;#808FAB&#34;,&#34;interactionModel&#34;:&#34;Dygraph.Interaction.defaultModel&#34;},&#34;scale&#34;:&#34;monthly&#34;,&#34;annotations&#34;:[],&#34;shadings&#34;:[{&#34;from&#34;:&#34;2011-08-24T15:00:00.000Z&#34;,&#34;to&#34;:&#34;2017-07-28T10:00:00.000Z&#34;,&#34;color&#34;:&#34;#EFEFEF&#34;,&#34;axis&#34;:&#34;x&#34;}],&#34;events&#34;:[{&#34;pos&#34;:299.86555295612,&#34;label&#34;:&#34;Mean&#34;,&#34;labelLoc&#34;:&#34;left&#34;,&#34;color&#34;:&#34;black&#34;,&#34;strokePattern&#34;:[7,3],&#34;axis&#34;:&#34;y&#34;},{&#34;pos&#34;:68.5806120062993,&#34;label&#34;:&#34;Mean Flow of Driest Month&#34;,&#34;labelLoc&#34;:&#34;left&#34;,&#34;color&#34;:&#34;#D6604D&#34;,&#34;strokePattern&#34;:[7,3],&#34;axis&#34;:&#34;y&#34;},{&#34;pos&#34;:609.640985859949,&#34;label&#34;:&#34;Mean Flow of Wettest Month&#34;,&#34;labelLoc&#34;:&#34;left&#34;,&#34;color&#34;:&#34;#4393C3&#34;,&#34;strokePattern&#34;:[7,3],&#34;axis&#34;:&#34;y&#34;}],&#34;format&#34;:&#34;date&#34;,&#34;data&#34;:[[&#34;1961-03-31T23:00:00.000Z&#34;,&#34;1961-04-30T23:00:00.000Z&#34;,&#34;1961-05-31T23:00:00.000Z&#34;,&#34;1961-06-30T23:00:00.000Z&#34;,&#34;1961-07-31T23:00:00.000Z&#34;,&#34;1961-08-31T23:00:00.000Z&#34;,&#34;1961-09-30T23:00:00.000Z&#34;,&#34;1961-10-31T23:00:00.000Z&#34;,&#34;1961-11-30T23:00:00.000Z&#34;,&#34;1961-12-31T23:00:00.000Z&#34;,&#34;1962-01-31T23:00:00.000Z&#34;,&#34;1962-02-28T23:00:00.000Z&#34;,&#34;1962-03-31T23:00:00.000Z&#34;,&#34;1962-04-30T23:00:00.000Z&#34;,&#34;1962-05-31T23:00:00.000Z&#34;,&#34;1962-06-30T23:00:00.000Z&#34;,&#34;1962-07-31T23:00:00.000Z&#34;,&#34;1962-08-31T23:00:00.000Z&#34;,&#34;1962-09-30T23:00:00.000Z&#34;,&#34;1962-10-31T23:00:00.000Z&#34;,&#34;1962-11-30T23:00:00.000Z&#34;,&#34;1962-12-31T23:00:00.000Z&#34;,&#34;1963-01-31T23:00:00.000Z&#34;,&#34;1963-02-28T23:00:00.000Z&#34;,&#34;1963-03-31T23:00:00.000Z&#34;,&#34;1963-04-30T23:00:00.000Z&#34;,&#34;1963-05-31T23:00:00.000Z&#34;,&#34;1963-06-30T23:00:00.000Z&#34;,&#34;1963-07-31T23:00:00.000Z&#34;,&#34;1963-08-31T23:00:00.000Z&#34;,&#34;1963-09-30T23:00:00.000Z&#34;,&#34;1963-10-31T23:00:00.000Z&#34;,&#34;1963-11-30T23:00:00.000Z&#34;,&#34;1963-12-31T23:00:00.000Z&#34;,&#34;1964-01-31T23:00:00.000Z&#34;,&#34;1964-02-29T23:00:00.000Z&#34;,&#34;1964-03-31T23:00:00.000Z&#34;,&#34;1964-04-30T23:00:00.000Z&#34;,&#34;1964-05-31T23:00:00.000Z&#34;,&#34;1964-06-30T23:00:00.000Z&#34;,&#34;1964-07-31T23:00:00.000Z&#34;,&#34;1964-08-31T23:00:00.000Z&#34;,&#34;1964-09-30T23:00:00.000Z&#34;,&#34;1964-10-31T23:00:00.000Z&#34;,&#34;1964-11-30T23:00:00.000Z&#34;,&#34;1964-12-31T23:00:00.000Z&#34;,&#34;1965-01-31T23:00:00.000Z&#34;,&#34;1965-02-28T23:00:00.000Z&#34;,&#34;1965-03-31T23:00:00.000Z&#34;,&#34;1965-04-30T23:00:00.000Z&#34;,&#34;1965-05-31T23:00:00.000Z&#34;,&#34;1965-06-30T23:00:00.000Z&#34;,&#34;1965-07-31T23:00:00.000Z&#34;,&#34;1965-08-31T23:00:00.000Z&#34;,&#34;1965-09-30T23:00:00.000Z&#34;,&#34;1965-10-31T23:00:00.000Z&#34;,&#34;1965-11-30T23:00:00.000Z&#34;,&#34;1965-12-31T23:00:00.000Z&#34;,&#34;1966-01-31T23:00:00.000Z&#34;,&#34;1966-02-28T23:00:00.000Z&#34;,&#34;1966-03-31T23:00:00.000Z&#34;,&#34;1966-04-30T23:00:00.000Z&#34;,&#34;1966-05-31T23:00:00.000Z&#34;,&#34;1966-06-30T23:00:00.000Z&#34;,&#34;1966-07-31T23:00:00.000Z&#34;,&#34;1966-08-31T23:00:00.000Z&#34;,&#34;1966-09-30T23:00:00.000Z&#34;,&#34;1966-10-31T23:00:00.000Z&#34;,&#34;1966-11-30T23:00:00.000Z&#34;,&#34;1966-12-31T23:00:00.000Z&#34;,&#34;1967-01-31T23:00:00.000Z&#34;,&#34;1967-02-28T23:00:00.000Z&#34;,&#34;1967-03-31T23:00:00.000Z&#34;,&#34;1967-04-30T23:00:00.000Z&#34;,&#34;1967-05-31T23:00:00.000Z&#34;,&#34;1967-06-30T23:00:00.000Z&#34;,&#34;1967-07-31T23:00:00.000Z&#34;,&#34;1967-08-31T23:00:00.000Z&#34;,&#34;1967-09-30T23:00:00.000Z&#34;,&#34;1967-10-31T23:00:00.000Z&#34;,&#34;1967-11-30T23:00:00.000Z&#34;,&#34;1967-12-31T23:00:00.000Z&#34;,&#34;1968-01-31T23:00:00.000Z&#34;,&#34;1968-02-29T23:00:00.000Z&#34;,&#34;1968-03-31T23:00:00.000Z&#34;,&#34;1968-04-30T23:00:00.000Z&#34;,&#34;1968-05-31T23:00:00.000Z&#34;,&#34;1968-06-30T23:00:00.000Z&#34;,&#34;1968-07-31T23:00:00.000Z&#34;,&#34;1968-08-31T23:00:00.000Z&#34;,&#34;1968-09-30T23:00:00.000Z&#34;,&#34;1968-10-31T23:00:00.000Z&#34;,&#34;1968-11-30T23:00:00.000Z&#34;,&#34;1968-12-31T23:59:00.000Z&#34;,&#34;1969-01-31T23:00:00.000Z&#34;,&#34;1969-02-28T23:00:00.000Z&#34;,&#34;1969-03-31T23:00:00.000Z&#34;,&#34;1969-04-30T23:00:00.000Z&#34;,&#34;1969-05-31T23:00:00.000Z&#34;,&#34;1969-06-30T23:00:00.000Z&#34;,&#34;1969-07-31T23:00:00.000Z&#34;,&#34;1969-08-31T23:00:00.000Z&#34;,&#34;1969-09-30T23:00:00.000Z&#34;,&#34;1969-10-31T23:00:00.000Z&#34;,&#34;1969-11-30T23:00:00.000Z&#34;,&#34;1969-12-31T23:00:00.000Z&#34;,&#34;1970-01-31T23:00:00.000Z&#34;,&#34;1970-02-28T23:00:00.000Z&#34;,&#34;1970-03-31T23:00:00.000Z&#34;,&#34;1970-04-30T23:00:00.000Z&#34;,&#34;1970-05-31T23:00:00.000Z&#34;,&#34;1970-06-30T23:00:00.000Z&#34;,&#34;1970-07-31T23:00:00.000Z&#34;,&#34;1970-08-31T23:00:00.000Z&#34;,&#34;1970-09-30T23:00:00.000Z&#34;,&#34;1970-10-31T23:00:00.000Z&#34;,&#34;1970-11-30T23:00:00.000Z&#34;,&#34;1970-12-31T23:00:00.000Z&#34;,&#34;1971-01-31T23:00:00.000Z&#34;,&#34;1971-02-28T23:00:00.000Z&#34;,&#34;1971-03-31T23:00:00.000Z&#34;,&#34;1971-04-30T23:00:00.000Z&#34;,&#34;1971-05-31T23:00:00.000Z&#34;,&#34;1971-06-30T23:00:00.000Z&#34;,&#34;1971-07-31T23:00:00.000Z&#34;,&#34;1971-08-31T23:00:00.000Z&#34;,&#34;1971-09-30T23:00:00.000Z&#34;,&#34;1971-10-31T23:00:00.000Z&#34;,&#34;1971-11-30T23:00:00.000Z&#34;,&#34;1971-12-31T23:00:00.000Z&#34;,&#34;1972-01-31T23:00:00.000Z&#34;,&#34;1972-02-29T23:00:00.000Z&#34;,&#34;1972-03-31T23:00:00.000Z&#34;,&#34;1972-04-30T23:00:00.000Z&#34;,&#34;1972-05-31T23:00:00.000Z&#34;,&#34;1972-06-30T23:00:00.000Z&#34;,&#34;1972-07-31T23:00:00.000Z&#34;,&#34;1972-08-31T23:00:00.000Z&#34;,&#34;1972-09-30T23:00:00.000Z&#34;,&#34;1972-10-31T23:00:00.000Z&#34;,&#34;1972-11-30T23:00:00.000Z&#34;,&#34;1972-12-31T23:00:00.000Z&#34;,&#34;1973-01-31T23:00:00.000Z&#34;,&#34;1973-02-28T23:00:00.000Z&#34;,&#34;1973-03-31T23:00:00.000Z&#34;,&#34;1973-04-30T23:00:00.000Z&#34;,&#34;1973-05-31T23:00:00.000Z&#34;,&#34;1973-06-30T23:00:00.000Z&#34;,&#34;1973-07-31T23:00:00.000Z&#34;,&#34;1973-08-31T23:00:00.000Z&#34;,&#34;1973-09-30T23:00:00.000Z&#34;,&#34;1973-10-31T23:00:00.000Z&#34;,&#34;1973-11-30T23:00:00.000Z&#34;,&#34;1973-12-31T23:00:00.000Z&#34;,&#34;1974-01-31T23:00:00.000Z&#34;,&#34;1974-02-28T23:00:00.000Z&#34;,&#34;1974-03-31T23:00:00.000Z&#34;,&#34;1974-04-30T23:00:00.000Z&#34;,&#34;1974-05-31T23:00:00.000Z&#34;,&#34;1974-06-30T23:00:00.000Z&#34;,&#34;1974-07-31T23:00:00.000Z&#34;,&#34;1974-08-31T23:00:00.000Z&#34;,&#34;1974-09-30T23:00:00.000Z&#34;,&#34;1974-10-31T23:00:00.000Z&#34;,&#34;1974-11-30T23:00:00.000Z&#34;,&#34;1974-12-31T23:00:00.000Z&#34;,&#34;1975-01-31T23:00:00.000Z&#34;,&#34;1975-02-28T23:00:00.000Z&#34;,&#34;1975-03-31T23:00:00.000Z&#34;,&#34;1975-04-30T23:00:00.000Z&#34;,&#34;1975-05-31T23:00:00.000Z&#34;,&#34;1975-06-30T23:00:00.000Z&#34;,&#34;1975-07-31T23:00:00.000Z&#34;,&#34;1975-08-31T23:00:00.000Z&#34;,&#34;1975-09-30T23:00:00.000Z&#34;,&#34;1975-10-31T23:00:00.000Z&#34;,&#34;1975-11-30T23:00:00.000Z&#34;,&#34;1975-12-31T23:00:00.000Z&#34;,&#34;1976-01-31T23:00:00.000Z&#34;,&#34;1976-02-29T23:00:00.000Z&#34;,&#34;1976-03-31T23:00:00.000Z&#34;,&#34;1976-04-30T23:00:00.000Z&#34;,&#34;1976-05-31T23:00:00.000Z&#34;,&#34;1976-06-30T23:00:00.000Z&#34;,&#34;1976-07-31T23:00:00.000Z&#34;,&#34;1976-08-31T23:00:00.000Z&#34;,&#34;1976-09-30T23:00:00.000Z&#34;,&#34;1976-10-31T23:00:00.000Z&#34;,&#34;1976-11-30T23:00:00.000Z&#34;,&#34;1976-12-31T23:00:00.000Z&#34;,&#34;1977-01-31T23:00:00.000Z&#34;,&#34;1977-02-28T23:00:00.000Z&#34;,&#34;1977-03-31T23:00:00.000Z&#34;,&#34;1977-04-30T23:00:00.000Z&#34;,&#34;1977-05-31T23:00:00.000Z&#34;,&#34;1977-06-30T23:00:00.000Z&#34;,&#34;1977-07-31T23:00:00.000Z&#34;,&#34;1977-08-31T23:00:00.000Z&#34;,&#34;1977-09-30T23:00:00.000Z&#34;,&#34;1977-10-31T23:00:00.000Z&#34;,&#34;1977-11-30T23:00:00.000Z&#34;,&#34;1977-12-31T23:00:00.000Z&#34;,&#34;1978-01-31T23:00:00.000Z&#34;,&#34;1978-02-28T23:00:00.000Z&#34;,&#34;1978-03-31T23:00:00.000Z&#34;,&#34;1978-04-30T23:00:00.000Z&#34;,&#34;1978-05-31T23:00:00.000Z&#34;,&#34;1978-06-30T23:00:00.000Z&#34;,&#34;1978-07-31T23:00:00.000Z&#34;,&#34;1978-08-31T23:00:00.000Z&#34;,&#34;1978-09-30T23:00:00.000Z&#34;,&#34;1978-10-31T23:00:00.000Z&#34;,&#34;1978-11-30T23:00:00.000Z&#34;,&#34;1978-12-31T23:00:00.000Z&#34;,&#34;1979-01-31T23:00:00.000Z&#34;,&#34;1979-02-28T23:00:00.000Z&#34;,&#34;1979-03-31T23:00:00.000Z&#34;,&#34;1979-04-30T23:00:00.000Z&#34;,&#34;1979-05-31T23:00:00.000Z&#34;,&#34;1979-06-30T23:00:00.000Z&#34;,&#34;1979-07-31T23:00:00.000Z&#34;,&#34;1979-08-31T23:00:00.000Z&#34;,&#34;1979-09-30T23:00:00.000Z&#34;,&#34;1979-10-31T23:00:00.000Z&#34;,&#34;1979-11-30T23:00:00.000Z&#34;,&#34;1979-12-31T23:00:00.000Z&#34;,&#34;1980-01-31T23:00:00.000Z&#34;,&#34;1980-02-29T23:00:00.000Z&#34;,&#34;1980-03-31T23:00:00.000Z&#34;,&#34;1980-04-30T23:00:00.000Z&#34;,&#34;1980-05-31T23:00:00.000Z&#34;,&#34;1980-06-30T23:00:00.000Z&#34;,&#34;1980-07-31T23:00:00.000Z&#34;,&#34;1980-08-31T23:00:00.000Z&#34;,&#34;1980-09-30T23:00:00.000Z&#34;,&#34;1980-10-31T23:00:00.000Z&#34;,&#34;1980-11-30T23:00:00.000Z&#34;,&#34;1980-12-31T23:00:00.000Z&#34;,&#34;1981-01-31T23:00:00.000Z&#34;,&#34;1981-02-28T23:00:00.000Z&#34;,&#34;1981-03-31T23:00:00.000Z&#34;,&#34;1981-04-30T23:00:00.000Z&#34;,&#34;1981-05-31T23:00:00.000Z&#34;,&#34;1981-06-30T23:00:00.000Z&#34;,&#34;1981-07-31T23:00:00.000Z&#34;,&#34;1981-08-31T23:00:00.000Z&#34;,&#34;1981-09-30T23:00:00.000Z&#34;,&#34;1981-10-31T23:00:00.000Z&#34;,&#34;1981-11-30T23:00:00.000Z&#34;,&#34;1981-12-31T23:00:00.000Z&#34;,&#34;1982-01-31T23:00:00.000Z&#34;,&#34;1982-02-28T23:00:00.000Z&#34;,&#34;1982-03-31T23:00:00.000Z&#34;,&#34;1982-04-30T23:00:00.000Z&#34;,&#34;1982-05-31T23:00:00.000Z&#34;,&#34;1982-06-30T23:00:00.000Z&#34;,&#34;1982-07-31T23:00:00.000Z&#34;,&#34;1982-08-31T23:00:00.000Z&#34;,&#34;1982-09-30T23:00:00.000Z&#34;,&#34;1982-10-31T23:00:00.000Z&#34;,&#34;1982-11-30T23:00:00.000Z&#34;,&#34;1982-12-31T23:00:00.000Z&#34;,&#34;1983-01-31T23:00:00.000Z&#34;,&#34;1983-02-28T23:00:00.000Z&#34;,&#34;1983-03-31T23:00:00.000Z&#34;,&#34;1983-04-30T23:00:00.000Z&#34;,&#34;1983-05-31T23:00:00.000Z&#34;,&#34;1983-06-30T23:00:00.000Z&#34;,&#34;1983-07-31T23:00:00.000Z&#34;,&#34;1983-08-31T23:00:00.000Z&#34;,&#34;1983-09-30T23:00:00.000Z&#34;,&#34;1983-10-31T23:00:00.000Z&#34;,&#34;1983-11-30T23:00:00.000Z&#34;,&#34;1983-12-31T23:00:00.000Z&#34;,&#34;1984-01-31T23:00:00.000Z&#34;,&#34;1984-02-29T23:00:00.000Z&#34;,&#34;1984-03-31T23:00:00.000Z&#34;,&#34;1984-04-30T23:00:00.000Z&#34;,&#34;1984-05-31T23:00:00.000Z&#34;,&#34;1984-06-30T23:00:00.000Z&#34;,&#34;1984-07-31T23:00:00.000Z&#34;,&#34;1984-08-31T23:00:00.000Z&#34;,&#34;1984-09-30T23:00:00.000Z&#34;,&#34;1984-10-31T23:00:00.000Z&#34;,&#34;1984-11-30T23:00:00.000Z&#34;,&#34;1984-12-31T23:00:00.000Z&#34;,&#34;1985-01-31T23:00:00.000Z&#34;,&#34;1985-02-28T23:00:00.000Z&#34;,&#34;1985-03-31T23:00:00.000Z&#34;,&#34;1985-04-30T23:00:00.000Z&#34;,&#34;1985-05-31T23:00:00.000Z&#34;,&#34;1985-06-30T23:00:00.000Z&#34;,&#34;1985-07-31T23:00:00.000Z&#34;,&#34;1985-08-31T23:00:00.000Z&#34;,&#34;1985-09-30T23:00:00.000Z&#34;,&#34;1985-10-31T23:00:00.000Z&#34;,&#34;1985-11-30T23:00:00.000Z&#34;,&#34;1985-12-31T23:00:00.000Z&#34;,&#34;1986-01-31T23:00:00.000Z&#34;,&#34;1986-02-28T23:00:00.000Z&#34;,&#34;1986-03-31T23:00:00.000Z&#34;,&#34;1986-04-30T23:00:00.000Z&#34;,&#34;1986-05-31T23:00:00.000Z&#34;,&#34;1986-06-30T23:00:00.000Z&#34;,&#34;1986-07-31T23:00:00.000Z&#34;,&#34;1986-08-31T23:00:00.000Z&#34;,&#34;1986-09-30T23:00:00.000Z&#34;,&#34;1986-10-31T23:00:00.000Z&#34;,&#34;1986-11-30T23:00:00.000Z&#34;,&#34;1986-12-31T23:00:00.000Z&#34;,&#34;1987-01-31T23:00:00.000Z&#34;,&#34;1987-02-28T23:00:00.000Z&#34;,&#34;1987-03-31T23:00:00.000Z&#34;,&#34;1987-04-30T23:00:00.000Z&#34;,&#34;1987-05-31T23:00:00.000Z&#34;,&#34;1987-06-30T23:00:00.000Z&#34;,&#34;1987-07-31T23:00:00.000Z&#34;,&#34;1987-08-31T23:00:00.000Z&#34;,&#34;1987-09-30T23:00:00.000Z&#34;,&#34;1987-10-31T23:00:00.000Z&#34;,&#34;1987-11-30T23:00:00.000Z&#34;,&#34;1987-12-31T23:00:00.000Z&#34;,&#34;1988-01-31T23:00:00.000Z&#34;,&#34;1988-02-29T23:00:00.000Z&#34;,&#34;1988-03-31T23:00:00.000Z&#34;,&#34;1988-04-30T23:00:00.000Z&#34;,&#34;1988-05-31T23:00:00.000Z&#34;,&#34;1988-06-30T23:00:00.000Z&#34;,&#34;1988-07-31T23:00:00.000Z&#34;,&#34;1988-08-31T23:00:00.000Z&#34;,&#34;1988-09-30T23:00:00.000Z&#34;,&#34;1988-10-31T23:00:00.000Z&#34;,&#34;1988-11-30T23:00:00.000Z&#34;,&#34;1988-12-31T23:00:00.000Z&#34;,&#34;1989-01-31T23:00:00.000Z&#34;,&#34;1989-02-28T23:00:00.000Z&#34;,&#34;1989-03-31T23:00:00.000Z&#34;,&#34;1989-04-30T23:00:00.000Z&#34;,&#34;1989-05-31T23:00:00.000Z&#34;,&#34;1989-06-30T23:00:00.000Z&#34;,&#34;1989-07-31T23:00:00.000Z&#34;,&#34;1989-08-31T23:00:00.000Z&#34;,&#34;1989-09-30T23:00:00.000Z&#34;,&#34;1989-10-31T23:00:00.000Z&#34;,&#34;1989-11-30T23:00:00.000Z&#34;,&#34;1989-12-31T23:00:00.000Z&#34;,&#34;1990-01-31T23:00:00.000Z&#34;,&#34;1990-02-28T23:00:00.000Z&#34;,&#34;1990-03-31T23:00:00.000Z&#34;,&#34;1990-04-30T23:00:00.000Z&#34;,&#34;1990-05-31T23:00:00.000Z&#34;,&#34;1990-06-30T23:00:00.000Z&#34;,&#34;1990-07-31T23:00:00.000Z&#34;,&#34;1990-08-31T23:00:00.000Z&#34;,&#34;1990-09-30T23:00:00.000Z&#34;,&#34;1990-10-31T23:00:00.000Z&#34;,&#34;1990-11-30T23:00:00.000Z&#34;,&#34;1990-12-31T23:00:00.000Z&#34;,&#34;1991-01-31T23:00:00.000Z&#34;,&#34;1991-02-28T23:00:00.000Z&#34;,&#34;1991-03-31T23:00:00.000Z&#34;,&#34;1991-04-30T23:00:00.000Z&#34;,&#34;1991-05-31T23:00:00.000Z&#34;,&#34;1991-06-30T23:00:00.000Z&#34;,&#34;1991-07-31T23:00:00.000Z&#34;,&#34;1991-08-31T23:00:00.000Z&#34;,&#34;1991-09-30T23:00:00.000Z&#34;,&#34;1991-10-31T23:00:00.000Z&#34;,&#34;1991-11-30T23:00:00.000Z&#34;,&#34;1991-12-31T23:59:00.000Z&#34;,&#34;1992-01-31T23:00:00.000Z&#34;,&#34;1992-02-29T23:00:00.000Z&#34;,&#34;1992-03-31T23:00:00.000Z&#34;,&#34;1992-04-30T23:00:00.000Z&#34;,&#34;1992-05-31T23:00:00.000Z&#34;,&#34;1992-06-30T23:00:00.000Z&#34;,&#34;1992-07-31T23:00:00.000Z&#34;,&#34;1992-08-31T23:00:00.000Z&#34;,&#34;1992-09-30T23:00:00.000Z&#34;,&#34;1992-10-31T23:00:00.000Z&#34;,&#34;1992-11-30T23:00:00.000Z&#34;,&#34;1992-12-31T23:00:00.000Z&#34;,&#34;1993-01-31T23:00:00.000Z&#34;,&#34;1993-02-28T23:00:00.000Z&#34;,&#34;1993-03-31T23:00:00.000Z&#34;,&#34;1993-04-30T23:00:00.000Z&#34;,&#34;1993-05-31T23:00:00.000Z&#34;,&#34;1993-06-30T23:00:00.000Z&#34;,&#34;1993-07-31T23:00:00.000Z&#34;,&#34;1993-08-31T23:00:00.000Z&#34;,&#34;1993-09-30T23:00:00.000Z&#34;,&#34;1993-10-31T23:00:00.000Z&#34;,&#34;1993-11-30T23:00:00.000Z&#34;,&#34;1993-12-31T23:00:00.000Z&#34;,&#34;1994-01-31T23:00:00.000Z&#34;,&#34;1994-02-28T23:00:00.000Z&#34;,&#34;1994-03-31T23:00:00.000Z&#34;,&#34;1994-04-30T23:00:00.000Z&#34;,&#34;1994-05-31T23:00:00.000Z&#34;,&#34;1994-06-30T23:00:00.000Z&#34;,&#34;1994-07-31T23:00:00.000Z&#34;,&#34;1994-08-31T23:00:00.000Z&#34;,&#34;1994-09-30T23:00:00.000Z&#34;,&#34;1994-10-31T23:00:00.000Z&#34;,&#34;1994-11-30T23:00:00.000Z&#34;,&#34;1994-12-31T23:00:00.000Z&#34;,&#34;1995-01-31T23:00:00.000Z&#34;,&#34;1995-02-28T23:00:00.000Z&#34;,&#34;1995-03-31T23:00:00.000Z&#34;,&#34;1995-04-30T23:00:00.000Z&#34;,&#34;1995-05-31T23:00:00.000Z&#34;,&#34;1995-06-30T23:00:00.000Z&#34;,&#34;1995-07-31T23:00:00.000Z&#34;,&#34;1995-08-31T23:00:00.000Z&#34;,&#34;1995-09-30T23:00:00.000Z&#34;,&#34;1995-10-31T23:00:00.000Z&#34;,&#34;1995-11-30T23:00:00.000Z&#34;,&#34;1995-12-31T23:00:00.000Z&#34;,&#34;1996-01-31T23:00:00.000Z&#34;,&#34;1996-02-29T23:00:00.000Z&#34;,&#34;1996-03-31T23:00:00.000Z&#34;,&#34;1996-04-30T23:00:00.000Z&#34;,&#34;1996-05-31T23:00:00.000Z&#34;,&#34;1996-06-30T23:00:00.000Z&#34;,&#34;1996-07-31T23:00:00.000Z&#34;,&#34;1996-08-31T23:00:00.000Z&#34;,&#34;1996-09-30T23:00:00.000Z&#34;,&#34;1996-10-31T23:00:00.000Z&#34;,&#34;1996-11-30T23:00:00.000Z&#34;,&#34;1996-12-31T23:00:00.000Z&#34;,&#34;1997-01-31T23:00:00.000Z&#34;,&#34;1997-02-28T23:00:00.000Z&#34;,&#34;1997-03-31T23:00:00.000Z&#34;,&#34;1997-04-30T23:00:00.000Z&#34;,&#34;1997-05-31T23:00:00.000Z&#34;,&#34;1997-06-30T23:00:00.000Z&#34;,&#34;1997-07-31T23:00:00.000Z&#34;,&#34;1997-08-31T23:00:00.000Z&#34;,&#34;1997-09-30T23:00:00.000Z&#34;,&#34;1997-10-31T23:00:00.000Z&#34;,&#34;1997-11-30T23:00:00.000Z&#34;,&#34;1997-12-31T23:00:00.000Z&#34;,&#34;1998-01-31T23:00:00.000Z&#34;,&#34;1998-02-28T23:00:00.000Z&#34;,&#34;1998-03-31T23:00:00.000Z&#34;,&#34;1998-04-30T23:00:00.000Z&#34;,&#34;1998-05-31T23:00:00.000Z&#34;,&#34;1998-06-30T23:00:00.000Z&#34;,&#34;1998-07-31T23:00:00.000Z&#34;,&#34;1998-08-31T23:00:00.000Z&#34;,&#34;1998-09-30T23:00:00.000Z&#34;,&#34;1998-10-31T23:00:00.000Z&#34;,&#34;1998-11-30T23:00:00.000Z&#34;,&#34;1998-12-31T23:00:00.000Z&#34;,&#34;1999-01-31T23:00:00.000Z&#34;,&#34;1999-02-28T23:00:00.000Z&#34;,&#34;1999-03-31T23:00:00.000Z&#34;,&#34;1999-04-30T23:00:00.000Z&#34;,&#34;1999-05-31T23:00:00.000Z&#34;,&#34;1999-06-30T23:00:00.000Z&#34;,&#34;1999-07-31T23:00:00.000Z&#34;,&#34;1999-08-31T23:00:00.000Z&#34;,&#34;1999-09-30T23:00:00.000Z&#34;,&#34;1999-10-31T23:00:00.000Z&#34;,&#34;1999-11-30T23:00:00.000Z&#34;,&#34;1999-12-31T23:00:00.000Z&#34;,&#34;2000-01-31T23:00:00.000Z&#34;,&#34;2000-02-29T23:00:00.000Z&#34;,&#34;2000-03-31T23:00:00.000Z&#34;,&#34;2000-04-30T23:00:00.000Z&#34;,&#34;2000-05-31T23:00:00.000Z&#34;,&#34;2000-06-30T23:00:00.000Z&#34;,&#34;2000-07-31T23:00:00.000Z&#34;,&#34;2000-08-31T23:00:00.000Z&#34;,&#34;2000-09-30T23:00:00.000Z&#34;,&#34;2000-10-31T23:00:00.000Z&#34;,&#34;2000-11-30T23:00:00.000Z&#34;,&#34;2000-12-31T23:00:00.000Z&#34;,&#34;2001-01-31T23:00:00.000Z&#34;,&#34;2001-02-28T23:00:00.000Z&#34;,&#34;2001-03-31T23:00:00.000Z&#34;,&#34;2001-04-30T23:00:00.000Z&#34;,&#34;2001-05-31T23:00:00.000Z&#34;,&#34;2001-06-30T23:00:00.000Z&#34;,&#34;2001-07-31T23:00:00.000Z&#34;,&#34;2001-08-31T23:00:00.000Z&#34;,&#34;2001-09-30T23:00:00.000Z&#34;,&#34;2001-10-31T23:00:00.000Z&#34;,&#34;2001-11-30T23:00:00.000Z&#34;,&#34;2001-12-31T23:00:00.000Z&#34;,&#34;2002-01-31T23:00:00.000Z&#34;,&#34;2002-02-28T23:00:00.000Z&#34;,&#34;2002-03-31T23:00:00.000Z&#34;,&#34;2002-04-30T23:00:00.000Z&#34;,&#34;2002-05-31T23:00:00.000Z&#34;,&#34;2002-06-30T23:00:00.000Z&#34;,&#34;2002-07-31T23:00:00.000Z&#34;,&#34;2002-08-31T23:00:00.000Z&#34;,&#34;2002-09-30T23:00:00.000Z&#34;,&#34;2002-10-31T23:00:00.000Z&#34;,&#34;2002-11-30T23:00:00.000Z&#34;,&#34;2002-12-31T23:00:00.000Z&#34;,&#34;2003-01-31T23:00:00.000Z&#34;,&#34;2003-02-28T23:00:00.000Z&#34;,&#34;2003-03-31T23:00:00.000Z&#34;,&#34;2003-04-30T23:00:00.000Z&#34;,&#34;2003-05-31T23:00:00.000Z&#34;,&#34;2003-06-30T23:00:00.000Z&#34;,&#34;2003-07-31T23:00:00.000Z&#34;,&#34;2003-08-31T23:00:00.000Z&#34;,&#34;2003-09-30T23:00:00.000Z&#34;,&#34;2003-10-31T23:00:00.000Z&#34;,&#34;2003-11-30T23:00:00.000Z&#34;,&#34;2003-12-31T23:00:00.000Z&#34;,&#34;2004-01-31T23:00:00.000Z&#34;,&#34;2004-02-29T23:00:00.000Z&#34;,&#34;2004-03-31T23:00:00.000Z&#34;,&#34;2004-04-30T23:00:00.000Z&#34;,&#34;2004-05-31T23:00:00.000Z&#34;,&#34;2004-06-30T23:00:00.000Z&#34;,&#34;2004-07-31T23:00:00.000Z&#34;,&#34;2004-08-31T23:00:00.000Z&#34;,&#34;2004-09-30T23:00:00.000Z&#34;,&#34;2004-10-31T23:00:00.000Z&#34;,&#34;2004-11-30T23:00:00.000Z&#34;,&#34;2004-12-31T23:00:00.000Z&#34;,&#34;2005-01-31T23:00:00.000Z&#34;,&#34;2005-02-28T23:00:00.000Z&#34;,&#34;2005-03-31T23:00:00.000Z&#34;,&#34;2005-04-30T23:00:00.000Z&#34;,&#34;2005-05-31T23:00:00.000Z&#34;,&#34;2005-06-30T23:00:00.000Z&#34;,&#34;2005-07-31T23:00:00.000Z&#34;,&#34;2005-08-31T23:00:00.000Z&#34;,&#34;2005-09-30T23:00:00.000Z&#34;,&#34;2005-10-31T23:00:00.000Z&#34;,&#34;2005-11-30T23:00:00.000Z&#34;,&#34;2005-12-31T23:00:00.000Z&#34;,&#34;2006-01-31T23:00:00.000Z&#34;,&#34;2006-02-28T23:00:00.000Z&#34;,&#34;2006-03-31T23:00:00.000Z&#34;,&#34;2006-04-30T23:00:00.000Z&#34;,&#34;2006-05-31T23:00:00.000Z&#34;,&#34;2006-06-30T23:00:00.000Z&#34;,&#34;2006-07-31T23:00:00.000Z&#34;,&#34;2006-08-31T23:00:00.000Z&#34;,&#34;2006-09-30T23:00:00.000Z&#34;,&#34;2006-10-31T23:00:00.000Z&#34;,&#34;2006-11-30T23:00:00.000Z&#34;,&#34;2006-12-31T23:00:00.000Z&#34;,&#34;2007-01-31T23:00:00.000Z&#34;,&#34;2007-02-28T23:00:00.000Z&#34;,&#34;2007-03-31T23:00:00.000Z&#34;,&#34;2007-04-30T23:00:00.000Z&#34;,&#34;2007-05-31T23:00:00.000Z&#34;,&#34;2007-06-30T23:00:00.000Z&#34;,&#34;2007-07-31T23:00:00.000Z&#34;,&#34;2007-08-31T23:00:00.000Z&#34;,&#34;2007-09-30T23:00:00.000Z&#34;,&#34;2007-10-31T23:00:00.000Z&#34;,&#34;2007-11-30T23:00:00.000Z&#34;,&#34;2007-12-31T23:00:00.000Z&#34;,&#34;2008-01-31T23:00:00.000Z&#34;,&#34;2008-02-29T23:00:00.000Z&#34;,&#34;2008-03-31T23:00:00.000Z&#34;,&#34;2008-04-30T23:00:00.000Z&#34;,&#34;2008-05-31T23:00:00.000Z&#34;,&#34;2008-06-30T23:00:00.000Z&#34;,&#34;2008-07-31T23:00:00.000Z&#34;,&#34;2008-08-31T23:00:00.000Z&#34;,&#34;2008-09-30T23:00:00.000Z&#34;,&#34;2008-10-31T23:00:00.000Z&#34;,&#34;2008-11-30T23:00:00.000Z&#34;,&#34;2008-12-31T23:00:00.000Z&#34;,&#34;2009-01-31T23:00:00.000Z&#34;,&#34;2009-02-28T23:00:00.000Z&#34;,&#34;2009-03-31T23:00:00.000Z&#34;,&#34;2009-04-30T23:00:00.000Z&#34;,&#34;2009-05-31T23:00:00.000Z&#34;,&#34;2009-06-30T23:00:00.000Z&#34;,&#34;2009-07-31T23:00:00.000Z&#34;,&#34;2009-08-31T23:00:00.000Z&#34;,&#34;2009-09-30T23:00:00.000Z&#34;,&#34;2009-10-31T23:00:00.000Z&#34;,&#34;2009-11-30T23:00:00.000Z&#34;,&#34;2009-12-31T23:00:00.000Z&#34;,&#34;2010-01-31T23:00:00.000Z&#34;,&#34;2010-02-28T23:00:00.000Z&#34;,&#34;2010-03-31T23:00:00.000Z&#34;,&#34;2010-04-30T23:00:00.000Z&#34;,&#34;2010-05-31T23:00:00.000Z&#34;,&#34;2010-06-30T23:00:00.000Z&#34;,&#34;2010-07-31T23:00:00.000Z&#34;,&#34;2010-08-31T23:00:00.000Z&#34;,&#34;2010-09-30T23:00:00.000Z&#34;,&#34;2010-10-31T23:00:00.000Z&#34;,&#34;2010-11-30T23:00:00.000Z&#34;,&#34;2010-12-31T23:00:00.000Z&#34;,&#34;2011-01-31T23:00:00.000Z&#34;,&#34;2011-02-28T23:00:00.000Z&#34;,&#34;2011-03-31T23:00:00.000Z&#34;,&#34;2011-04-30T23:00:00.000Z&#34;,&#34;2011-05-31T23:00:00.000Z&#34;,&#34;2011-06-30T23:00:00.000Z&#34;,&#34;2011-07-31T23:00:00.000Z&#34;,&#34;2011-08-31T23:00:00.000Z&#34;,&#34;2011-09-30T23:00:00.000Z&#34;,&#34;2011-10-31T23:00:00.000Z&#34;,&#34;2011-11-30T23:00:00.000Z&#34;,&#34;2011-12-31T23:00:00.000Z&#34;,&#34;2012-01-31T23:00:00.000Z&#34;,&#34;2012-02-29T23:00:00.000Z&#34;,&#34;2012-03-31T23:00:00.000Z&#34;,&#34;2012-04-30T23:00:00.000Z&#34;,&#34;2012-05-31T23:00:00.000Z&#34;,&#34;2012-06-30T23:00:00.000Z&#34;,&#34;2012-07-31T23:00:00.000Z&#34;,&#34;2012-08-31T23:00:00.000Z&#34;,&#34;2012-09-30T23:00:00.000Z&#34;,&#34;2012-10-31T23:00:00.000Z&#34;,&#34;2012-11-30T23:00:00.000Z&#34;,&#34;2012-12-31T23:00:00.000Z&#34;,&#34;2013-01-31T23:00:00.000Z&#34;,&#34;2013-02-28T23:00:00.000Z&#34;,&#34;2013-03-31T23:00:00.000Z&#34;,&#34;2013-04-30T23:00:00.000Z&#34;,&#34;2013-05-31T23:00:00.000Z&#34;,&#34;2013-06-30T23:00:00.000Z&#34;,&#34;2013-07-31T23:00:00.000Z&#34;,&#34;2013-08-31T23:00:00.000Z&#34;,&#34;2013-09-30T23:00:00.000Z&#34;,&#34;2013-10-31T23:00:00.000Z&#34;,&#34;2013-11-30T23:00:00.000Z&#34;,&#34;2013-12-31T23:00:00.000Z&#34;,&#34;2014-01-31T23:00:00.000Z&#34;,&#34;2014-02-28T23:00:00.000Z&#34;,&#34;2014-03-31T23:00:00.000Z&#34;,&#34;2014-04-30T23:00:00.000Z&#34;,&#34;2014-05-31T23:00:00.000Z&#34;,&#34;2014-06-30T23:00:00.000Z&#34;,&#34;2014-07-31T23:00:00.000Z&#34;,&#34;2014-08-31T23:00:00.000Z&#34;,&#34;2014-09-30T23:00:00.000Z&#34;,&#34;2014-10-31T23:00:00.000Z&#34;,&#34;2014-11-30T23:00:00.000Z&#34;,&#34;2014-12-31T23:00:00.000Z&#34;,&#34;2015-01-31T23:00:00.000Z&#34;,&#34;2015-02-28T23:00:00.000Z&#34;,&#34;2015-03-31T23:00:00.000Z&#34;,&#34;2015-04-30T23:00:00.000Z&#34;,&#34;2015-05-31T23:00:00.000Z&#34;,&#34;2015-06-30T23:00:00.000Z&#34;,&#34;2015-07-31T23:00:00.000Z&#34;,&#34;2015-08-31T23:00:00.000Z&#34;,&#34;2015-09-30T23:00:00.000Z&#34;,&#34;2015-10-31T23:00:00.000Z&#34;,&#34;2015-11-30T23:00:00.000Z&#34;,&#34;2015-12-31T23:00:00.000Z&#34;,&#34;2016-01-31T23:00:00.000Z&#34;,&#34;2016-02-29T23:00:00.000Z&#34;,&#34;2016-03-31T23:00:00.000Z&#34;,&#34;2016-04-30T23:00:00.000Z&#34;,&#34;2016-05-31T23:00:00.000Z&#34;,&#34;2016-06-30T23:00:00.000Z&#34;,&#34;2016-07-31T23:00:00.000Z&#34;,&#34;2016-08-31T23:00:00.000Z&#34;,&#34;2016-09-30T23:00:00.000Z&#34;,&#34;2016-10-31T23:00:00.000Z&#34;,&#34;2016-11-30T23:00:00.000Z&#34;,&#34;2016-12-31T23:00:00.000Z&#34;,&#34;2017-01-31T23:00:00.000Z&#34;,&#34;2017-02-28T23:00:00.000Z&#34;,&#34;2017-03-31T23:00:00.000Z&#34;,&#34;2017-04-30T23:00:00.000Z&#34;,&#34;2017-05-31T23:00:00.000Z&#34;,&#34;2017-06-30T23:00:00.000Z&#34;],[3.7802758,56.3586381,260.3888677,625.9505237,213.4836196,464.2701391,820.6306025,202.9594583,104.8613373,83.4852837,57.3055063,69.8579216,160.8489219,203.647425,86.4835008,1371.6885318,665.3429994,1175.6329419,535.4907402,658.9698367,314.3131511,132.03125,88.1904741,60.2780654,53.5494167,49.944552,80.0849078,237.2109524,530.2246944,704.5768589,432.5458789,187.5653305,169.6181516,136.5737526,82.904165,237.8347914,60.3248539,54.2112857,227.1262302,387.136036,343.7177372,565.8243157,298.9836557,346.3492953,224.475727,127.9018332,119.946705316667,89.6544644,262.3556983,264.1506258,415.823797,264.7851101,361.0241224,727.7050601,364.8941535,182.5931677,112.4753924,154.2757438,74.9634786,56.587943,241.5875277,175.326587,159.8660388,229.6313413,823.5507065,564.6579008,382.8533974,186.8510889,122.3111521,99.2855387,102.882396,49.7710749,48.8957673,209.7798614,309.8706824,908.0142553,365.7594662,390.4738143,342.7487299,377.5097003,254.06002,138.9433434,115.3248751,76.5737012,60.1153666,153.4351246,599.2152189,658.6192259,672.4728601,593.5798192,297.630038,421.7941855,168.3327704,117.768759230833,166.12360575,74.8319481,67.4789791,145.156347,73.8189391,256.7566895,249.1635381,485.3841496,453.7826169,323.6599124,131.0014328,89.8918581,67.070554,47.1495066,45.8393915,42.4173809,476.5556162,556.1542787,556.2166183,632.0792716,504.6569056,261.4800951,147.983267,160.9664434,84.343712,52.8999418,59.2616686,71.1915876,154.8413265,258.9812069,638.2907024,646.2527565,294.0854366,169.4928814,97.5666069,81.3909921,81.4420345,61.5355091,44.3162352,74.6074583,499.6221152,310.2021132,173.3923038,349.9505467,388.8799243,177.163071,95.3938196,87.2299503,57.5575699,41.0919021,104.2526334,38.5662837,77.0710066,58.0894868,582.6598482,338.3124739,286.9460804,214.9424244,116.7956811,204.8026491,66.5112646,45.8828376,45.1953311,36.9738883,244.6874084,754.6503783,305.2887,1230.1019803,535.3174178,357.1119511,206.7754807,119.8906961,93.4200565,77.0419435,66.2181101,218.5870509,646.6087433,442.7563474,852.353253,633.262511,218.2395625,254.74893,147.0484428,94.3196585,63.1891627,50.5870344,53.135834,50.7296043,144.0027385,1350.6081364,771.2219619,491.953903,343.1067029,342.761083,580.7621722,482.1737261,272.816823,126.4851585,107.2394413,391.6862829,695.4251495,2409.4840881,1292.0242617,1288.5750569,428.9443298,250.3307667,133.8473572,170.1537731,97.2732113,61.5263532,61.9254554,168.5049674,277.7203081,74.6576304,119.5410404,558.6333004,407.1939584,291.9095809,185.7427477,115.4135223,84.606556,81.3144836,86.9963668,103.5932474,312.9356413,624.2437068,295.5704614,412.6749334,221.8290953,515.738039,177.1327456,107.9211568,89.0890767,63.9128978,51.0237184,174.8074006,288.3412305,442.0957716,259.4879314,377.3439894,225.5335378,152.5992513,266.7087605,285.5870586,244.8658366,99.3235173,107.8782592,115.7664837,84.5752232,210.8547477,624.1210015,727.0706793,684.2212489,223.7039948,169.5824732,106.6613887,140.6579635,57.9327165,54.5711256,169.4817386,260.2592268,331.3900651,399.5299249,468.1738778,247.9294635,408.0318752,147.0811719,219.4349675,86.1231064,94.1084925,106.6074862,58.4854734,951.0730718,1181.8263944,973.6247262,448.465863,537.4520921,254.8544822,128.9035111,106.9608889,70.1369559,50.5564606,61.9363117,87.4846596,699.3024035,255.4371792,688.8318655,394.0906437,495.3401963,564.9521675,143.6138107,257.0202401,156.9915147,147.8099936,267.2916779,187.6753382,253.3507908,1413.4460666,704.4408486,570.8584705,344.933003,180.4477668,123.1530348,97.0892013,92.3011318,57.5448626,108.6139538,225.2803655,338.1218009,750.1515757,789.22228,985.1418358,543.2097847,204.8934661,121.6494927,89.207964,99.2038122,53.8445771,76.1958717,100.8347812,468.0538481,457.9861417,689.95559,754.2075872,491.9111528,263.2351324,146.7097284,232.3054708,91.9018007,64.3000006,63.9278172,189.6061777,327.7857172,400.7042108,616.3147061,503.9200244,588.3563496,252.1940774,150.5873227,96.3239787,69.7142922,61.1327672,240.0049285,141.2286415,381.9909822,343.8730182,673.4190786,597.1008446,587.0939077,263.7143293,199.0728234,102.1022085,74.0268542,94.7849453,55.5009784,1291.36334055,443.3561711,487.8474972,1355.5880379,645.4366855,259.9309971,132.4596062,104.7032675,92.1567963,60.0087186,47.0359754,53.9965158,73.6469916,430.9892201,685.9966543,999.5606345,575.3699542,642.3881252,323.7195848,152.1771159,102.323817990833,73.39796335,109.7462643,111.4413544,334.7444539,326.7438547,1409.8656529,822.501199,396.4801722,419.1970448,552.9829823,260.7587223,154.5818164,91.2793892,72.1292772,58.1607876,506.467932,521.1560548,625.9776542,1415.5580243,613.8095176,216.5764072,128.1571645,86.6008784,75.9715909,84.7880908,42.4115086,42.7514408,113.6936936,116.4802805,1469.8583598,519.4329685,305.5077076,221.0838033,144.2864736,86.6978853,66.1653921,52.9576654,40.8662235,38.7609668,38.0332389,188.9190998,391.2661007,707.0808472,603.4388896,293.2782782,343.9411307,154.2866749,120.1757179,76.1215167,80.3295897,73.2821501,308.1987798,95.8142756,731.6103051,446.9362437,540.8419303,814.0506714,1939.0061545,435.6174046,330.8812218,163.7199501,96.4990238,83.3173437,97.414376,207.4263858,800.1035266,358.6015083,552.465685,318.5491169,134.3785509,444.1012996,160.1427775,101.5060812,65.8957412,63.646587,81.7807619,675.48262,354.6209781,617.292962445,371.792446585,280.8031168,156.2299265,286.6647421,114.3377466,82.1758145,54.0209329,50.0162424,115.5186432,183.4392569,319.7657228,474.9072671,652.2740165,566.5327219,228.2521134,161.9541694,97.0672416,99.0007781,57.8509952,52.7272647,44.7008597,347.7989641,295.3543737,393.1694239,342.8860476,538.7959912,169.3834915,98.3815205,72.4472505,60.2272509,47.7133816,40.3395634,84.877874,583.1464184,381.5013487,1277.0780574,1018.66692771833,875.0812288,539.2979063,236.1687507,126.8796049,279.2403319,82.1637711,69.9456908,182.732075608333,325.8305547,458.1787284,551.126505032301,640.290067,370.5068591,315.4579164,161.6275376,106.4396997,75.6027411,53.5084492,152.7581481,98.2316046,97.6264825,95.1304009,134.153907,454.3001652,369.417289,281.117797,121.6823161,128.4833792,79.8186075,49.8769787,48.1206956,190.0140838,62.7946053,315.9643256,284.071047,782.6027964,190.2869793,226.6191605,90.2934906,69.6228926,107.914081,53.553887,41.4158678,101.0191618,401.2738764,772.8439656,453.3832877,706.1554384,293.4151377,166.6512819,111.5135555,71.3109539,53.0052444,40.2779781,41.5657553,97.1534984,431.0067023,1915.6491322,434.958129,557.7422114,217.397778,168.8247743,183.1626019,109.1761887,61.2274018,53.7512834,60.053861,155.9680107,357.4378569,403.56281168331,620.7977127,737.4056853,438.142578,264.7391766,354.0283879,149.5751824,117.5977572,74.2946482,60.8726297,49.7995902,975.2494143,571.3842134,2042.8690401,505.3113972,959.6025196,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,365.81004,139.82868,148.03092,111.20976,58.0102294736842,44.5750105263158,53.53416,91.37952,119.34324,335.96532,555.7446,837.71028,410.18076,304.63056,105.20856,124.0146,80.51112,63.31536,88.1442,256.77036,161.26092,513.59328,472.7916,1060.20324,921.99852,332.1324,439.7382,167.1228,115.81848,69.49584,98.67528,130.55076,293.2722,771.39648,444.456,563.25816,277.08912,136.12068,115.191,84.00492,69.6674947924528,52.8505852075472,69.6546,43.31376,56.80584,178.51896,178.5726,359.3736,222.32358,null,null,63.19836,55.36296,38.7378,52.6626,127.22544,81.9648,446.78628,520.0938,362.31048,242.72748,145.84356,79.5366,64.14444,52.69248,37.71612,37.87308,38.59092,38.68596,297.41076]]},&#34;evals&#34;:[&#34;attrs.interactionModel&#34;],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;hr /&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;rainfall-record&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Rainfall Record&lt;/h2&gt;
&lt;hr /&gt;
&lt;p&gt;Here are the recent monthly rainfall values relative to averages across the entire time period (1945 to current):&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-Langrivier_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Black error bars around the mean (grey column) indicate 95% confidence intervals. Monthly values lower than the lower bar are among the lowest 5% of recorded flows for that month.&lt;/p&gt;
&lt;p&gt;*Indicates that these months were missing data in 2015 due to power supply problems.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;And if we view this cumulatively:&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-Langrivier_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Or compare across all years on record:&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-Langrivier_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;768&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;So 2015 and 2016 have been the lowest rainfall years on record, while 2014 was not far behind…&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Or dynamically:&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;div id=&#34;htmlwidget-2&#34; style=&#34;width:672px;height:480px;&#34; class=&#34;dygraphs html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-2&#34;&gt;{&#34;x&#34;:{&#34;attrs&#34;:{&#34;title&#34;:&#34;Monthly Rainfall record for Dwarsberg&#34;,&#34;xlabel&#34;:&#34;Date&#34;,&#34;ylabel&#34;:&#34;Rainfall (mm)&#34;,&#34;labels&#34;:[&#34;month&#34;,&#34;Summed rainfall&#34;],&#34;legend&#34;:&#34;auto&#34;,&#34;retainDateWindow&#34;:false,&#34;axes&#34;:{&#34;x&#34;:{&#34;pixelsPerLabel&#34;:60}},&#34;showRangeSelector&#34;:true,&#34;rangeSelectorHeight&#34;:40,&#34;rangeSelectorPlotFillColor&#34;:&#34; #A7B1C4&#34;,&#34;rangeSelectorPlotStrokeColor&#34;:&#34;#808FAB&#34;,&#34;interactionModel&#34;:&#34;Dygraph.Interaction.defaultModel&#34;},&#34;scale&#34;:&#34;monthly&#34;,&#34;annotations&#34;:[],&#34;shadings&#34;:[{&#34;from&#34;:&#34;1991-09-01T00:00:00.000Z&#34;,&#34;to&#34;:&#34;2013-03-03T00:00:00.000Z&#34;,&#34;color&#34;:&#34;#EFEFEF&#34;,&#34;axis&#34;:&#34;x&#34;}],&#34;events&#34;:[{&#34;pos&#34;:275.959679214403,&#34;label&#34;:&#34;Mean&#34;,&#34;labelLoc&#34;:&#34;left&#34;,&#34;color&#34;:&#34;black&#34;,&#34;strokePattern&#34;:[7,3],&#34;axis&#34;:&#34;y&#34;}],&#34;format&#34;:&#34;date&#34;,&#34;data&#34;:[[&#34;1945-01-01T00:00:00.000Z&#34;,&#34;1945-02-01T00:00:00.000Z&#34;,&#34;1945-03-01T00:00:00.000Z&#34;,&#34;1945-04-01T00:00:00.000Z&#34;,&#34;1945-05-01T00:00:00.000Z&#34;,&#34;1945-06-01T00:00:00.000Z&#34;,&#34;1945-07-01T00:00:00.000Z&#34;,&#34;1945-08-01T00:00:00.000Z&#34;,&#34;1945-09-01T00:00:00.000Z&#34;,&#34;1945-10-01T00:00:00.000Z&#34;,&#34;1945-11-01T00:00:00.000Z&#34;,&#34;1945-12-01T00:00:00.000Z&#34;,&#34;1946-01-01T00:00:00.000Z&#34;,&#34;1946-02-01T00:00:00.000Z&#34;,&#34;1946-03-01T00:00:00.000Z&#34;,&#34;1946-04-01T00:00:00.000Z&#34;,&#34;1946-05-01T00:00:00.000Z&#34;,&#34;1946-06-01T00:00:00.000Z&#34;,&#34;1946-07-01T00:00:00.000Z&#34;,&#34;1946-08-01T00:00:00.000Z&#34;,&#34;1946-09-01T00:00:00.000Z&#34;,&#34;1946-10-01T00:00:00.000Z&#34;,&#34;1946-11-01T00:00:00.000Z&#34;,&#34;1946-12-01T00:00:00.000Z&#34;,&#34;1947-01-01T00:00:00.000Z&#34;,&#34;1947-02-01T00:00:00.000Z&#34;,&#34;1947-03-01T00:00:00.000Z&#34;,&#34;1947-04-01T00:00:00.000Z&#34;,&#34;1947-05-01T00:00:00.000Z&#34;,&#34;1947-06-01T00:00:00.000Z&#34;,&#34;1947-07-01T00:00:00.000Z&#34;,&#34;1947-08-01T00:00:00.000Z&#34;,&#34;1947-09-01T00:00:00.000Z&#34;,&#34;1947-10-01T00:00:00.000Z&#34;,&#34;1947-11-01T00:00:00.000Z&#34;,&#34;1947-12-01T00:00:00.000Z&#34;,&#34;1948-01-01T00:00:00.000Z&#34;,&#34;1948-02-01T00:00:00.000Z&#34;,&#34;1948-03-01T00:00:00.000Z&#34;,&#34;1948-04-01T00:00:00.000Z&#34;,&#34;1948-05-01T00:00:00.000Z&#34;,&#34;1948-06-01T00:00:00.000Z&#34;,&#34;1948-07-01T00:00:00.000Z&#34;,&#34;1948-08-01T00:00:00.000Z&#34;,&#34;1948-09-01T00:00:00.000Z&#34;,&#34;1948-10-01T00:00:00.000Z&#34;,&#34;1948-11-01T00:00:00.000Z&#34;,&#34;1948-12-01T00:00:00.000Z&#34;,&#34;1949-01-01T00:00:00.000Z&#34;,&#34;1949-02-01T00:00:00.000Z&#34;,&#34;1949-03-01T00:00:00.000Z&#34;,&#34;1949-04-01T00:00:00.000Z&#34;,&#34;1949-05-01T00:00:00.000Z&#34;,&#34;1949-06-01T00:00:00.000Z&#34;,&#34;1949-07-01T00:00:00.000Z&#34;,&#34;1949-08-01T00:00:00.000Z&#34;,&#34;1949-09-01T00:00:00.000Z&#34;,&#34;1949-10-01T00:00:00.000Z&#34;,&#34;1949-11-01T00:00:00.000Z&#34;,&#34;1949-12-01T00:00:00.000Z&#34;,&#34;1950-01-01T00:00:00.000Z&#34;,&#34;1950-02-01T00:00:00.000Z&#34;,&#34;1950-03-01T00:00:00.000Z&#34;,&#34;1950-04-01T00:00:00.000Z&#34;,&#34;1950-05-01T00:00:00.000Z&#34;,&#34;1950-06-01T00:00:00.000Z&#34;,&#34;1950-07-01T00:00:00.000Z&#34;,&#34;1950-08-01T00:00:00.000Z&#34;,&#34;1950-09-01T00:00:00.000Z&#34;,&#34;1950-10-01T00:00:00.000Z&#34;,&#34;1950-11-01T00:00:00.000Z&#34;,&#34;1950-12-01T00:00:00.000Z&#34;,&#34;1951-01-01T00:00:00.000Z&#34;,&#34;1951-02-01T00:00:00.000Z&#34;,&#34;1951-03-01T00:00:00.000Z&#34;,&#34;1951-04-01T00:00:00.000Z&#34;,&#34;1951-05-01T00:00:00.000Z&#34;,&#34;1951-06-01T00:00:00.000Z&#34;,&#34;1951-07-01T00:00:00.000Z&#34;,&#34;1951-08-01T00:00:00.000Z&#34;,&#34;1951-09-01T00:00:00.000Z&#34;,&#34;1951-10-01T00:00:00.000Z&#34;,&#34;1951-11-01T00:00:00.000Z&#34;,&#34;1951-12-01T00:00:00.000Z&#34;,&#34;1952-01-01T00:00:00.000Z&#34;,&#34;1952-02-01T00:00:00.000Z&#34;,&#34;1952-03-01T00:00:00.000Z&#34;,&#34;1952-04-01T00:00:00.000Z&#34;,&#34;1952-05-01T00:00:00.000Z&#34;,&#34;1952-06-01T00:00:00.000Z&#34;,&#34;1952-07-01T00:00:00.000Z&#34;,&#34;1952-08-01T00:00:00.000Z&#34;,&#34;1952-09-01T00:00:00.000Z&#34;,&#34;1952-10-01T00:00:00.000Z&#34;,&#34;1952-11-01T00:00:00.000Z&#34;,&#34;1952-12-01T00:00:00.000Z&#34;,&#34;1953-01-01T00:00:00.000Z&#34;,&#34;1953-02-01T00:00:00.000Z&#34;,&#34;1953-03-01T00:00:00.000Z&#34;,&#34;1953-04-01T00:00:00.000Z&#34;,&#34;1953-05-01T00:00:00.000Z&#34;,&#34;1953-06-01T00:00:00.000Z&#34;,&#34;1953-07-01T00:00:00.000Z&#34;,&#34;1953-08-01T00:00:00.000Z&#34;,&#34;1953-09-01T00:00:00.000Z&#34;,&#34;1953-10-01T00:00:00.000Z&#34;,&#34;1953-11-01T00:00:00.000Z&#34;,&#34;1953-12-01T00:00:00.000Z&#34;,&#34;1954-01-01T00:00:00.000Z&#34;,&#34;1954-02-01T00:00:00.000Z&#34;,&#34;1954-03-01T00:00:00.000Z&#34;,&#34;1954-04-01T00:00:00.000Z&#34;,&#34;1954-05-01T00:00:00.000Z&#34;,&#34;1954-06-01T00:00:00.000Z&#34;,&#34;1954-07-01T00:00:00.000Z&#34;,&#34;1954-08-01T00:00:00.000Z&#34;,&#34;1954-09-01T00:00:00.000Z&#34;,&#34;1954-10-01T00:00:00.000Z&#34;,&#34;1954-11-01T00:00:00.000Z&#34;,&#34;1954-12-01T00:00:00.000Z&#34;,&#34;1955-01-01T00:00:00.000Z&#34;,&#34;1955-02-01T00:00:00.000Z&#34;,&#34;1955-03-01T00:00:00.000Z&#34;,&#34;1955-04-01T00:00:00.000Z&#34;,&#34;1955-05-01T00:00:00.000Z&#34;,&#34;1955-06-01T00:00:00.000Z&#34;,&#34;1955-07-01T00:00:00.000Z&#34;,&#34;1955-08-01T00:00:00.000Z&#34;,&#34;1955-09-01T00:00:00.000Z&#34;,&#34;1955-10-01T00:00:00.000Z&#34;,&#34;1955-11-01T00:00:00.000Z&#34;,&#34;1955-12-01T00:00:00.000Z&#34;,&#34;1956-01-01T00:00:00.000Z&#34;,&#34;1956-02-01T00:00:00.000Z&#34;,&#34;1956-03-01T00:00:00.000Z&#34;,&#34;1956-04-01T00:00:00.000Z&#34;,&#34;1956-05-01T00:00:00.000Z&#34;,&#34;1956-06-01T00:00:00.000Z&#34;,&#34;1956-07-01T00:00:00.000Z&#34;,&#34;1956-08-01T00:00:00.000Z&#34;,&#34;1956-09-01T00:00:00.000Z&#34;,&#34;1956-10-01T00:00:00.000Z&#34;,&#34;1956-11-01T00:00:00.000Z&#34;,&#34;1956-12-01T00:00:00.000Z&#34;,&#34;1957-01-01T00:00:00.000Z&#34;,&#34;1957-02-01T00:00:00.000Z&#34;,&#34;1957-03-01T00:00:00.000Z&#34;,&#34;1957-04-01T00:00:00.000Z&#34;,&#34;1957-05-01T00:00:00.000Z&#34;,&#34;1957-06-01T00:00:00.000Z&#34;,&#34;1957-07-01T00:00:00.000Z&#34;,&#34;1957-08-01T00:00:00.000Z&#34;,&#34;1957-09-01T00:00:00.000Z&#34;,&#34;1957-10-01T00:00:00.000Z&#34;,&#34;1957-11-01T00:00:00.000Z&#34;,&#34;1957-12-01T00:00:00.000Z&#34;,&#34;1958-01-01T00:00:00.000Z&#34;,&#34;1958-02-01T00:00:00.000Z&#34;,&#34;1958-03-01T00:00:00.000Z&#34;,&#34;1958-04-01T00:00:00.000Z&#34;,&#34;1958-05-01T00:00:00.000Z&#34;,&#34;1958-06-01T00:00:00.000Z&#34;,&#34;1958-07-01T00:00:00.000Z&#34;,&#34;1958-08-01T00:00:00.000Z&#34;,&#34;1958-09-01T00:00:00.000Z&#34;,&#34;1958-10-01T00:00:00.000Z&#34;,&#34;1958-11-01T00:00:00.000Z&#34;,&#34;1958-12-01T00:00:00.000Z&#34;,&#34;1959-01-01T00:00:00.000Z&#34;,&#34;1959-02-01T00:00:00.000Z&#34;,&#34;1959-03-01T00:00:00.000Z&#34;,&#34;1959-04-01T00:00:00.000Z&#34;,&#34;1959-05-01T00:00:00.000Z&#34;,&#34;1959-06-01T00:00:00.000Z&#34;,&#34;1959-07-01T00:00:00.000Z&#34;,&#34;1959-08-01T00:00:00.000Z&#34;,&#34;1959-09-01T00:00:00.000Z&#34;,&#34;1959-10-01T00:00:00.000Z&#34;,&#34;1959-11-01T00:00:00.000Z&#34;,&#34;1959-12-01T00:00:00.000Z&#34;,&#34;1960-01-01T00:00:00.000Z&#34;,&#34;1960-02-01T00:00:00.000Z&#34;,&#34;1960-03-01T00:00:00.000Z&#34;,&#34;1960-04-01T00:00:00.000Z&#34;,&#34;1960-05-01T00:00:00.000Z&#34;,&#34;1960-06-01T00:00:00.000Z&#34;,&#34;1960-07-01T00:00:00.000Z&#34;,&#34;1960-08-01T00:00:00.000Z&#34;,&#34;1960-09-01T00:00:00.000Z&#34;,&#34;1960-10-01T00:00:00.000Z&#34;,&#34;1960-11-01T00:00:00.000Z&#34;,&#34;1960-12-01T00:00:00.000Z&#34;,&#34;1961-01-01T00:00:00.000Z&#34;,&#34;1961-02-01T00:00:00.000Z&#34;,&#34;1961-03-01T00:00:00.000Z&#34;,&#34;1961-04-01T00:00:00.000Z&#34;,&#34;1961-05-01T00:00:00.000Z&#34;,&#34;1961-06-01T00:00:00.000Z&#34;,&#34;1961-07-01T00:00:00.000Z&#34;,&#34;1961-08-01T00:00:00.000Z&#34;,&#34;1961-09-01T00:00:00.000Z&#34;,&#34;1961-10-01T00:00:00.000Z&#34;,&#34;1961-11-01T00:00:00.000Z&#34;,&#34;1961-12-01T00:00:00.000Z&#34;,&#34;1962-01-01T00:00:00.000Z&#34;,&#34;1962-02-01T00:00:00.000Z&#34;,&#34;1962-03-01T00:00:00.000Z&#34;,&#34;1962-04-01T00:00:00.000Z&#34;,&#34;1962-05-01T00:00:00.000Z&#34;,&#34;1962-06-01T00:00:00.000Z&#34;,&#34;1962-07-01T00:00:00.000Z&#34;,&#34;1962-08-01T00:00:00.000Z&#34;,&#34;1962-09-01T00:00:00.000Z&#34;,&#34;1962-10-01T00:00:00.000Z&#34;,&#34;1962-11-01T00:00:00.000Z&#34;,&#34;1962-12-01T00:00:00.000Z&#34;,&#34;1963-01-01T00:00:00.000Z&#34;,&#34;1963-02-01T00:00:00.000Z&#34;,&#34;1963-03-01T00:00:00.000Z&#34;,&#34;1963-04-01T00:00:00.000Z&#34;,&#34;1963-05-01T00:00:00.000Z&#34;,&#34;1963-06-01T00:00:00.000Z&#34;,&#34;1963-07-01T00:00:00.000Z&#34;,&#34;1963-08-01T00:00:00.000Z&#34;,&#34;1963-09-01T00:00:00.000Z&#34;,&#34;1963-10-01T00:00:00.000Z&#34;,&#34;1963-11-01T00:00:00.000Z&#34;,&#34;1963-12-01T00:00:00.000Z&#34;,&#34;1964-01-01T00:00:00.000Z&#34;,&#34;1964-02-01T00:00:00.000Z&#34;,&#34;1964-03-01T00:00:00.000Z&#34;,&#34;1964-04-01T00:00:00.000Z&#34;,&#34;1964-05-01T00:00:00.000Z&#34;,&#34;1964-06-01T00:00:00.000Z&#34;,&#34;1964-07-01T00:00:00.000Z&#34;,&#34;1964-08-01T00:00:00.000Z&#34;,&#34;1964-09-01T00:00:00.000Z&#34;,&#34;1964-10-01T00:00:00.000Z&#34;,&#34;1964-11-01T00:00:00.000Z&#34;,&#34;1964-12-01T00:00:00.000Z&#34;,&#34;1965-01-01T00:00:00.000Z&#34;,&#34;1965-02-01T00:00:00.000Z&#34;,&#34;1965-03-01T00:00:00.000Z&#34;,&#34;1965-04-01T00:00:00.000Z&#34;,&#34;1965-05-01T00:00:00.000Z&#34;,&#34;1965-06-01T00:00:00.000Z&#34;,&#34;1965-07-01T00:00:00.000Z&#34;,&#34;1965-08-01T00:00:00.000Z&#34;,&#34;1965-09-01T00:00:00.000Z&#34;,&#34;1965-10-01T00:00:00.000Z&#34;,&#34;1965-11-01T00:00:00.000Z&#34;,&#34;1965-12-01T00:00:00.000Z&#34;,&#34;1966-01-01T00:00:00.000Z&#34;,&#34;1966-02-01T00:00:00.000Z&#34;,&#34;1966-03-01T00:00:00.000Z&#34;,&#34;1966-04-01T00:00:00.000Z&#34;,&#34;1966-05-01T00:00:00.000Z&#34;,&#34;1966-06-01T00:00:00.000Z&#34;,&#34;1966-07-01T00:00:00.000Z&#34;,&#34;1966-08-01T00:00:00.000Z&#34;,&#34;1966-09-01T00:00:00.000Z&#34;,&#34;1966-10-01T00:00:00.000Z&#34;,&#34;1966-11-01T00:00:00.000Z&#34;,&#34;1966-12-01T00:00:00.000Z&#34;,&#34;1967-01-01T00:00:00.000Z&#34;,&#34;1967-02-01T00:00:00.000Z&#34;,&#34;1967-03-01T00:00:00.000Z&#34;,&#34;1967-04-01T00:00:00.000Z&#34;,&#34;1967-05-01T00:00:00.000Z&#34;,&#34;1967-06-01T00:00:00.000Z&#34;,&#34;1967-07-01T00:00:00.000Z&#34;,&#34;1967-08-01T00:00:00.000Z&#34;,&#34;1967-09-01T00:00:00.000Z&#34;,&#34;1967-10-01T00:00:00.000Z&#34;,&#34;1967-11-01T00:00:00.000Z&#34;,&#34;1967-12-01T00:00:00.000Z&#34;,&#34;1968-01-01T00:00:00.000Z&#34;,&#34;1968-02-01T00:00:00.000Z&#34;,&#34;1968-03-01T00:00:00.000Z&#34;,&#34;1968-04-01T00:00:00.000Z&#34;,&#34;1968-05-01T00:00:00.000Z&#34;,&#34;1968-06-01T00:00:00.000Z&#34;,&#34;1968-07-01T00:00:00.000Z&#34;,&#34;1968-08-01T00:00:00.000Z&#34;,&#34;1968-09-01T00:00:00.000Z&#34;,&#34;1968-10-01T00:00:00.000Z&#34;,&#34;1968-11-01T00:00:00.000Z&#34;,&#34;1968-12-01T00:00:00.000Z&#34;,&#34;1969-01-01T00:00:00.000Z&#34;,&#34;1969-02-01T00:00:00.000Z&#34;,&#34;1969-03-01T00:00:00.000Z&#34;,&#34;1969-04-01T00:00:00.000Z&#34;,&#34;1969-05-01T00:00:00.000Z&#34;,&#34;1969-06-01T00:00:00.000Z&#34;,&#34;1969-07-01T00:00:00.000Z&#34;,&#34;1969-08-01T00:00:00.000Z&#34;,&#34;1969-09-01T00:00:00.000Z&#34;,&#34;1969-10-01T00:00:00.000Z&#34;,&#34;1969-11-01T00:00:00.000Z&#34;,&#34;1969-12-01T00:00:00.000Z&#34;,&#34;1970-01-01T00:00:00.000Z&#34;,&#34;1970-02-01T00:00:00.000Z&#34;,&#34;1970-03-01T00:00:00.000Z&#34;,&#34;1970-04-01T00:00:00.000Z&#34;,&#34;1970-05-01T00:00:00.000Z&#34;,&#34;1970-06-01T00:00:00.000Z&#34;,&#34;1970-07-01T00:00:00.000Z&#34;,&#34;1970-08-01T00:00:00.000Z&#34;,&#34;1970-09-01T00:00:00.000Z&#34;,&#34;1970-10-01T00:00:00.000Z&#34;,&#34;1970-11-01T00:00:00.000Z&#34;,&#34;1970-12-01T00:00:00.000Z&#34;,&#34;1971-01-01T00:00:00.000Z&#34;,&#34;1971-02-01T00:00:00.000Z&#34;,&#34;1971-03-01T00:00:00.000Z&#34;,&#34;1971-04-01T00:00:00.000Z&#34;,&#34;1971-05-01T00:00:00.000Z&#34;,&#34;1971-06-01T00:00:00.000Z&#34;,&#34;1971-07-01T00:00:00.000Z&#34;,&#34;1971-08-01T00:00:00.000Z&#34;,&#34;1971-09-01T00:00:00.000Z&#34;,&#34;1971-10-01T00:00:00.000Z&#34;,&#34;1971-11-01T00:00:00.000Z&#34;,&#34;1971-12-01T00:00:00.000Z&#34;,&#34;1972-01-01T00:00:00.000Z&#34;,&#34;1972-02-01T00:00:00.000Z&#34;,&#34;1972-03-01T00:00:00.000Z&#34;,&#34;1972-04-01T00:00:00.000Z&#34;,&#34;1972-05-01T00:00:00.000Z&#34;,&#34;1972-06-01T00:00:00.000Z&#34;,&#34;1972-07-01T00:00:00.000Z&#34;,&#34;1972-08-01T00:00:00.000Z&#34;,&#34;1972-09-01T00:00:00.000Z&#34;,&#34;1972-10-01T00:00:00.000Z&#34;,&#34;1972-11-01T00:00:00.000Z&#34;,&#34;1972-12-01T00:00:00.000Z&#34;,&#34;1973-01-01T00:00:00.000Z&#34;,&#34;1973-02-01T00:00:00.000Z&#34;,&#34;1973-03-01T00:00:00.000Z&#34;,&#34;1973-04-01T00:00:00.000Z&#34;,&#34;1973-05-01T00:00:00.000Z&#34;,&#34;1973-06-01T00:00:00.000Z&#34;,&#34;1973-07-01T00:00:00.000Z&#34;,&#34;1973-08-01T00:00:00.000Z&#34;,&#34;1973-09-01T00:00:00.000Z&#34;,&#34;1973-10-01T00:00:00.000Z&#34;,&#34;1973-11-01T00:00:00.000Z&#34;,&#34;1973-12-01T00:00:00.000Z&#34;,&#34;1974-01-01T00:00:00.000Z&#34;,&#34;1974-02-01T00:00:00.000Z&#34;,&#34;1974-03-01T00:00:00.000Z&#34;,&#34;1974-04-01T00:00:00.000Z&#34;,&#34;1974-05-01T00:00:00.000Z&#34;,&#34;1974-06-01T00:00:00.000Z&#34;,&#34;1974-07-01T00:00:00.000Z&#34;,&#34;1974-08-01T00:00:00.000Z&#34;,&#34;1974-09-01T00:00:00.000Z&#34;,&#34;1974-10-01T00:00:00.000Z&#34;,&#34;1974-11-01T00:00:00.000Z&#34;,&#34;1974-12-01T00:00:00.000Z&#34;,&#34;1975-01-01T00:00:00.000Z&#34;,&#34;1975-02-01T00:00:00.000Z&#34;,&#34;1975-03-01T00:00:00.000Z&#34;,&#34;1975-04-01T00:00:00.000Z&#34;,&#34;1975-05-01T00:00:00.000Z&#34;,&#34;1975-06-01T00:00:00.000Z&#34;,&#34;1975-07-01T00:00:00.000Z&#34;,&#34;1975-08-01T00:00:00.000Z&#34;,&#34;1975-09-01T00:00:00.000Z&#34;,&#34;1975-10-01T00:00:00.000Z&#34;,&#34;1975-11-01T00:00:00.000Z&#34;,&#34;1975-12-01T00:00:00.000Z&#34;,&#34;1976-01-01T00:00:00.000Z&#34;,&#34;1976-02-01T00:00:00.000Z&#34;,&#34;1976-03-01T00:00:00.000Z&#34;,&#34;1976-04-01T00:00:00.000Z&#34;,&#34;1976-05-01T00:00:00.000Z&#34;,&#34;1976-06-01T00:00:00.000Z&#34;,&#34;1976-07-01T00:00:00.000Z&#34;,&#34;1976-08-01T00:00:00.000Z&#34;,&#34;1976-09-01T00:00:00.000Z&#34;,&#34;1976-10-01T00:00:00.000Z&#34;,&#34;1976-11-01T00:00:00.000Z&#34;,&#34;1976-12-01T00:00:00.000Z&#34;,&#34;1977-01-01T00:00:00.000Z&#34;,&#34;1977-02-01T00:00:00.000Z&#34;,&#34;1977-03-01T00:00:00.000Z&#34;,&#34;1977-04-01T00:00:00.000Z&#34;,&#34;1977-05-01T00:00:00.000Z&#34;,&#34;1977-06-01T00:00:00.000Z&#34;,&#34;1977-07-01T00:00:00.000Z&#34;,&#34;1977-08-01T00:00:00.000Z&#34;,&#34;1977-09-01T00:00:00.000Z&#34;,&#34;1977-10-01T00:00:00.000Z&#34;,&#34;1977-11-01T00:00:00.000Z&#34;,&#34;1977-12-01T00:00:00.000Z&#34;,&#34;1978-01-01T00:00:00.000Z&#34;,&#34;1978-02-01T00:00:00.000Z&#34;,&#34;1978-03-01T00:00:00.000Z&#34;,&#34;1978-04-01T00:00:00.000Z&#34;,&#34;1978-05-01T00:00:00.000Z&#34;,&#34;1978-06-01T00:00:00.000Z&#34;,&#34;1978-07-01T00:00:00.000Z&#34;,&#34;1978-08-01T00:00:00.000Z&#34;,&#34;1978-09-01T00:00:00.000Z&#34;,&#34;1978-10-01T00:00:00.000Z&#34;,&#34;1978-11-01T00:00:00.000Z&#34;,&#34;1978-12-01T00:00:00.000Z&#34;,&#34;1979-01-01T00:00:00.000Z&#34;,&#34;1979-02-01T00:00:00.000Z&#34;,&#34;1979-03-01T00:00:00.000Z&#34;,&#34;1979-04-01T00:00:00.000Z&#34;,&#34;1979-05-01T00:00:00.000Z&#34;,&#34;1979-06-01T00:00:00.000Z&#34;,&#34;1979-07-01T00:00:00.000Z&#34;,&#34;1979-08-01T00:00:00.000Z&#34;,&#34;1979-09-01T00:00:00.000Z&#34;,&#34;1979-10-01T00:00:00.000Z&#34;,&#34;1979-11-01T00:00:00.000Z&#34;,&#34;1979-12-01T00:00:00.000Z&#34;,&#34;1980-01-01T00:00:00.000Z&#34;,&#34;1980-02-01T00:00:00.000Z&#34;,&#34;1980-03-01T00:00:00.000Z&#34;,&#34;1980-04-01T00:00:00.000Z&#34;,&#34;1980-05-01T00:00:00.000Z&#34;,&#34;1980-06-01T00:00:00.000Z&#34;,&#34;1980-07-01T00:00:00.000Z&#34;,&#34;1980-08-01T00:00:00.000Z&#34;,&#34;1980-09-01T00:00:00.000Z&#34;,&#34;1980-10-01T00:00:00.000Z&#34;,&#34;1980-11-01T00:00:00.000Z&#34;,&#34;1980-12-01T00:00:00.000Z&#34;,&#34;1981-01-01T00:00:00.000Z&#34;,&#34;1981-02-01T00:00:00.000Z&#34;,&#34;1981-03-01T00:00:00.000Z&#34;,&#34;1981-04-01T00:00:00.000Z&#34;,&#34;1981-05-01T00:00:00.000Z&#34;,&#34;1981-06-01T00:00:00.000Z&#34;,&#34;1981-07-01T00:00:00.000Z&#34;,&#34;1981-08-01T00:00:00.000Z&#34;,&#34;1981-09-01T00:00:00.000Z&#34;,&#34;1981-10-01T00:00:00.000Z&#34;,&#34;1981-11-01T00:00:00.000Z&#34;,&#34;1981-12-01T00:00:00.000Z&#34;,&#34;1982-01-01T00:00:00.000Z&#34;,&#34;1982-02-01T00:00:00.000Z&#34;,&#34;1982-03-01T00:00:00.000Z&#34;,&#34;1982-04-01T00:00:00.000Z&#34;,&#34;1982-05-01T00:00:00.000Z&#34;,&#34;1982-06-01T00:00:00.000Z&#34;,&#34;1982-07-01T00:00:00.000Z&#34;,&#34;1982-08-01T00:00:00.000Z&#34;,&#34;1982-09-01T00:00:00.000Z&#34;,&#34;1982-10-01T00:00:00.000Z&#34;,&#34;1982-11-01T00:00:00.000Z&#34;,&#34;1982-12-01T00:00:00.000Z&#34;,&#34;1983-01-01T00:00:00.000Z&#34;,&#34;1983-02-01T00:00:00.000Z&#34;,&#34;1983-03-01T00:00:00.000Z&#34;,&#34;1983-04-01T00:00:00.000Z&#34;,&#34;1983-05-01T00:00:00.000Z&#34;,&#34;1983-06-01T00:00:00.000Z&#34;,&#34;1983-07-01T00:00:00.000Z&#34;,&#34;1983-08-01T00:00:00.000Z&#34;,&#34;1983-09-01T00:00:00.000Z&#34;,&#34;1983-10-01T00:00:00.000Z&#34;,&#34;1983-11-01T00:00:00.000Z&#34;,&#34;1983-12-01T00:00:00.000Z&#34;,&#34;1984-01-01T00:00:00.000Z&#34;,&#34;1984-02-01T00:00:00.000Z&#34;,&#34;1984-03-01T00:00:00.000Z&#34;,&#34;1984-04-01T00:00:00.000Z&#34;,&#34;1984-05-01T00:00:00.000Z&#34;,&#34;1984-06-01T00:00:00.000Z&#34;,&#34;1984-07-01T00:00:00.000Z&#34;,&#34;1984-08-01T00:00:00.000Z&#34;,&#34;1984-09-01T00:00:00.000Z&#34;,&#34;1984-10-01T00:00:00.000Z&#34;,&#34;1984-11-01T00:00:00.000Z&#34;,&#34;1984-12-01T00:00:00.000Z&#34;,&#34;1985-01-01T00:00:00.000Z&#34;,&#34;1985-02-01T00:00:00.000Z&#34;,&#34;1985-03-01T00:00:00.000Z&#34;,&#34;1985-04-01T00:00:00.000Z&#34;,&#34;1985-05-01T00:00:00.000Z&#34;,&#34;1985-06-01T00:00:00.000Z&#34;,&#34;1985-07-01T00:00:00.000Z&#34;,&#34;1985-08-01T00:00:00.000Z&#34;,&#34;1985-09-01T00:00:00.000Z&#34;,&#34;1985-10-01T00:00:00.000Z&#34;,&#34;1985-11-01T00:00:00.000Z&#34;,&#34;1985-12-01T00:00:00.000Z&#34;,&#34;1986-01-01T00:00:00.000Z&#34;,&#34;1986-02-01T00:00:00.000Z&#34;,&#34;1986-03-01T00:00:00.000Z&#34;,&#34;1986-04-01T00:00:00.000Z&#34;,&#34;1986-05-01T00:00:00.000Z&#34;,&#34;1986-06-01T00:00:00.000Z&#34;,&#34;1986-07-01T00:00:00.000Z&#34;,&#34;1986-08-01T00:00:00.000Z&#34;,&#34;1986-09-01T00:00:00.000Z&#34;,&#34;1986-10-01T00:00:00.000Z&#34;,&#34;1986-11-01T00:00:00.000Z&#34;,&#34;1986-12-01T00:00:00.000Z&#34;,&#34;1987-01-01T00:00:00.000Z&#34;,&#34;1987-02-01T00:00:00.000Z&#34;,&#34;1987-03-01T00:00:00.000Z&#34;,&#34;1987-04-01T00:00:00.000Z&#34;,&#34;1987-05-01T00:00:00.000Z&#34;,&#34;1987-06-01T00:00:00.000Z&#34;,&#34;1987-07-01T00:00:00.000Z&#34;,&#34;1987-08-01T00:00:00.000Z&#34;,&#34;1987-09-01T00:00:00.000Z&#34;,&#34;1987-10-01T00:00:00.000Z&#34;,&#34;1987-11-01T00:00:00.000Z&#34;,&#34;1987-12-01T00:00:00.000Z&#34;,&#34;1988-01-01T00:00:00.000Z&#34;,&#34;1988-02-01T00:00:00.000Z&#34;,&#34;1988-03-01T00:00:00.000Z&#34;,&#34;1988-04-01T00:00:00.000Z&#34;,&#34;1988-05-01T00:00:00.000Z&#34;,&#34;1988-06-01T00:00:00.000Z&#34;,&#34;1988-07-01T00:00:00.000Z&#34;,&#34;1988-08-01T00:00:00.000Z&#34;,&#34;1988-09-01T00:00:00.000Z&#34;,&#34;1988-10-01T00:00:00.000Z&#34;,&#34;1988-11-01T00:00:00.000Z&#34;,&#34;1988-12-01T00:00:00.000Z&#34;,&#34;1989-01-01T00:00:00.000Z&#34;,&#34;1989-02-01T00:00:00.000Z&#34;,&#34;1989-03-01T00:00:00.000Z&#34;,&#34;1989-04-01T00:00:00.000Z&#34;,&#34;1989-05-01T00:00:00.000Z&#34;,&#34;1989-06-01T00:00:00.000Z&#34;,&#34;1989-07-01T00:00:00.000Z&#34;,&#34;1989-08-01T00:00:00.000Z&#34;,&#34;1989-09-01T00:00:00.000Z&#34;,&#34;1989-10-01T00:00:00.000Z&#34;,&#34;1989-11-01T00:00:00.000Z&#34;,&#34;1989-12-01T00:00:00.000Z&#34;,&#34;1990-01-01T00:00:00.000Z&#34;,&#34;1990-02-01T00:00:00.000Z&#34;,&#34;1990-03-01T00:00:00.000Z&#34;,&#34;1990-04-01T00:00:00.000Z&#34;,&#34;1990-05-01T00:00:00.000Z&#34;,&#34;1990-06-01T00:00:00.000Z&#34;,&#34;1990-07-01T00:00:00.000Z&#34;,&#34;1990-08-01T00:00:00.000Z&#34;,&#34;1990-09-01T00:00:00.000Z&#34;,&#34;1990-10-01T00:00:00.000Z&#34;,&#34;1990-11-01T00:00:00.000Z&#34;,&#34;1990-12-01T00:00:00.000Z&#34;,&#34;1991-01-01T00:00:00.000Z&#34;,&#34;1991-02-01T00:00:00.000Z&#34;,&#34;1991-03-01T00:00:00.000Z&#34;,&#34;1991-04-01T00:00:00.000Z&#34;,&#34;1991-05-01T00:00:00.000Z&#34;,&#34;1991-06-01T00:00:00.000Z&#34;,&#34;1991-07-01T00:00:00.000Z&#34;,&#34;1991-08-01T00:00:00.000Z&#34;,&#34;1991-09-01T00:00:00.000Z&#34;,&#34;2013-03-31T23:00:00.000Z&#34;,&#34;2013-04-30T23:00:00.000Z&#34;,&#34;2013-05-31T23:00:00.000Z&#34;,&#34;2013-06-30T23:00:00.000Z&#34;,&#34;2013-07-31T23:00:00.000Z&#34;,&#34;2013-08-31T23:00:00.000Z&#34;,&#34;2013-09-30T23:00:00.000Z&#34;,&#34;2013-10-31T23:00:00.000Z&#34;,&#34;2013-11-30T23:00:00.000Z&#34;,&#34;2013-12-31T23:00:00.000Z&#34;,&#34;2014-01-31T23:00:00.000Z&#34;,&#34;2014-02-28T23:00:00.000Z&#34;,&#34;2014-03-31T23:00:00.000Z&#34;,&#34;2014-04-30T23:00:00.000Z&#34;,&#34;2014-05-31T23:00:00.000Z&#34;,&#34;2014-06-30T23:00:00.000Z&#34;,&#34;2014-07-31T23:00:00.000Z&#34;,&#34;2014-08-31T23:00:00.000Z&#34;,&#34;2014-09-30T23:00:00.000Z&#34;,&#34;2014-10-31T23:00:00.000Z&#34;,&#34;2014-11-30T23:00:00.000Z&#34;,&#34;2014-12-31T23:00:00.000Z&#34;,&#34;2015-01-31T23:00:00.000Z&#34;,&#34;2015-02-28T23:00:00.000Z&#34;,&#34;2015-03-31T23:00:00.000Z&#34;,&#34;2015-04-30T23:00:00.000Z&#34;,&#34;2015-05-31T17:00:00.000Z&#34;,&#34;2015-06-30T23:00:00.000Z&#34;,&#34;2015-07-31T23:00:00.000Z&#34;,&#34;2015-08-31T23:00:00.000Z&#34;,&#34;2015-09-30T23:00:00.000Z&#34;,&#34;2015-10-31T23:00:00.000Z&#34;,&#34;2015-11-30T23:00:00.000Z&#34;,&#34;2015-12-31T23:00:00.000Z&#34;,&#34;2016-01-31T23:00:00.000Z&#34;,&#34;2016-02-29T23:00:00.000Z&#34;,&#34;2016-03-31T23:00:00.000Z&#34;,&#34;2016-04-30T23:00:00.000Z&#34;,&#34;2016-05-31T23:00:00.000Z&#34;,&#34;2016-06-30T23:00:00.000Z&#34;,&#34;2016-07-31T23:00:00.000Z&#34;,&#34;2016-08-31T23:00:00.000Z&#34;,&#34;2016-09-30T23:00:00.000Z&#34;,&#34;2016-10-31T23:00:00.000Z&#34;,&#34;2016-11-30T23:00:00.000Z&#34;,&#34;2016-12-31T23:00:00.000Z&#34;,&#34;2017-01-31T23:00:00.000Z&#34;,&#34;2017-02-28T23:00:00.000Z&#34;,&#34;2017-03-31T23:00:00.000Z&#34;,&#34;2017-04-30T23:00:00.000Z&#34;,&#34;2017-05-31T23:00:00.000Z&#34;,&#34;2017-06-30T23:00:00.000Z&#34;,&#34;2017-07-31T23:00:00.000Z&#34;],[null,2.3,42.9,202.2,974.1,520.7,994.4,546.9,262.4,184.9,67.3,57.9,85.9,null,136.7,426.5,390.7,42.4,572.8,747.3,418.3,152.7,55.9,62.2,30.7,null,204.5,186.7,314.2,243.6,984.2,549.4,174.2,152.4,66.5,26.2,35.3,47,133.1,221.5,532.1,460.2,453.6,484.1,515.4,169.4,112.5,99.8,62.2,31.5,56.6,366.5,236,294.9,271.3,611.4,344.9,211.3,367.5,67.1,25.9,33.3,66.5,691.6,87.4,835.9,900.4,216.9,382.3,159,279.9,194.6,225.6,22.1,36.6,541,531.4,1152.7,391.7,311.1,702.3,254,299.5,22.1,32,55.4,249.7,107.2,354.3,199.6,361.4,877.8,424.4,187.2,252.5,49,55.6,16.4,70.4,830.8,609.1,720,373,889.3,100.2,118.5,258.5,51.7,85.7,70.7,91,368.5,907.5,604.5,1015,832,61.5,269.5,128.7,149.5,34,391.5,46,297,39,313,777.5,936.5,275.5,366.5,220,237,15,34.5,156.5,246.5,404,640,735,569,315,204.5,18,110,58,316,54,260,483,792,765,474,728,159.5,94.2,5.1,172.5,271.5,83.5,226.5,838,243.5,197,603,122,214,169,14,98.5,67,228,889.5,874.5,118,145,450,347,138.5,17,117.5,110.5,66,345,25.5,470.5,731,97,200,229,137.5,28.5,157,144,61.5,77,129,410,489.5,526,842,146,180,0,107,86,96.5,244.5,287,126,1320.6,266.5,1098.6,274.5,452.5,193,57.5,71.5,21.5,162,38,258.5,263.5,680.5,754.5,266.5,81,212,174,41,366,100,79.5,305,450,330.5,473.5,244,220,213.5,57.5,171,162,316,351,465,184,178,636.5,262,135,137,262,47.5,80,436.5,236.5,238,448,472,414.5,277,77,101.5,110,147,38,98,451.5,265.5,804.5,356.5,225,346.5,316,232,25,183.5,125,15,600,190.5,460.5,625,432.5,131.9,329,48.2,156.5,191,100,67.5,240.3,95.5,352.7,271.5,394.3,470,261.5,44.5,29.7,100,60.5,25.7,61,609,651.2,452.5,625.4,277.1,108.1,126.7,151,106.5,50.4,114.6,160.3,217.3,595.5,320.5,371.4,130.5,173.9,51.3,106.5,148,107.2,56.8,439.3,277.2,340.8,216.4,217.6,285.3,109.7,41.4,193.7,51.3,6.3,151.2,78.5,248.3,80,728.3,214.6,309.3,173.1,127.4,245.7,50.6,49.8,48.2,5.5,446.1,724.7,329,903.5,135.5,281,170.5,95.7,148,91.5,58.2,34.5,510.4,447.3,550.6,460.5,115.6,274.8,125,22.4,27.8,34.5,127.6,207.8,598.4,358.6,775.6,255.6,270,246.8,612.8,448.5,92.4,78.3,135.6,525,400,915.9,803.9,945,285.6,148.4,44,189.5,242.4,60.8,50.8,295.8,338.5,92,178.3,917.2,397.4,315.7,174.5,273.4,80.6,89.2,132.1,117.5,290.8,917.6,254,356.5,180.1,447.7,128.4,16.3,151.6,113.5,27.9,365.4,487.9,450,98.2,477.3,164.9,181.5,262,248.4,337.4,1.4,180.8,206.5,68,327.9,607,689.3,490.8,89.1,240,96.1,175.4,33.7,72,302.8,259.8,235.5,430.6,298.6,239.8,342.1,160.8,225,52.1,201,138,72,968,934,525.9,154.8,648.2,101,81.9,76.8,55.2,60,160.5,178.9,816,80,725.7,318.4,419.9,340.6,76,368.5,201.5,210.8,405.3,224.9,258.3,625.5,460,492.7,254.2,119.6,172.5,110,113.5,110,138.7,388,271,767,449,869,274.5,69.5,98.5,62,204.4,76.4,116,194.4,509.6,459,660.9,445.1,474.3,120,107.3,226,16.8,21,67.5,364.7,273.2,442,490.5,560,309,230,81.7,130.2,6.9,105.6,291.5,329.5,390.9,387.5,481.4,399.2,832.4,248,174,49.1,63.7,211.4,42,861.4,169.2,362.5,919.5,560.5,178.5,58.6,142.6,77.9,96.5,45.7,69.6,156.8,651.2,805,934.3,62.3,395.4,111.51,371.094,209.54,483.884,341.884,849.112,344.936,184.908,421.638,23.368,133.348,35.56,164.844,139.954,363.988,543.066,297.692,400.04,133.604,51.816,225.554,52.58,72.634,38.604,11.938,44.196,80.01,204.722,383.552,250.45,147.068,39.116,105.41,71.374,62.23,38.098,172.468,201.166,78.49,365.514,488.978,183.908,177.298,63.5,22.86,66.798,85.596,8.89,74.422,105.152,68.584,536.45,181.868]]},&#34;evals&#34;:[&#34;attrs.interactionModel&#34;],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Note that this raingauge was not operational from 1991 to 2013, crucially missing some of the low stream flows in the 1990s and the lowest in 2003.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;streamflow-rainfall&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Streamflow ~ Rainfall&lt;/h2&gt;
&lt;hr /&gt;
&lt;p&gt;There have been various calls for some sort of indication as to how streamflow responds to rainfall. We all want to know how much it needs to rain to fill the dams. While we don’t have a fully coupled atmosphere-hydrological model on hand, and we’re still reading up on the most appropriate time-series modelling approach (especially considering the data gaps…), here’re some quick and dirty indicators based on the periods of overlapping streamflow and rainfall data (1961 - 1991, 2013 - 2016).&lt;/p&gt;
&lt;p&gt;Firstly, cumulative monthly streamflow as a function of monthly rainfall:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-Langrivier_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;While it looks messy, one clear pattern is that a rainfall event in a winter month typically results in greater streamflow than a similar sized event in a summer month. This is especially evident if you compare large rainfall events in late summer/autumn (March, April, May) with those in winter (June, July, August). This is not surprising and likely a result of accumulated soil moisture (or lack thereof) throughout the season, while lower evapotranspiration in winter may also be coming into play.&lt;/p&gt;
&lt;p&gt;What does this look like if we aggregate months by season (following the Summer = October to March, Winter = April - September approach from above).&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-Langrivier_files/figure-html/unnamed-chunk-13-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;A clear role for accumulated soil moisture throughout the season. Note that the lowest blue point was the winter of 2015. Interestingly the winter of 2016 had the next lowest rainfall, but higher streamflow than a few winters with higher rainfall. This could just be spatial variability in rainfall in the catchment, or the censoring created by our summer/winter divide. Ideally we’d look at different accumulation lags - 30, 60, 90 days etc, but we’ll need to do some reading about the best way to do this. It seems like a good job for &lt;a href=&#34;https://en.wikipedia.org/wiki/Wavelet&#34;&gt;&lt;strong&gt;Wavelet analysis&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We’ll need to think a bit more about all this, and especially how to look at evapotranspiration for inclusion in later updates. Feel free to post comments/suggestions below!&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;If you spot any issues, have any queries, or would like to use or cite these data please contact the &lt;a href=&#34;http://www.saeon-fynbos.org&#34;&gt;&lt;strong&gt;SAEON Fynbos Node&lt;/strong&gt;&lt;/a&gt; or jasper or abri, both &lt;span class=&#34;citation&#34;&gt;@saeon.ac.za&lt;/span&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;hr /&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>A Primer for Handling Spatial Data in R (Updated)</title>
      <link>/post/2017-04-01-PrimerSpatialData/</link>
      <pubDate>Thu, 29 Jun 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/2017-04-01-PrimerSpatialData/</guid>
      <description>&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#installing-r-and-rstudio&#34;&gt;Installing R (and RStudio)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#cran-task-views-see-link-from-httpscran.r-project.org&#34;&gt;CRAN Task Views!!! (see link from &lt;a href=&#34;https://cran.r-project.org/&#34; class=&#34;uri&#34;&gt;https://cran.r-project.org/&lt;/a&gt;)&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#topics-covered-by-the-spatial-task-view-which-focuses-on-analysis-of-spatial-data&#34;&gt;Topics covered by the &lt;em&gt;Spatial&lt;/em&gt; Task View, which focuses on “Analysis of Spatial Data”:&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#useful-diy-resources&#34;&gt;Useful DIY resources&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#a-practical-example&#34;&gt;A Practical Example!!!&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#a-quick-note-on-the-structure-of-this-tutorial&#34;&gt;A quick note on the structure of this tutorial&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#data-description&#34;&gt;Data Description&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#housekeeping&#34;&gt;Housekeeping&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#getting-and-cleaning-the-data-but-first-and-foremost-projection&#34;&gt;Getting and cleaning the data, but first and foremost, &lt;em&gt;projection!!!&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#lets-start-with-point-data-mostly-functions-from-libraryrgdal-and-librarysp&#34;&gt;Let’s start with point data (mostly functions from library(rgdal) and library(sp))&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#raster-data-mostly-functions-from-libraryraster&#34;&gt;Raster data (mostly functions from library(raster))&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#polygons&#34;&gt;Polygons!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#going-parallel&#34;&gt;Going parallel!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#animation&#34;&gt;Animation!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#some-other-data-visualization-and-analysis&#34;&gt;Some other data visualization and analysis&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#but-what-about-our-poor-cedars&#34;&gt;But what about our poor cedars?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#options-for-writing-out-spatial-data&#34;&gt;Options for writing out spatial data&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;Points, lines, polygons and rasters - R can handle them all. My aim for this tutorial is to give you the basics required to teach yourself spatial data analysis in R.&lt;/p&gt;
&lt;!--more--&gt;
&lt;p&gt;I’ll start by briefly covering installing R, CRAN Task Views and how to install them (using the ‘Spatial’ task view as an example), followed by some pointers for useful DIY resources for handling and analyzing spatial data, and then work through a practical example exploring fire history layers (polygon), topographic (raster) and locality (point) data using the libraries ‘rgdal’, ‘raster’ and ‘sp’ and a few others. The example will cover setting and changing projections and extents, subseting polygons, raster calculations, rasterizing polygons and extracting data with a few neat tricks and visualisations along the way.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;div id=&#34;installing-r-and-rstudio&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Installing R (and RStudio)&lt;/h3&gt;
&lt;p&gt;You can download R for Windows, Mac or Linux from &lt;a href=&#34;https://cran.r-project.org/&#34;&gt;&lt;strong&gt;The Comprehensive R Archive Network (CRAN) at https://cran.r-project.org/&lt;/strong&gt;&lt;/a&gt; and install.&lt;/p&gt;
&lt;p&gt;Base R can be quite clunky to deal with, so there is a range of additional software packages designed to help you manage your R code, plots, projects etc. One of the better ones (i.e. the one that I use and I’m clearly not bias) is &lt;a href=&#34;https://www.rstudio.com/products/RStudio/&#34;&gt;&lt;strong&gt;RStudio (www.rstudio.com)&lt;/strong&gt;&lt;/a&gt;. You want to download the Open Source version of RStudio Desktop. When you open RStudio after installing you’ll see that it has opened R in the “Console” window.&lt;/p&gt;
&lt;p&gt;Note that the base version of R is as small as possible, trimmed down to only the essential functions etc. More advanced and user specific functions are available as “Contributed Extension Packages” or “libraries”. You can access the list of packages from &lt;a href=&#34;https://cran.r-project.org/&#34; class=&#34;uri&#34;&gt;https://cran.r-project.org/&lt;/a&gt;. At the time of writing there were almost 11 000 packages and growing!!! This can be quite bewildering if you’re not sure what you need, but fortunately there are…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;cran-task-views-see-link-from-httpscran.r-project.org&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;CRAN Task Views!!! (see link from &lt;a href=&#34;https://cran.r-project.org/&#34; class=&#34;uri&#34;&gt;https://cran.r-project.org/&lt;/a&gt;)&lt;/h2&gt;
&lt;p&gt;Some great fellas have taken the time to sift through all the R libraries and make some sense of them for different focal topics and created “Task Views” &lt;br&gt;&lt;/p&gt;
&lt;p&gt;Each Task View has a landing page with an overview highlighting what you can do with the different packages and their respective strengths, weaknesses etc., e.g. &lt;br&gt; &lt;br&gt;&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/CRAN_spatial.jpg&#34; /&gt;

&lt;/div&gt;
&lt;div id=&#34;topics-covered-by-the-spatial-task-view-which-focuses-on-analysis-of-spatial-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Topics covered by the &lt;em&gt;Spatial&lt;/em&gt; Task View, which focuses on “Analysis of Spatial Data”:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Classes for spatial data&lt;/li&gt;
&lt;li&gt;Handling spatial data&lt;/li&gt;
&lt;li&gt;Reading and writing spatial data&lt;/li&gt;
&lt;li&gt;Reading and writing spatial data - other packages&lt;/li&gt;
&lt;li&gt;Visualisation&lt;/li&gt;
&lt;li&gt;Point pattern analysis&lt;/li&gt;
&lt;li&gt;Geostatistics&lt;/li&gt;
&lt;li&gt;Disease mapping and areal data analysis&lt;/li&gt;
&lt;li&gt;Spatial regression&lt;/li&gt;
&lt;li&gt;Ecological analysis&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Task Views also allow easy download and installation of all packages in a Task View using library(ctv) - see highlighted code below. But beware! It can take a while to download and install if it is a big Task View and the the Spatial one is BIG!!! You don’t need it for this tutorial, so don’t bother downloading it for now.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/CRAN_taskviews.jpg&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;useful-diy-resources&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Useful DIY resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;The Analysis of Spatial Data Task View!&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.neondataskills.org&#34; class=&#34;uri&#34;&gt;http://www.neondataskills.org&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.nceas.ucsb.edu/scicomp/solutions&#34; class=&#34;uri&#34;&gt;https://www.nceas.ucsb.edu/scicomp/solutions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://pakillo.github.io/R-GIS-tutorial/&#34; class=&#34;uri&#34;&gt;http://pakillo.github.io/R-GIS-tutorial/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://robinlovelace.net/&#34; class=&#34;uri&#34;&gt;http://robinlovelace.net/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://spatial.ly/&#34; class=&#34;uri&#34;&gt;http://spatial.ly/&lt;/a&gt; - For some visual R inspiration!&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.googleityoumoron.com&#34; class=&#34;uri&#34;&gt;http://www.googleityoumoron.com&lt;/a&gt; - There are plenty of resources!!!&lt;/li&gt;
&lt;li&gt;Applied Spatial Data Analysis with R - R. Bivand 2013&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A very good book!&lt;br /&gt;
&lt;img src=&#34;/img/Bivand.jpg&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;a-practical-example&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;A Practical Example!!!&lt;/h2&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;div id=&#34;a-quick-note-on-the-structure-of-this-tutorial&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;A quick note on the structure of this tutorial&lt;/h3&gt;
&lt;p&gt;From here this tutorial will include embedded chunks of R code and the output that R returns in little grey boxes. The R code I call starts at the beginning of the line, while each line of R’s output starts with “##”, e.g.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;1+1&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Note that I occassionally include comments in the R chunks. Comments are preceded by “#”. Hopefully this will all make sense as you get into the tutorial…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;data-description&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Data Description&lt;/h3&gt;
&lt;p&gt;For this exercise we’ll play with fine-scale locality (point) data for the critically endangered Clanwilliam cedar (&lt;em&gt;Widdringtonia cedarbergensis&lt;/em&gt;) mapped by my father for the new Cederberg hiking map (check out &lt;strong&gt;&lt;a href=&#34;http://www.slingsbymaps.com/&#34; class=&#34;uri&#34;&gt;http://www.slingsbymaps.com/&lt;/a&gt;&lt;/strong&gt;; data for 1000 trees downloadable at &lt;strong&gt;&lt;a href=&#34;https://dl.dropboxusercontent.com/u/47937308/Cedars.kml&#34; class=&#34;uri&#34;&gt;https://dl.dropboxusercontent.com/u/47937308/Cedars.kml&lt;/a&gt;&lt;/strong&gt;), a 90m (raster) digital elevation model (DEM) (&lt;strong&gt;&lt;a href=&#34;https://dl.dropboxusercontent.com/u/47937308/SRTM.zip&#34; class=&#34;uri&#34;&gt;https://dl.dropboxusercontent.com/u/47937308/SRTM.zip&lt;/a&gt;&lt;/strong&gt;) that I will also show you how to download directly with R, and two “polygon” data sets consisting of mapped burn scars for CapeNature reserves (available at &lt;strong&gt;&lt;a href=&#34;http://bgis.sanbi.org/Projects/Detail/168&#34; class=&#34;uri&#34;&gt;http://bgis.sanbi.org/Projects/Detail/168&lt;/a&gt;&lt;/strong&gt;) and the National Vegetation Map (available at &lt;strong&gt;&lt;a href=&#34;http://bgis.sanbi.org/SpatialDataset/Detail/18&#34; class=&#34;uri&#34;&gt;http://bgis.sanbi.org/SpatialDataset/Detail/18&lt;/a&gt;&lt;/strong&gt;). You will need to download the cedar dataset into your chosen local data directory (see “datwd” below) and download the other data into your chosen GIS data directory (see “giswd” below) and unzip them. &lt;em&gt;datwd&lt;/em&gt; and &lt;em&gt;giswd&lt;/em&gt; can be the same for the purposes of this tutorial. You can download the R code (with the RMarkdown content commented out) at &lt;strong&gt;&lt;a href=&#34;https://dl.dropboxusercontent.com/u/47937308/PrimerSpatialData.R&#34; class=&#34;uri&#34;&gt;https://dl.dropboxusercontent.com/u/47937308/PrimerSpatialData.R&lt;/a&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;housekeeping&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Housekeeping&lt;/h3&gt;
&lt;p&gt;Let’s start by setting our working directories. I usually work from a “Project” in RStudio linked to a GIT repository (see &lt;a href=&#34;https://git-scm.com/&#34; class=&#34;uri&#34;&gt;https://git-scm.com/&lt;/a&gt; and &lt;a href=&#34;https://github.com/&#34; class=&#34;uri&#34;&gt;https://github.com/&lt;/a&gt;) for version control and easy code sharing/collaboration. I’m not going to go there with this tutorial, but it is worth exploring if you intend to do big projects in R. R projects set the working directory to a good place automatically. Alternatively you can use the setwd() function. If I’m not in a repo or I am working with large data sets that I don’t want to replicate in every GIT repo on my hard drive I usually set separate “data”, “GIS data” (i.e. biggish data) and “results” working directories by making each path an object and inserting as appropriate for different read and write functions using paste() or paste0(). These would look something like:&lt;/p&gt;
&lt;p&gt;datwd = “/Users/jasper/Dropbox/SAEON/Training/SpatialDataPrimer/Example/Data/”&lt;br /&gt;
giswd = “/Users/jasper/Documents/GIS/”&lt;br /&gt;
reswd = “/Users/jasper/Dropbox/SAEON/Training/SpatialDataPrimer/Example/Results/”&lt;/p&gt;
&lt;p&gt;But! This is not useful if I’m sharing the project or work on multiple machines. In this case it’s better to identify the machine/user using Sys.getenv() and wrap the code in an if() statement for each user like so:&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;if (Sys.getenv(&amp;quot;USER&amp;quot;)==&amp;#39;jasper&amp;#39;) {datwd=&amp;quot;/Users/jasper/Dropbox/SAEON/Training/SpatialDataPrimer/Example/Data/&amp;quot;
giswd=&amp;quot;/Users/jasper/Documents/GIS/&amp;quot;
reswd=&amp;quot;/Users/jasper/Dropbox/SAEON/Training/SpatialDataPrimer/Example/Results/&amp;quot;}
if (Sys.getenv(&amp;quot;USER&amp;quot;)==&amp;#39;MACUseR&amp;#39;) {datwd=&amp;quot;&amp;quot;; giswd=&amp;quot;&amp;quot;; reswd=&amp;quot;&amp;quot;} #For Mac/Linux users
if (Sys.getenv(&amp;quot;USERNAME&amp;quot;)==&amp;#39;WINDOZEUseR&amp;#39;) {datwd=&amp;quot;&amp;quot;; giswd=&amp;quot;&amp;quot;; reswd=&amp;quot;&amp;quot;} #For Windows&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;This way a new project member can add a new line of code without deleting anything, and it only sets the working directories (and any other settings you want) for the appropriate user - i.e. the if() statement ignores settings for all other users. NOTE!!! the “USER/USERNAME” difference for Mac vs Windows (I’m pretty sure Linux is the same as Mac, but try Sys.getenv() and see what you get).&lt;/p&gt;
&lt;p&gt;Set your username and working directories here. You can just set &lt;em&gt;datwd&lt;/em&gt;, &lt;em&gt;giswd&lt;/em&gt; and &lt;em&gt;reswd&lt;/em&gt; to the same file path for the purposes of this tutorial. Don’t forget to add the “/” at the end!&lt;/p&gt;
&lt;p&gt;Note that we use single forwardslashes “/”. Windows likes to use single backslashes, but R (and just about every other computer programme in the world) doesn’t like this. You can use double backslashes on Windows if you must.&lt;/p&gt;
&lt;p&gt;Now we can call the extention libraries we’ll need for this session. You should install these before running this code using install.packages() while connected to the internet - e.g. install.packages(“raster”). Note that one occasionally encounters issues installing doMC, but you can usually install it from their development page using install.packages(“doMC”, repos=“&lt;a href=&#34;http://R-Forge.R-project.org&#34; class=&#34;uri&#34;&gt;http://R-Forge.R-project.org&lt;/a&gt;”). If neither of these work for you don’t worry, it is not an essential component of the tutorial.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(raster, quietly = T) # To handle rasters
library(rasterVis, quietly = T) # For fancy raster visualisations
library(rgdal, quietly = T) # To communicate with GDAL and handle shape files&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## rgdal: version: 1.2-7, (SVN revision 660)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 2.1.3, released 2017/20/01
##  Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/3.4/Resources/library/rgdal/gdal
##  Loaded PROJ.4 runtime: Rel. 4.9.3, 15 August 2016, [PJ_VERSION: 493]
##  Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.4/Resources/library/rgdal/proj
##  Linking to sp version: 1.2-4&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(sp, quietly = T) # To handle shapefiles
library(doMC, quietly = T) # To run code in parallel
library(animation, quietly = T) # To make fancy animations...
library(dismo, quietly = T) # For fancy tricks in Google Earth
library(googleVis, quietly = T) # For even more fancy tricks in Google Earth&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Creating a generic function for &amp;#39;toJSON&amp;#39; from package &amp;#39;jsonlite&amp;#39; in package &amp;#39;googleVis&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Welcome to googleVis version 0.6.2
## 
## Please read Google&amp;#39;s Terms of Use
## before you start using the package:
## https://developers.google.com/terms/
## 
## Note, the plot method of googleVis will by default use
## the standard browser to display its output.
## 
## See the googleVis package vignettes for more details,
## or visit http://github.com/mages/googleVis.
## 
## To suppress this message use:
## suppressPackageStartupMessages(library(googleVis))&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;getting-and-cleaning-the-data-but-first-and-foremost-projection&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Getting and cleaning the data, but first and foremost, &lt;em&gt;projection!!!&lt;/em&gt;&lt;/h3&gt;
&lt;p&gt;R typically uses the PROJ.4 conventions for cartographic projections (or coordinate reference systems - CRS). Check out &lt;a href=&#34;http://proj4js.org&#34; class=&#34;uri&#34;&gt;http://proj4js.org&lt;/a&gt; or &lt;a href=&#34;http://spatialreference.org/&#34; class=&#34;uri&#34;&gt;http://spatialreference.org/&lt;/a&gt; or google for the “proj4string” for various coordinate reference systems.&lt;/p&gt;
&lt;p&gt;I like to set a standardized CRS as an object that I use throughout my workflow.&lt;/p&gt;
&lt;p&gt;NOTE!!! Many R functions will allow you to play with objects with different CRS resulting in GARBAGE! Others will reproject one or other of the objects for you, but this can be slow and it’s not worth taking the chance. I recommend checking and setting your CRS for all objects. You can check CRS with proj4string(), check that multiple objects have the same CRS using identicalCRS(), and reproject objects of class “Spatial” with spTransform() and objects of class “Raster” with projectRaster().&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#Set a standardized projection
stdCRS &amp;lt;- &amp;quot;+proj=utm +zone=34 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs&amp;quot; 
#This is &amp;quot;EPSG:32734&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;I like to use Universal Transverse Mercator (UTM) for studies with smallish extents (~&amp;lt;100km a side) because the unit is metres and is easily interpretable. The UTM zone we’re in for this example is 34 South &lt;a href=&#34;http://whatutmzoneamiin.blogspot.co.za/p/map.html&#34; class=&#34;uri&#34;&gt;http://whatutmzoneamiin.blogspot.co.za/p/map.html&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;lets-start-with-point-data-mostly-functions-from-libraryrgdal-and-librarysp&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Let’s start with point data (mostly functions from library(rgdal) and library(sp))&lt;/h3&gt;
&lt;p&gt;Here we use readOGR() from library(rgdal) to read the points in as a shapefile. Note that readOGR() is incredibly versatile and can be used to read in all kinds of shapefiles with different features (point, line, polygon) from different software. Unfortunately some PCs struggle to automatically install the GDAL &lt;a href=&#34;http://www.gdal.org/&#34; class=&#34;uri&#34;&gt;http://www.gdal.org/&lt;/a&gt; software that is called from R, but there are plenty of online fora providing solutions. Sometimes (although this issue may be fixed) there are conflicts between library(sp) and library(rgdal) depending on what order they are called.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rawpts &amp;lt;- readOGR(dsn=paste0(datwd, &amp;quot;Cedars.kml&amp;quot;), layer=&amp;quot;Cedars.kml&amp;quot;) # A Google Earth KML file&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## OGR data source with driver: KML 
## Source: &amp;quot;/Users/jasper/Dropbox/SAEON/Training/SpatialDataPrimer/Example/Data/Cedars.kml&amp;quot;, layer: &amp;quot;Cedars.kml&amp;quot;
## with 1000 features
## It has 2 fields&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;proj4string(rawpts) # Check projection&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pts &amp;lt;- spTransform(rawpts, CRS(stdCRS)) # Do spatial transform to set projection&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Note the strange &lt;em&gt;dsn=/layer=&lt;/em&gt; syntax. This will mess with you at first!!! This syntax is used to allow the function to read in many different file formats (type “ogrDrivers()” into the console to see a list). Different drivers often require different inputs for &lt;em&gt;dsn=&lt;/em&gt; and &lt;em&gt;layer=&lt;/em&gt;. I often have to play around or ask Google before I get it right for a new file…&lt;/p&gt;
&lt;p&gt;Also note the use of the paste0(datwd, “Cedars.kml”) trick I mentioned earlier:&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paste0(datwd, &amp;quot;Cedars.kml&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;/Users/jasper/Dropbox/SAEON/Training/SpatialDataPrimer/Example/Data/Cedars.kml&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Note that the presence and number of /’s are very important… It’s the first thing to check if you get an error!!! IF YOU HAVE ANY ISSUES READING IN DATA AT ANY STAGE THE FIRST THING TO DO IS TO RUN THE “paste0(…)” SECTION OF THE SCRIPT AND MAKE SURE IT MATCHES EXACTLY THE PATH TO YOUR FILE!!!&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Let’s explore our point data a little more and fiddle with different ways of making a “Spatial” object.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;class(pts)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;SpatialPointsDataFrame&amp;quot;
## attr(,&amp;quot;package&amp;quot;)
## [1] &amp;quot;sp&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(coordinates(pts)) # Get the spatial coordinates&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##      coords.x1 coords.x2
## [1,]  318630.2   6418166
## [2,]  329096.9   6411855
## [3,]  324656.3   6423442
## [4,]  324611.6   6427641
## [5,]  324156.0   6421462
## [6,]  320746.9   6429256&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x &amp;lt;- as.data.frame(coordinates(pts)) # Extract the coordinates and make them a regular &amp;quot;data.frame&amp;quot;&amp;quot; object (as if we&amp;#39;d read in a .txt or .csv file)
class(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;data.frame&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;coordinates(x) &amp;lt;- ~ coords.x1 + coords.x2 # Set coordinates for x, making it a &amp;quot;Spatial&amp;quot; object
class(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;SpatialPoints&amp;quot;
## attr(,&amp;quot;package&amp;quot;)
## [1] &amp;quot;sp&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;str(x) # Note the lack of proj4string info&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Formal class &amp;#39;SpatialPoints&amp;#39; [package &amp;quot;sp&amp;quot;] with 3 slots
##   ..@ coords     : num [1:1000, 1:2] 318630 329097 324656 324612 324156 ...
##   .. ..- attr(*, &amp;quot;dimnames&amp;quot;)=List of 2
##   .. .. ..$ : chr [1:1000] &amp;quot;1&amp;quot; &amp;quot;2&amp;quot; &amp;quot;3&amp;quot; &amp;quot;4&amp;quot; ...
##   .. .. ..$ : chr [1:2] &amp;quot;coords.x1&amp;quot; &amp;quot;coords.x2&amp;quot;
##   ..@ bbox       : num [1:2, 1:2] 315518 6410827 333832 6434186
##   .. ..- attr(*, &amp;quot;dimnames&amp;quot;)=List of 2
##   .. .. ..$ : chr [1:2] &amp;quot;coords.x1&amp;quot; &amp;quot;coords.x2&amp;quot;
##   .. .. ..$ : chr [1:2] &amp;quot;min&amp;quot; &amp;quot;max&amp;quot;
##   ..@ proj4string:Formal class &amp;#39;CRS&amp;#39; [package &amp;quot;sp&amp;quot;] with 1 slot
##   .. .. ..@ projargs: chr NA&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;proj4string(x) &amp;lt;- stdCRS # To assign the CRS (IF IT IS KNOWN!!!)
str(x)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Formal class &amp;#39;SpatialPoints&amp;#39; [package &amp;quot;sp&amp;quot;] with 3 slots
##   ..@ coords     : num [1:1000, 1:2] 318630 329097 324656 324612 324156 ...
##   .. ..- attr(*, &amp;quot;dimnames&amp;quot;)=List of 2
##   .. .. ..$ : chr [1:1000] &amp;quot;1&amp;quot; &amp;quot;2&amp;quot; &amp;quot;3&amp;quot; &amp;quot;4&amp;quot; ...
##   .. .. ..$ : chr [1:2] &amp;quot;coords.x1&amp;quot; &amp;quot;coords.x2&amp;quot;
##   ..@ bbox       : num [1:2, 1:2] 315518 6410827 333832 6434186
##   .. ..- attr(*, &amp;quot;dimnames&amp;quot;)=List of 2
##   .. .. ..$ : chr [1:2] &amp;quot;coords.x1&amp;quot; &amp;quot;coords.x2&amp;quot;
##   .. .. ..$ : chr [1:2] &amp;quot;min&amp;quot; &amp;quot;max&amp;quot;
##   ..@ proj4string:Formal class &amp;#39;CRS&amp;#39; [package &amp;quot;sp&amp;quot;] with 1 slot
##   .. .. ..@ projargs: chr &amp;quot;+proj=utm +zone=34 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs +towgs84=0,0,0&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rm(x) # Remove x from R&amp;#39;s memory as we won&amp;#39;t need it again.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Note the “@” symbols revealed when we look at the data structure (str()). Many spatial data objects use “slots” to store various components of the data. The slots can be accessed using “@” like you would “$” to call a variable from a dataframe, but it is RECOMMENDED THAT YOU DON’T DO THIS… The reason being that slots were designed so that the R package developers can change the way slots work to improve efficiency, handle new or different objects etc. If you write code that accesses slots directly it may break next time the libraries are updated. There are functions for accessing all slots (e.g. proj4string(), coordinates(), etc.)&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;raster-data-mostly-functions-from-libraryraster&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Raster data (mostly functions from library(raster))&lt;/h3&gt;
&lt;p&gt;Let’s get a digital elevation model (DEM) from the SRTM90 (Shuttle Radar Topography Mission*) digital elevation database, match projection, and trim to the same extent as “pts”. We can download the data directly with R using the function getData() (type ?getData for details), but this can be slow because it downloads a much bigger area than we need. To save time I’ve downloaded the data before and saved it locally with the “path =” setting, hashed (#) out the download code so R won’t run it, and read the data in from the local source. You will need to run the hashed out code (without the hash) to download the data the first time you run this script.&lt;/p&gt;
&lt;p&gt;*Jarvis A., H.I. Reuter, A. Nelson, E. Guevara, 2008, Hole-filled seamless SRTM data V4, International Centre for Tropical Agriculture (CIAT), available from &lt;a href=&#34;http://srtm.csi.cgiar.org&#34; class=&#34;uri&#34;&gt;http://srtm.csi.cgiar.org&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#dem &amp;lt;- getData(&amp;#39;SRTM&amp;#39;, lon=19, lat=-32.5, path = paste0(giswd, &amp;quot;SRTM/&amp;quot;)) # download data from CGIAR website
dem &amp;lt;- raster(paste0(giswd, &amp;quot;SRTM/srtm_40_19.tif&amp;quot;)) # read in data from local source - NOTE THAT YOU MAY NEED TO UNZIP THE FILE YOU DOWNLOADED!!!
proj4string(dem) # this is not our chosen projection for this tutorial so we need to reproject&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dem &amp;lt;- projectRaster(dem, crs=CRS(stdCRS)) # note that we use a different function for raster data than for shapefiles (points or polygon) - this can take a while...

extent(dem)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : Extent 
## xmin        : -79731.16 
## xmax        : 409252.3 
## ymin        : 6109993 
## ymax        : 6681302&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;extent(pts) # so our DEM has a much larger extent than our cedars of interest and we should crop it&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : Extent 
## xmin        : 315517.9 
## xmax        : 333832.2 
## ymin        : 6410827 
## ymax        : 6434186&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;E &amp;lt;- extent(pts) + c(-900, 900, -900, 900) # The second term adds a 900m buffer
dem &amp;lt;- crop(dem, E) # Crop DEM to the buffered extent&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Lets have a look?&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(dem)
points(pts, pch=20, cex=.1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now that we have the DEM cleaned up for our study let’s use the terrain() function to calculate/extract some topographic information. Note that terrain() is based on the more versatile focal() function, should you want to design your own indices etc. Also see rasterEngine() in library(spatial.tools) which is an equivalent, but with easy parallel processing capability.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;slope &amp;lt;- terrain(dem, &amp;quot;slope&amp;quot;)
aspect &amp;lt;- terrain(dem, &amp;quot;aspect&amp;quot;)
TPI &amp;lt;- terrain(dem, &amp;quot;TPI&amp;quot;) # Topographic Position Index
TRI &amp;lt;- terrain(dem, &amp;quot;TRI&amp;quot;) # Terrain Ruggedness Index
roughness &amp;lt;- terrain(dem, &amp;quot;roughness&amp;quot;)
flowdir &amp;lt;- terrain(dem, &amp;quot;flowdir&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;But “aspect” is circular so small changes in the northern aspects (e.g. 2 to 358 degrees) look like big changes in the data. We can break aspect down into east-westness and north-southness using sin() and cos() - remember your trigonometry?&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;eastwest &amp;lt;- sin(aspect)
northsouth &amp;lt;- cos(aspect)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now dealing with all these different rasters gets a bit cumbersome, but they have the same extent, resolution and grid so we can stack() them into one object. But first, we should make sure the data are named in a sensible way otherwise they can all end out being named “layer”…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;names(eastwest)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;layer&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;names(northsouth) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;layer&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;names(dem)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;srtm_40_19&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;names(eastwest) &amp;lt;- &amp;quot;eastwest&amp;quot; # To rename the data in the raster
names(northsouth) &amp;lt;- &amp;quot;northsouth&amp;quot;
names(dem) &amp;lt;- &amp;quot;dem&amp;quot;
topo &amp;lt;- stack(dem, slope, eastwest, northsouth, TPI, TRI, roughness, flowdir)
topo&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : RasterStack 
## dimensions  : 272, 257, 69904, 8  (nrow, ncol, ncell, nlayers)
## resolution  : 78.3, 92.4  (x, y)
## extent      : 314587.6, 334710.7, 6409924, 6435056  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=34 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs +towgs84=0,0,0 
## names       :         dem,       slope,    eastwest,  northsouth,         tpi,         tri,   roughness,     flowdir 
## min values  : 296.3650828,   0.0006550,  -1.0000000,  -1.0000000, -70.5164504,   0.2751995,   0.8269874,   1.0000000 
## max values  : 1956.993141,    1.122555,    1.000000,    1.000000,   91.157818,  140.499398,  438.959923,  128.000000&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Another way to rename rasters in a stack
# names(topo) &amp;lt;- c(&amp;quot;name1&amp;quot;, &amp;quot;name2&amp;quot;&amp;quot;, etc)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Some other useful “raster” functions are rasterize(), aggregate() and raster calculations. Let’s calculate the tree density by 90m grid cell from the DEM.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dens &amp;lt;- rasterize(pts, dem, field=&amp;quot;Name&amp;quot;, fun=&amp;quot;count&amp;quot;)
plot(dens) # See anything? Probably not, these are 90m pixels in a large landscape...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-13-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(aggregate(dens, fact=3, fun=&amp;quot;sum&amp;quot;))  # Aggregate the 90m cells into larger 210m cells - better?&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-13-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(dens&amp;gt;10, col=&amp;quot;red&amp;quot;)  # Use raster calculations to subset&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-13-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Note that you can add, subtract, multiply and divide rasters allowing you to easily do some quite complicated calculations. Explore calc() for designing and implementing more complicated functions.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;polygons&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Polygons!&lt;/h3&gt;
&lt;p&gt;Perhaps the best place to start is the National Vegetation Map of South Africa, Lesotho and Swaziland. We need to get the data, set the CRS and crop to our area/extent of interest.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;vegmap &amp;lt;- readOGR(dsn=paste0(giswd, &amp;quot;nvm2012beta2_wgs84_Geo&amp;quot;), layer=&amp;quot;nvm2012beta2_wgs84_Geo&amp;quot;) # Get the data&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## OGR data source with driver: ESRI Shapefile 
## Source: &amp;quot;/Users/jasper/Documents/GIS/nvm2012beta2_wgs84_Geo&amp;quot;, layer: &amp;quot;nvm2012beta2_wgs84_Geo&amp;quot;
## with 44822 features
## It has 21 fields&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(vegmap) # Have a look at the first 6 rows of the attribute table &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   OBJECTID_1                      NAME MAPCODE12 MPCDSUBT
## 0          0  Agulhas Limestone Fynbos      FFl1     &amp;lt;NA&amp;gt;
## 1          1  Agulhas Limestone Fynbos      FFl1     &amp;lt;NA&amp;gt;
## 2          2  Cape Seashore Vegetation      AZd3     &amp;lt;NA&amp;gt;
## 3          3  Cape Seashore Vegetation      AZd3     &amp;lt;NA&amp;gt;
## 4          4  Cape Seashore Vegetation      AZd3     &amp;lt;NA&amp;gt;
## 5          5 Overberg Sandstone Fynbos     FFs12     &amp;lt;NA&amp;gt;
##                      BIOREGION             BIOME CHANGE_VER  CHANGE_REF
## 0 South Coast Fynbos Bioregion            Fynbos       VM06 VegMap 2006
## 1 South Coast Fynbos Bioregion            Fynbos       VM06 VegMap 2006
## 2          Seashore Vegetation Azonal Vegetation       VM06 VegMap 2006
## 3          Seashore Vegetation Azonal Vegetation       VM06 VegMap 2006
## 4          Seashore Vegetation Azonal Vegetation       VM06 VegMap 2006
## 5   Southwest Fynbos Bioregion            Fynbos       VM06 VegMap 2006
##   CNSRV_TRGT SHAPE_LENG  SHAPE_AREA BIOMECODE GRPCODE               GROUP
## 0         32   5028.778   661226.69         F     FFl    Limestone Fynbos
## 1         32  25681.966 11720744.76         F     FFl    Limestone Fynbos
## 2         20   5624.948   332448.42        AZ     AZd Seashore Vegetation
## 3         20   2241.355    73488.36        AZ     AZd Seashore Vegetation
## 4         20  17366.045  1229468.26        AZ     AZd Seashore Vegetation
## 5         30   1295.837   120756.02         F     FFs    Sandstone Fynbos
##   BRGNCODE                            LEGEND VTYPSQKM12
## 0      F04   FFl 1  Agulhas Limestone Fynbos   294.4978
## 1      F04   FFl 1  Agulhas Limestone Fynbos   294.4978
## 2      AZd   AZd 3  Cape Seashore Vegetation   243.5824
## 3      AZd   AZd 3  Cape Seashore Vegetation   243.5824
## 4      AZd   AZd 3  Cape Seashore Vegetation   243.5824
## 5      F02 FFs 12  Overberg Sandstone Fynbos  1169.4725
##                         DOCLINK SUBTYPENM    BKSORT POLYSQKM
## 0 Descriptions\\FFl_1_2006.docx      &amp;lt;NA&amp;gt; 01 11 001   0.6612
## 1 Descriptions\\FFl_1_2006.docx      &amp;lt;NA&amp;gt; 01 11 001  11.7207
## 2 Descriptions\\AZd_3_2006.docx      &amp;lt;NA&amp;gt; 10 02 003   0.3324
## 3 Descriptions\\AZd_3_2006.docx      &amp;lt;NA&amp;gt; 10 02 003   0.0735
## 4 Descriptions\\AZd_3_2006.docx      &amp;lt;NA&amp;gt; 10 02 003   1.2295
## 5 Descriptions\\FFs12_2006.docx      &amp;lt;NA&amp;gt; 01 01 012   0.1208&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;extent(vegmap) # Check the extent&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : Extent 
## xmin        : 16.45696 
## xmax        : 32.8914 
## ymin        : -34.8334 
## ymax        : -22.12583&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;proj4string(vegmap) # Check the projection&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;vegmap &amp;lt;- spTransform(vegmap, CRS(stdCRS)) # Reproject - This can take a while...
vegmap &amp;lt;- crop(vegmap, E) # Note that extent (E) was created earlier&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required namespace: rgeos&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Let’s plot what we’ve cropped…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;cols &amp;lt;- rainbow(length(unique(vegmap$NAME))) # Make a set of 8 colours
plot(vegmap, col = cols[as.factor(as.character(vegmap$NAME))]) # Plot the map coloured by veg type
legend(&amp;quot;bottomleft&amp;quot;, legend = levels(as.factor(as.character(vegmap$NAME))), text.col = cols, cex=.6) # Add a legend
points(pts, pch=20, cex=.1) # Add the trees&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-15-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Looks like our cedars are restricted to “Cederberg Sandstone Fynbos”, but we can test that by extracting the veg type for each tree location.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Note that there are a few ways of extracting data from spatial objects. The variants of over() are best for shapefiles
treeveg &amp;lt;- over(pts, vegmap)
treeveg2 &amp;lt;- pts %over% vegmap
identical(treeveg, treeveg2) #Same result!&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] TRUE&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(treeveg) # We&amp;#39;ve extracted the attribute table data for the vegtypes that each tree intersects&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   OBJECTID_1                       NAME MAPCODE12 MPCDSUBT
## 1       7421 Cederberg Sandstone Fynbos      FFs4     &amp;lt;NA&amp;gt;
## 2       7421 Cederberg Sandstone Fynbos      FFs4     &amp;lt;NA&amp;gt;
## 3       7421 Cederberg Sandstone Fynbos      FFs4     &amp;lt;NA&amp;gt;
## 4       7421 Cederberg Sandstone Fynbos      FFs4     &amp;lt;NA&amp;gt;
## 5       7421 Cederberg Sandstone Fynbos      FFs4     &amp;lt;NA&amp;gt;
## 6       7421 Cederberg Sandstone Fynbos      FFs4     &amp;lt;NA&amp;gt;
##                    BIOREGION  BIOME CHANGE_VER      CHANGE_REF CNSRV_TRGT
## 1 Northwest Fynbos Bioregion Fynbos       VM09 Helme (2007) WC         29
## 2 Northwest Fynbos Bioregion Fynbos       VM09 Helme (2007) WC         29
## 3 Northwest Fynbos Bioregion Fynbos       VM09 Helme (2007) WC         29
## 4 Northwest Fynbos Bioregion Fynbos       VM09 Helme (2007) WC         29
## 5 Northwest Fynbos Bioregion Fynbos       VM09 Helme (2007) WC         29
## 6 Northwest Fynbos Bioregion Fynbos       VM09 Helme (2007) WC         29
##   SHAPE_LENG SHAPE_AREA BIOMECODE GRPCODE            GROUP BRGNCODE
## 1    1590266 2151887041         F     FFs Sandstone Fynbos      F01
## 2    1590266 2151887041         F     FFs Sandstone Fynbos      F01
## 3    1590266 2151887041         F     FFs Sandstone Fynbos      F01
## 4    1590266 2151887041         F     FFs Sandstone Fynbos      F01
## 5    1590266 2151887041         F     FFs Sandstone Fynbos      F01
## 6    1590266 2151887041         F     FFs Sandstone Fynbos      F01
##                              LEGEND VTYPSQKM12
## 1 FFs 4  Cederberg Sandstone Fynbos   2512.221
## 2 FFs 4  Cederberg Sandstone Fynbos   2512.221
## 3 FFs 4  Cederberg Sandstone Fynbos   2512.221
## 4 FFs 4  Cederberg Sandstone Fynbos   2512.221
## 5 FFs 4  Cederberg Sandstone Fynbos   2512.221
## 6 FFs 4  Cederberg Sandstone Fynbos   2512.221
##                         DOCLINK SUBTYPENM    BKSORT POLYSQKM
## 1 Descriptions\\FFs_4_2006.docx      &amp;lt;NA&amp;gt; 01 01 004 2151.887
## 2 Descriptions\\FFs_4_2006.docx      &amp;lt;NA&amp;gt; 01 01 004 2151.887
## 3 Descriptions\\FFs_4_2006.docx      &amp;lt;NA&amp;gt; 01 01 004 2151.887
## 4 Descriptions\\FFs_4_2006.docx      &amp;lt;NA&amp;gt; 01 01 004 2151.887
## 5 Descriptions\\FFs_4_2006.docx      &amp;lt;NA&amp;gt; 01 01 004 2151.887
## 6 Descriptions\\FFs_4_2006.docx      &amp;lt;NA&amp;gt; 01 01 004 2151.887&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(droplevels(treeveg$NAME)) # Note the use of droplevels! If you don&amp;#39;t do this summary() will report all ~440 vegetation types in the country where cedars do not occur too...&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##            Cederberg Sandstone Fynbos 
##                                   980 
##            Fynbos Riparian Vegetation 
##                                    14 
## Northern Inland Shale Band Vegetation 
##                                     5 
##             Olifants Sandstone Fynbos 
##                                     1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So a few trees stray off Cederberg Sandstone Fynbos, but this could be errors in the veg mapping. Our vegmap is mostly mapped at 1:250 000 scale (i.e. ~2km error), while our tree locations are accurate to 10m…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now let’s play with the fire record data we downloaded earlier. Firstly we get data the data and transform to our standard CRS as for the vegmap.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#Get CapeNature fire data, reproject and trim to the &amp;quot;extent&amp;quot; of pts (+ a 900m buffer)
firelayers &amp;lt;- readOGR(dsn=paste0(giswd, &amp;quot;CFR/All_fires_15_16_gw&amp;quot;), layer=&amp;quot;All_fires_15_16_gw&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## OGR data source with driver: ESRI Shapefile 
## Source: &amp;quot;/Users/jasper/Documents/GIS/CFR/All_fires_15_16_gw&amp;quot;, layer: &amp;quot;All_fires_15_16_gw&amp;quot;
## with 3719 features
## It has 16 fields
## Integer64 fields read as strings:  ID&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;proj4string(firelayers)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;firelayers &amp;lt;- spTransform(firelayers, CRS(stdCRS))
extent(firelayers)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : Extent 
## xmin        : 250253.7 
## xmax        : 733752.2 
## ymin        : 6150231 
## ymax        : 6453673&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;The fire data covers all CapeNature reserves across the CFR. We could crop() to our extent (E), but there are other ways. Let’s explore and manipulate the data object a little.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#str(firelayers) # Not useful when there are many layers (e.g. fires). It just prints out all the details for each of the ~3500 separate fire layers...
firelayers # Better&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : SpatialPolygonsDataFrame 
## features    : 3719 
## extent      : 250253.7, 733752.2, 6150231, 6453673  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=34 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs +towgs84=0,0,0 
## variables   : 16
## names       :  ID,       FIRE_CODE, Res_code,  Region, Month, Year, Res_centre,                Res_name,                   Local_desc,  Datestart, DateExting, DateWithdr,     Report_off,    Polic_case,                    IgnitionCa, ... 
## min values  :   0, ANYS/00/1986/01,     ANYS, Central,     0, 1927,   Anysberg,            Anysberg MCA,                            ?, 1927/05/28, 1940/06/27, 1944/01/16,             ??,             -, Fire operations - Block burns, ... 
## max values  : 999, WBAY/12/2015/01,     WBAY, Western,    12, 2016,   Waterval, Zuurberg Nature Reserve, Zwartnek - west of Bergplaas, 2016/07/05, 7197/07/31, 2915/09/18, Zibele Blekiwe, yb285/11/2000,             Unknown - Unknown, ...&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(firelayers)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##     ID       FIRE_CODE Res_code  Region Month Year Res_centre
## 0 1340 OUTE/05/1927/01     OUTE Eastern     5 1927  Outeniqua
## 1 1112 SWBG/12/1930/01     SWBG Eastern    12 1930  Swartberg
## 2  771 SWBG/01/1931/01     SWBG Eastern     1 1931  Swartberg
## 3 1016 SWBG/08/1932/01     SWBG Eastern     8 1932  Swartberg
## 4  849 SWBG/02/1933/02     SWBG Eastern     2 1933  Swartberg
## 5  848 SWBG/02/1933/01     SWBG Eastern     2 1933  Swartberg
##                         Res_name                      Local_desc
## 0      Witfontein Nature Reserve                    3322CD - 342
## 1 Groot Swartberg Nature Reserve   Paardevley.3322BD.Fire no A1.
## 2 Groot Swartberg Nature Reserve  De Wetsvley.3322AC.Fire no A2.
## 3 Groot Swartberg Nature Reserve    Plaatberg.3321BD.Fire no.B1.
## 4 Groot Swartberg Nature Reserve    Grootvlei.3321BD.Fire no.C2.
## 5             Grootswartberg MCA Blauwpunt.3322AD-BC.Fire no C1.
##    Datestart DateExting DateWithdr Report_off Polic_case
## 0 1927/05/28       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;
## 1 1930/12/28       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;
## 2 1931/01/18       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;
## 3 1932/08/17       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;
## 4 1933/02/11       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;
## 5 1933/02/11       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;
##            IgnitionCa     Area_ha
## 0   Unknown - Unknown    3.852058
## 1 Natural - Lightning  172.562725
## 2 Natural - Lightning  198.357564
## 3     People - Farmer 2363.599963
## 4   Unknown - Unknown 2999.420641
## 5   Unknown - Unknown 5391.986432&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;names(firelayers)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] &amp;quot;ID&amp;quot;         &amp;quot;FIRE_CODE&amp;quot;  &amp;quot;Res_code&amp;quot;   &amp;quot;Region&amp;quot;     &amp;quot;Month&amp;quot;     
##  [6] &amp;quot;Year&amp;quot;       &amp;quot;Res_centre&amp;quot; &amp;quot;Res_name&amp;quot;   &amp;quot;Local_desc&amp;quot; &amp;quot;Datestart&amp;quot; 
## [11] &amp;quot;DateExting&amp;quot; &amp;quot;DateWithdr&amp;quot; &amp;quot;Report_off&amp;quot; &amp;quot;Polic_case&amp;quot; &amp;quot;IgnitionCa&amp;quot;
## [16] &amp;quot;Area_ha&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;class(firelayers$Res_centre)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;factor&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;levels(firelayers$Res_centre)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] &amp;quot;Anysberg&amp;quot;           &amp;quot;Cederberg&amp;quot;          &amp;quot;De Hoop&amp;quot;           
##  [4] &amp;quot;De Mond&amp;quot;            &amp;quot;Driftsands&amp;quot;         &amp;quot;Gamkaberg&amp;quot;         
##  [7] &amp;quot;Ganzekraal&amp;quot;         &amp;quot;Geelkranz&amp;quot;          &amp;quot;Goukamma&amp;quot;          
## [10] &amp;quot;Grootvadersbosch&amp;quot;   &amp;quot;Grootwinterhoek&amp;quot;    &amp;quot;Hottentots-Holland&amp;quot;
## [13] &amp;quot;Jonkershoek&amp;quot;        &amp;quot;Kammanassie&amp;quot;        &amp;quot;Keurbooms&amp;quot;         
## [16] &amp;quot;Kogelberg&amp;quot;          &amp;quot;Limietberg&amp;quot;         &amp;quot;Marloth&amp;quot;           
## [19] &amp;quot;Matjiesrivier&amp;quot;      &amp;quot;Outeniqua&amp;quot;          &amp;quot;Riverlands&amp;quot;        
## [22] &amp;quot;Robberg&amp;quot;            &amp;quot;Swartberg&amp;quot;          &amp;quot;Towerkop&amp;quot;          
## [25] &amp;quot;Vrolijkheid&amp;quot;        &amp;quot;Walker Bay&amp;quot;         &amp;quot;Waterval&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;unique(firelayers$Res_centre)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] Outeniqua          Swartberg          Jonkershoek       
##  [4] Towerkop           Gamkaberg          Cederberg         
##  [7] Kammanassie        Kogelberg          Limietberg        
## [10] Vrolijkheid        Hottentots-Holland Grootvadersbosch  
## [13] Marloth            Grootwinterhoek    Waterval          
## [16] De Hoop            Anysberg           De Mond           
## [19] Walker Bay         Goukamma           Riverlands        
## [22] Keurbooms          Robberg            Driftsands        
## [25] Ganzekraal         Geelkranz          Matjiesrivier     
## [28] &amp;lt;NA&amp;gt;              
## 27 Levels: Anysberg Cederberg De Hoop De Mond Driftsands ... Waterval&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;We can subset shapefiles based on fields in the attribute table using indexing, e.g. where the Res_centre = Cederberg in this case.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;firelayers &amp;lt;- firelayers[which(firelayers$Res_centre==&amp;quot;Cederberg&amp;quot;),] # Note that each fire polygon is a separate row in the attribute table so R let&amp;#39;s you subset as if you were working with a normal dataframe
firelayers$Res_centre &amp;lt;- droplevels(firelayers$Res_centre) # Remove unwanted levels that were passed on from the original full extent
levels(firelayers$Res_centre)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Cederberg&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(firelayers) # Plot (without colours)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-19-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Let’s use rasterize() to create a raster of the number of fires in each 90m pixel.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;firelayers$ID &amp;lt;- 1:nrow(firelayers) # Add an unique ID for each fire
firecount &amp;lt;- rasterize(firelayers, dem, field=&amp;quot;ID&amp;quot;, fun=&amp;quot;count&amp;quot;) # A count of all fires in each pixel
plot(firecount) # Note that the extent of our firelayers is larger than the DEM, but R trims it to the smaller extent automatically
points(pts, pch=20, cex=.1) # Add the trees&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-20-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now lets rasterize() each fire (date) into it’s own raster, but first we need to look at the underlying data and see if this will work…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;names(firelayers)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] &amp;quot;ID&amp;quot;         &amp;quot;FIRE_CODE&amp;quot;  &amp;quot;Res_code&amp;quot;   &amp;quot;Region&amp;quot;     &amp;quot;Month&amp;quot;     
##  [6] &amp;quot;Year&amp;quot;       &amp;quot;Res_centre&amp;quot; &amp;quot;Res_name&amp;quot;   &amp;quot;Local_desc&amp;quot; &amp;quot;Datestart&amp;quot; 
## [11] &amp;quot;DateExting&amp;quot; &amp;quot;DateWithdr&amp;quot; &amp;quot;Report_off&amp;quot; &amp;quot;Polic_case&amp;quot; &amp;quot;IgnitionCa&amp;quot;
## [16] &amp;quot;Area_ha&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;firelayers$Datestart&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   [1] 1944/01/01 &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       1948/02/01
##   [7] 1955/02/11 1956/04/01 1956/04/15 &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;      
##  [13] 1958/03/29 &amp;lt;NA&amp;gt;       1958/04/18 1958/05/01 1958/04/17 1959/03/23
##  [19] 1959/02/09 1959/09/01 1959/10/01 1963/09/28 1963/01/10 1965/03/09
##  [25] 1965/01/29 1965/11/14 1966/10/06 1967/12/29 1967/09/06 1967/03/11
##  [31] &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       1968/09/13 1969/09/29 1969/03/22 1969/09/29
##  [37] 1969/08/12 1969/09/29 1969/09/29 2006/03/18 2006/03/18 1970/04/21
##  [43] 1970/02/03 1970/02/05 1971/03/23 &amp;lt;NA&amp;gt;       1971/07/20 1972/10/14
##  [49] 1972/03/11 1972/12/07 &amp;lt;NA&amp;gt;       1972/05/01 1973/02/27 1973/04/24
##  [55] 1973/02/27 &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       1974/12/09 &amp;lt;NA&amp;gt;       1975/02/15
##  [61] 1975/11/26 1975/12/12 &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;      
##  [67] 1976/01/30 1978/09/07 1978/09/18 1978/10/05 1978/09/26 1978/10/25
##  [73] 1979/12/25 1979/08/06 1979/08/24 1979/04/22 &amp;lt;NA&amp;gt;       1979/08/13
##  [79] 1979/01/03 1979/08/14 1979/08/21 1980/07/21 1980/06/02 1980/06/02
##  [85] 1980/08/14 1980/05/12 1980/08/25 1980/06/02 1980/08/21 1980/05/29
##  [91] &amp;lt;NA&amp;gt;       1981/06/10 &amp;lt;NA&amp;gt;       &amp;lt;NA&amp;gt;       1981/02/20 1982/08/16
##  [97] &amp;lt;NA&amp;gt;       1982/05/14 1982/08/23 1982/09/22 1982/08/25 1982/05/12
## [103] 1982/09/22 1982/05/14 1982/08/17 &amp;lt;NA&amp;gt;       1984/11/07 1984/03/09
## [109] 1984/03/22 1984/11/30 1985/02/02 &amp;lt;NA&amp;gt;       1985/02/02 1985/11/18
## [115] 1986/12/14 1986/01/02 1986/01/14 1987/04/13 &amp;lt;NA&amp;gt;       1987/04/03
## [121] 1987/01/24 1988/01/17 1988/12/28 1988/12/28 1988/12/28 1988/12/28
## [127] 1989/12/15 1989/01/15 1989/01/18 1989/03/09 1989/04/26 &amp;lt;NA&amp;gt;      
## [133] 1990/05/25 1991/05/12 1991/04/30 1991/05/12 1991/05/01 1991/05/12
## [139] 1991/05/12 1993/05/17 1993/01/13 1993/05/17 1993/10/27 1994/02/04
## [145] 1994/02/24 1995/12/16 &amp;lt;NA&amp;gt;       1995/05/23 1997/01/23 1998/10/15
## [151] 1998/02/15 1998/12/29 1998/05/15 1998/01/12 1998/05/15 1998/10/19
## [157] 1998/03/05 &amp;lt;NA&amp;gt;       1999/12/12 &amp;lt;NA&amp;gt;       2000/10/11 &amp;lt;NA&amp;gt;      
## [163] 2000/01/06 &amp;lt;NA&amp;gt;       2001/03/06 2001/10/04 2002/05/09 2002/01/20
## [169] 2002/04/19 2002/01/01 2002/12/06 2002/02/24 2004/12/22 2004/09/21
## [175] 2004/04/02 2005/10/11 2005/10/27 2005/03/01 2005/11/09 2005/11/28
## [181] 2005/12/01 2006/03/13 2006/02/06 2006/12/05 2006/03/28 2006/09/29
## [187] 2006/12/23 2007/10/26 2007/01/19 2007/01/05 2007/03/02 2007/03/02
## [193] 2008/02/08 2008/01/12 2008/02/07 2008/02/05 2009/12/17 2009/02/06
## [199] 2009/03/11 2009/12/10 2010/02/10 2010/02/21 2011/12/18 2011/03/16
## [205] 2011/02/18 2011/01/31 2012/02/22 2012/12/14 2012/02/21 2012/12/15
## [211] 2012/12/21 2012/11/08 2012/11/20 2013/02/02 2013/02/02 2013/12/10
## [217] 2013/02/05 2013/01/16 2013/02/05 2013/01/31 2013/03/11 2013/12/20
## [223] 2013/01/30 2013/01/25 2013/01/16 2013/01/25 2014/02/13 2014/12/19
## [229] 2014/09/22 2014/04/21 2014/02/14 2014/07/22 2015/02/21 2015/02/07
## [235] 2015/10/23 2015/09/14 2015/09/14 2015/09/14 2015/09/14 2015/11/21
## [241] 2015/09/14 2015/12/29 2015/02/20 2016/04/19 2016/01/09 2016/05/23
## [247] 2016/01/17 2016/01/17 2016/01/20 2016/03/05 2016/04/15
## 2454 Levels: 1927/05/28 1930/12/28 1931/01/18 1932/08/17 ... 2016/07/05&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sum(firelayers$Area_ha[is.na(firelayers$Datestart)])/sum(firelayers$Area_ha) # Proportion of burnt area without start date...&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.07952637&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;firelayers$Year #Lets use &amp;quot;Year&amp;quot; instead...&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   [1] 1944 1945 1945 1945 1947 1948 1955 1956 1956 1958 1958 1958 1958 1958
##  [15] 1958 1958 1958 1959 1959 1959 1959 1963 1963 1965 1965 1965 1966 1967
##  [29] 1967 1967 1967 1968 1968 1969 1969 1969 1969 1969 1969 1970 1970 1970
##  [43] 1970 1970 1971 1971 1971 1972 1972 1972 1972 1972 1973 1973 1973 1974
##  [57] 1974 1974 1975 1975 1975 1975 1975 1975 1976 1976 1976 1978 1978 1978
##  [71] 1978 1978 1979 1979 1979 1979 1979 1979 1979 1979 1979 1980 1980 1980
##  [85] 1980 1980 1980 1980 1980 1980 1981 1981 1981 1981 1981 1982 1982 1982
##  [99] 1982 1982 1982 1982 1982 1982 1982 1984 1984 1984 1984 1984 1985 1985
## [113] 1985 1985 1986 1986 1986 1987 1987 1987 1987 1988 1988 1988 1988 1988
## [127] 1989 1989 1989 1989 1989 1990 1990 1991 1991 1991 1991 1991 1991 1993
## [141] 1993 1993 1993 1994 1994 1995 1995 1995 1997 1998 1998 1998 1998 1998
## [155] 1998 1998 1998 1999 1999 1999 2000 2000 2000 2000 2001 2001 2002 2002
## [169] 2002 2002 2002 2002 2004 2004 2004 2005 2005 2005 2005 2005 2005 2006
## [183] 2006 2006 2006 2006 2006 2007 2007 2007 2007 2007 2008 2008 2008 2008
## [197] 2009 2009 2009 2009 2010 2010 2011 2011 2011 2011 2012 2012 2012 2012
## [211] 2012 2012 2012 2013 2013 2013 2013 2013 2013 2013 2013 2013 2013 2013
## [225] 2013 2013 2014 2014 2014 2014 2014 2014 2015 2015 2015 2015 2015 2015
## [239] 2015 2015 2015 2015 2015 2016 2016 2016 2016 2016 2016 2016 2016&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now we’re going to loop through our fire years and rasterize them one by one. There are some issues we need to address though:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Firstly, this may create a large object in R’s memory and slow it down. We can get around this by writing each raster out to a file. Geotif and some other formats allow writing multiple rasters to one file. We should also dump any unwanted objects from memory using rm().&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Secondly, if there are a lot of cells in the raster and/or there are a lot of layers this operation may take some time either way. If we are on a multicore machine we can speed things up by parallelizing our code.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Thirdly, in this case we would like rasters for all years even if there were no fires (you’ll see why in a minute). We’ll use if() statements to identify years with no fires and fill these in with empty rasters (0’s only).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Lastly, if you end out running the code multiple times then you don’t want to have to repeat big operations like this. We can use file.exists() combined with an if() statement to only run this chunk of code if the file does not exist.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;First let’s dump unwanted objects from memory and try rasterizing the fires on a single core using a normal &lt;em&gt;for&lt;/em&gt; loop.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rm(&amp;quot;aspect&amp;quot;,&amp;quot;slope&amp;quot;, &amp;quot;eastwest&amp;quot;, &amp;quot;northsouth&amp;quot;, &amp;quot;TPI&amp;quot;, &amp;quot;TRI&amp;quot;, &amp;quot;roughness&amp;quot;, &amp;quot;flowdir&amp;quot;)

years &amp;lt;- min(firelayers$Year):max(firelayers$Year) # Get the unique list of years

rfifile &amp;lt;- paste0(datwd, &amp;quot;fires_annual_90m.tif&amp;quot;) # Set a file name

system.time( # To time the process
if(!file.exists(rfifile)) { # Check if the file exists. If not, run this
td &amp;lt;- list() # Create an empty list
# Loop through years making a raster of burnt cells (1/0) for each
  for (i in 1:length(years)) { 
  y &amp;lt;- years[i] # The index year
  # If no fires that year, return a raster of zeros
  if(sum(firelayers$Year==y)==0)  
      td[[i]] &amp;lt;-  raster(extent(dem),res=res(dem),vals=0)
  # If there are fires, rasterize
  if(sum(firelayers$Year==y)&amp;gt;0) 
      td[[i]] &amp;lt;- rasterize(firelayers[which(firelayers$Year==y),],dem, field=&amp;quot;Year&amp;quot;, fun=&amp;quot;count&amp;quot;, background=0) 
  } # End loop
rfi &amp;lt;- stack(td) 
writeRaster(rfi,file=rfifile) # Write out rasters to one file
} # End if() statement
) # End timing&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    user  system elapsed 
##       0       0       0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now lets try it in parallel using the &lt;em&gt;foreach/%dopar%&lt;/em&gt; loop in library(doMC)…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;going-parallel&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Going parallel!&lt;/h3&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;registerDoMC(3) # Set the computer up as a cluster with 3 cores (I have 4, but want to save 1 for other programmes)

rfifileP &amp;lt;- paste0(datwd, &amp;quot;fires_annual_90m_parallel.tif&amp;quot;) # Set a file name

system.time( # To time the process
if(!file.exists(rfifileP)) { # Check if the file exists. If not, run this
# Start parallel processing
rfi &amp;lt;- foreach(y=years,.combine=stack,.packages=&amp;quot;raster&amp;quot;) %dopar% { 
 # Loop through years making a raster of burnt cells (1/0) for each
  # Check if there were any fires that year, if not, return zeros
  if(sum(firelayers$Year==y)==0) 
      td &amp;lt;-  raster(extent(dem),res=res(dem),vals=0)
  # If there are fires, rasterize
  if(sum(firelayers$Year==y)&amp;gt;0)
      td &amp;lt;- rasterize(firelayers[which(firelayers$Year==y),],dem, field=&amp;quot;Year&amp;quot;, fun=&amp;quot;count&amp;quot;, background=0) 
  # Return the individual raster
  return(td)
  } # End parallelized code
writeRaster(rfi,file=rfifileP) # Write out the set of rasters to one file
} # End if() statement
) # End timing&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    user  system elapsed 
##       0       0       0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Not much time difference here, but then this is a small example and most of the time is spent interpreting the input code rather than processing. Going parallel really pays when crunching big analyses…&lt;/p&gt;
&lt;p&gt;Now lets read in the data and plot them.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rfi &amp;lt;- stack(rfifile) # Read the files back in as a stack
rfi # Look at the stack&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : RasterStack 
## dimensions  : 272, 257, 69904, 73  (nrow, ncol, ncell, nlayers)
## resolution  : 78.3, 92.4  (x, y)
## extent      : 314587.6, 334710.7, 6409924, 6435056  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
## names       : fires_annual_90m.1, fires_annual_90m.2, fires_annual_90m.3, fires_annual_90m.4, fires_annual_90m.5, fires_annual_90m.6, fires_annual_90m.7, fires_annual_90m.8, fires_annual_90m.9, fires_annual_90m.10, fires_annual_90m.11, fires_annual_90m.12, fires_annual_90m.13, fires_annual_90m.14, fires_annual_90m.15, ...&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;names(rfi)=paste0(&amp;quot;Fire_&amp;quot;,years) # Add year as name for each raster
rfi &amp;lt;- crop(rfi, E) # Crop to just our area of interest (speeds things up)
plot(rfi) # Plot all layers&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-24-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Pretty messy… there must be a sexier way?&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;animation&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Animation!&lt;/h3&gt;
&lt;p&gt;There are more and more ways of producing cool animations and interactive graphics in R. Here’s a simple example using library(animation). Note that this reqires installing the stand-alone software &lt;a href=&#34;http://www.imagemagick.org/&#34; class=&#34;uri&#34;&gt;http://www.imagemagick.org/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;if(!file.exists(paste0(reswd,&amp;quot;fires.gif&amp;quot;))) { # Check if the file exists
  saveGIF({
    for (i in 1:dim(rfi)[3]) plot(rfi[[i]],
                      main=names(rfi)[i],
                      legend.lab=&amp;quot;Fire!&amp;quot;,
                      col=rev(terrain.colors(2)),
                      breaks=c(-0.1,.1,1.1))}, 
    movie.name = paste0(reswd,&amp;quot;fires.gif&amp;quot;), 
    ani.width = 480, ani.height = 600, 
    interval=.5)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/fires.gif&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Hmm… not that impressive… What if we take advantage of raster calculations and add all the rasters leading up to each time step using sum()?&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;if(!file.exists(paste0(reswd,&amp;quot;firesadded.gif&amp;quot;))) { # Check if the file exists
  saveGIF({
    for (i in 1:dim(rfi)[3]) plot(sum(rfi[[1:i]], na.rm=T), #Note the summing of rasters 1 to i
                      main=names(rfi)[i],
                      legend.lab=&amp;quot;Fire!&amp;quot;,
                      col=rev(terrain.colors(11)),
                      breaks=c(seq(-0.5,10.5,1)))}, 
    movie.name = paste0(reswd,&amp;quot;firesadded.gif&amp;quot;), 
    ani.width = 480, ani.height = 600, 
    interval=.5)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/firesadded.gif&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;some-other-data-visualization-and-analysis&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Some other data visualization and analysis&lt;/h3&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Plotting functions in library(rasterVis)
levelplot(dem)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-27-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;contourplot(dem)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-27-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;persp(dem)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-27-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Some fancy tricks with Google Earth…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;gbmap &amp;lt;- gmap(Mercator(rawpts), type = &amp;quot;satellite&amp;quot;)
plot(gbmap)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-28-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;points(Mercator(rawpts), pch = 20, col = &amp;quot;red&amp;quot;, cex=.3)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-28-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;If you thought that was fancy, check this out! (Note that this only works for embedding into RMarkdown or an html page)&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;op &amp;lt;- options(gvis.plot.tag=&amp;quot;chart&amp;quot;) # Set gvis options for rmarkdown

points.gb &amp;lt;- as.data.frame(rawpts[sample(1:1000, 20),]) # Just select a few trees
points.gb$latlon &amp;lt;- paste(points.gb$coords.x2, points.gb$coords.x1, sep=&amp;quot;:&amp;quot;)
map.gb &amp;lt;- gvisMap(points.gb, locationvar=&amp;quot;latlon&amp;quot;, tipvar=&amp;quot;Name&amp;quot;)
plot(map.gb)&lt;/code&gt;&lt;/pre&gt;
&lt;!-- Map generated in R 3.4.0 by googleVis 0.6.2 package --&gt;
&lt;!-- Thu Jun 29 13:19:42 2017 --&gt;
&lt;!-- jsHeader --&gt;
&lt;script type=&#34;text/javascript&#34;&gt;
 
// jsData 
function gvisDataMapID16bb34e6b69 () {
var data = new google.visualization.DataTable();
var datajson =
[
 [
-32.28621555,
19.12212654,
&#34;&#34;
],
[
-32.29224178,
19.12210154,
&#34;&#34;
],
[
-32.35661931,
19.1904917,
&#34;&#34;
],
[
-32.21945631,
19.0831088,
&#34;&#34;
],
[
-32.27348223,
19.10630658,
&#34;&#34;
],
[
-32.33685064,
19.12413104,
&#34;&#34;
],
[
-32.30639554,
19.14437352,
&#34;&#34;
],
[
-32.33865384,
19.07087484,
&#34;&#34;
],
[
-32.21896741,
19.044433,
&#34;&#34;
],
[
-32.38853692,
19.17820817,
&#34;&#34;
],
[
-32.29984199,
19.1159996,
&#34;&#34;
],
[
-32.34975528,
19.20061016,
&#34;&#34;
],
[
-32.32448687,
19.05727396,
&#34;&#34;
],
[
-32.33675489,
19.15439267,
&#34;&#34;
],
[
-32.28531687,
19.14781307,
&#34;&#34;
],
[
-32.272453,
19.10382838,
&#34;&#34;
],
[
-32.33606795,
19.05279925,
&#34;&#34;
],
[
-32.40671733,
19.1226425,
&#34;&#34;
],
[
-32.32292255,
19.1965966,
&#34;&#34;
],
[
-32.26666522,
19.12202364,
&#34;&#34;
] 
];
data.addColumn(&#39;number&#39;,&#39;Latitude&#39;);
data.addColumn(&#39;number&#39;,&#39;Longitude&#39;);
data.addColumn(&#39;string&#39;,&#39;Name&#39;);
data.addRows(datajson);
return(data);
}
 
// jsDrawChart
function drawChartMapID16bb34e6b69() {
var data = gvisDataMapID16bb34e6b69();
var options = {};
options[&#34;showTip&#34;] = true;

    var chart = new google.visualization.Map(
    document.getElementById(&#39;MapID16bb34e6b69&#39;)
    );
    chart.draw(data,options);
    

}
  
 
// jsDisplayChart
(function() {
var pkgs = window.__gvisPackages = window.__gvisPackages || [];
var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
var chartid = &#34;map&#34;;
  
// Manually see if chartid is in pkgs (not all browsers support Array.indexOf)
var i, newPackage = true;
for (i = 0; newPackage &amp;&amp; i &lt; pkgs.length; i++) {
if (pkgs[i] === chartid)
newPackage = false;
}
if (newPackage)
  pkgs.push(chartid);
  
// Add the drawChart function to the global list of callbacks
callbacks.push(drawChartMapID16bb34e6b69);
})();
function displayChartMapID16bb34e6b69() {
  var pkgs = window.__gvisPackages = window.__gvisPackages || [];
  var callbacks = window.__gvisCallbacks = window.__gvisCallbacks || [];
  window.clearTimeout(window.__gvisLoad);
  // The timeout is set to 100 because otherwise the container div we are
  // targeting might not be part of the document yet
  window.__gvisLoad = setTimeout(function() {
  var pkgCount = pkgs.length;
  google.load(&#34;visualization&#34;, &#34;1&#34;, { packages:pkgs, callback: function() {
  if (pkgCount != pkgs.length) {
  // Race condition where another setTimeout call snuck in after us; if
  // that call added a package, we must not shift its callback
  return;
}
while (callbacks.length &gt; 0)
callbacks.shift()();
} });
}, 100);
}
 
// jsFooter
&lt;/script&gt;
&lt;!-- jsChart --&gt;
&lt;script type=&#34;text/javascript&#34; src=&#34;https://www.google.com/jsapi?callback=displayChartMapID16bb34e6b69&#34;&gt;&lt;/script&gt;
&lt;!-- divChart --&gt;
&lt;div id=&#34;MapID16bb34e6b69&#34; style=&#34;width: 500; height: automatic;&#34;&gt;

&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;options(op) # Reset gvis options to default&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;but-what-about-our-poor-cedars&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;But what about our poor cedars?&lt;/h3&gt;
&lt;p&gt;I haven’t shown you how to extract the data!&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;## null device 
##           1&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;topo$fire &amp;lt;- firecount
topo$dens &amp;lt;- dens
plot(topo)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-1.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-2.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-3.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-4.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-5.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-6.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-7.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-8.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-9.png&#34; width=&#34;672&#34; /&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-31-10.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Current theories around the cedar’s decline include increased fire frequency and climate change. Here are a couple of basic hypotheses we could test:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Under increased fire frequency we would expect fewer cedars in areas where greater numbers of fires occur, but higher survival in areas with greater topographic roughness as this may provide refuge from fire (note that just the perimeters are mapped for most fires).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Under climate change we may expect cedars to be more numerous at higher altitudes, at more northern latitudes, and on South-facing slopes.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Here&amp;#39;s an easy way to get all data and fiddle.
dat = as.data.frame(topo) #check out ?rasterToPoints too

par(mfrow=c(2,2))
plot(dens ~ fire, data=dat)
plot(dens ~ tri, data=dat)
plot(dens ~ dem, data=dat)
plot(dens ~ northsouth, data=dat)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-32-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;par(mfrow=c(1,1))

# Or just extract the locations we want (note that there&amp;#39;ll be repetition of cells with multiple cedars)
dat = as.data.frame(extract(topo, pts))

par(mfrow=c(2,2))
plot(dens ~ fire, data=dat)
plot(dens ~ tri, data=dat)
plot(dens ~ dem, data=dat)
plot(dens ~ northsouth, data=dat)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-32-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;par(mfrow=c(1,1))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;We can also model the species’ distribution based on these variables using functions in the package &lt;em&gt;dismo&lt;/em&gt;. Here I just do a BioClim model, but you can run many other models too. Even MaxEnt is available if you install it separately and tell R where it is on your machine.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;bc &amp;lt;- bioclim(topo[[-10]], pts) # The [[-10]] tells R not to use the 10th raster (dens) in the model fitting as this would be circular...

p &amp;lt;- predict(topo, bc) # Predict potential distribution back onto base data
plot(p)
points(pts, pch=20, cex=.1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-01-PrimerSpatialData_files/figure-html/unnamed-chunk-33-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Type vignette(“sdm”) to get a tutorial on Species Distribution Modelling in R with dismo.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;options-for-writing-out-spatial-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Options for writing out spatial data&lt;/h3&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;?writeOGR # For shapefiles - can save in many many formats
?writeRaster # For rasters - also has many formats
?save # To write out a subset of objects from the project
?save.image # To write out the whole project with all objects (like a .mxd in ArcGIS really)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;THANKS!!!&lt;/p&gt;
&lt;p&gt;If you try this code and have issues the session info is below. Also note that all kinds of weird settings to Flash etc are required to do the gvisMap plot and it only works if embedded in an HTML webpage or similar.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sessionInfo()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## R version 3.4.0 (2017-04-21)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Sierra 10.12.4
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
## 
## attached base packages:
## [1] parallel  methods   stats     graphics  grDevices utils     datasets 
## [8] base     
## 
## other attached packages:
##  [1] googleVis_0.6.2     dismo_1.1-4         animation_2.5      
##  [4] doMC_1.3.4          iterators_1.0.8     foreach_1.4.3      
##  [7] rgdal_1.2-7         rasterVis_0.41      latticeExtra_0.6-28
## [10] RColorBrewer_1.1-2  lattice_0.20-35     raster_2.5-8       
## [13] sp_1.2-4           
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.11      knitr_1.16        magrittr_1.5     
##  [4] viridisLite_0.2.0 stringr_1.2.0     tools_3.4.0      
##  [7] grid_3.4.0        rgeos_0.3-23      htmltools_0.3.6  
## [10] yaml_2.1.14       rprojroot_1.2     digest_0.6.12    
## [13] bookdown_0.4      codetools_0.2-15  evaluate_0.10    
## [16] rmarkdown_1.6     blogdown_0.0.44   stringi_1.1.5    
## [19] compiler_3.4.0    backports_1.1.0   jsonlite_1.5     
## [22] hexbin_1.27.1     zoo_1.8-0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Humans and forests in a changing sea of fire</title>
      <link>/post/fire-shadows/</link>
      <pubDate>Wed, 28 Jun 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/fire-shadows/</guid>
      <description>&lt;center&gt;
&lt;img src=&#34;/img/scienceinprogress/sip1.jpg&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;This is a study recently completed by one of my MSc students, Annabelle Rogers, who I co-supervised with Prof &lt;a href=&#34;http://www.biologicalsciences.uct.ac.za/bio/staff/academic/february&#34;&gt;&lt;strong&gt;Ed February&lt;/strong&gt;&lt;/a&gt; and &lt;a href=&#34;https://scholar.google.co.za/citations?user=_FFdaCUAAAAJ&amp;amp;hl=en&#34;&gt;&lt;strong&gt;Glenn Moncrieff&lt;/strong&gt;&lt;/a&gt;. We’re busy writing it up for publication, but here’s a little preview.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;The study was inspired by &lt;a href=&#34;https://researchspace.csir.co.za/dspace/handle/10204/2045&#34;&gt;&lt;strong&gt;this great paper&lt;/strong&gt;&lt;/a&gt; published by Dr Coert Geldenhuys in 1994, explaining how fire determines the distribution of forests in the Southern Cape. You can also read about it, and get a nice intro to our forests, in this interesting &lt;a href=&#34;http://saforestryonline.co.za/articles/southern-cape-forests-survive-largely-unchanged-for-centuries/&#34;&gt;&lt;strong&gt;SA Forestry Online article&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;The premise of the Geldenhuys study was that certain parts of the landscape are protected from fire due to topographic features interacting with the prevailing winds to create “fire shadows”, where fires will rarely occur. Forests establish and expand in these areas, but are periodically “trimmed back” when severe conditions allow fires to burn into the otherwise non-flammable forest edge.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Our hypothesis, beyond confirming the work by Geldenhuys, was that land cover transformation (e.g. urban expansion) is altering the flow of fire through the landscape and creating new or larger fire shadows.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;The footprint of the City of Cape Town has expanded quite drastically since the 1940s, providing a good site for this study. Here’s a little Youtube clip I put together using the 1:50 000 topo maps of the City made available by OpenStreetMaps &lt;a href=&#34;http://htonl.dev.openstreetmap.org/50k-ct/#11/-34.1232/18.7066/c2010&#34;&gt;&lt;strong&gt;here&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://youtu.be/qmscq6-25z0&#34;&gt;&lt;img src=&#34;https://i.ytimg.com/vi/qmscq6-25z0/0.jpg&#34; alt=&#34;city of cape town&#34; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Another advantage is that &lt;a href=&#34;https://www.researchgate.net/profile/Zoe_Poulsen/publication/279234745_Changes_in_the_distribution_of_indigenous_forest_in_Table_Mountain_National_Park_during_the_20th_Century/links/57a9c7b508aef300152aa8b3.pdf&#34;&gt;&lt;strong&gt;Zoë Poulsen and Timm Hoffman&lt;/strong&gt;&lt;/a&gt; mapped the change in indigenous forest extent in Table Mountain National Park over the period 1944 to 2008, providing the perfect dataset to validate our models and test our hypothesis.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So, we set Annabelle the task of modelling fire on the Cape Peninsula with and without (i.e. pre-settlement) transformation, to identify areas where the probability of burning may have been affected. This gives us a map of “change in burn probability” and highlights areas that have become fire shadows, which we can compare to the change in forest extent.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;I’m not going to go into the details of the fire modelling, including topographic features, developing a fuel model, wind fields and iterations of random ignitions. If you’d like to know more, you’ll have to wait for the paper. Here I present the burn probability maps and quantify the change in burn probability in relation to forest expansion.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;First, let’s look at the reduction in burn probabilities when we “disrupt” the fire catchments by making the transformed areas non-flammable. I’ll only present the simple case where we use a homogenous fuel model - i.e. all vegetation burns on the Peninsula in the same way. In reality the vegetation types can differ in flammability quite considerably, especially fynbos vs forest.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Here we present the burn probabilities without transformation, the burn probabilities with transformation, and the difference between the two.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: I present the code from the R statistical programming language used to do the analysis. Just skip these if you are only interested in the story. I’ve tried to write this so that it makes sense without the code, but include the code for Annabelle and other students interested in performing this kind of analysis. Send me a comment below or &lt;a href=&#34;http://www.ecologi.st/contact/&#34;&gt;&lt;strong&gt;email&lt;/strong&gt;&lt;/a&gt; if you feel I haven’t got this right. The code appears in grey boxes, and the output of the code appears either as the images or grey boxes with all lines preceeded by “##”.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(raster)
library(rgdal)
library(spBayes)
library(rgeos)
library(dplyr)
library(ggplot2)
library(cleangeo)

datwd &amp;lt;- &amp;quot;/Users/jasper/Dropbox/SAEON/Projects/Cape Peninsula/FireShadow/&amp;quot;

#Get and stack files
change &amp;lt;- raster(paste0(datwd,&amp;quot;BP/changeHomog_clip.asc&amp;quot;))
proj4string(change) &amp;lt;- &amp;quot;+proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0&amp;quot;
transformed &amp;lt;- raster(paste0(datwd,&amp;quot;BP/trans_homog_clip.asc&amp;quot;))
proj4string(transformed) &amp;lt;- &amp;quot;+proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0&amp;quot;
untransformed &amp;lt;- raster(paste0(datwd,&amp;quot;BP/untrans_homog_clip.asc&amp;quot;))
proj4string(untransformed) &amp;lt;- &amp;quot;+proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0&amp;quot;
untransformed &amp;lt;- projectRaster(untransformed, transformed)

bp &amp;lt;- stack(untransformed, transformed, change)

par(mfrow=c(1,3))
plot(bp[[1]], main = &amp;quot;Untransformed&amp;quot;, col = rev(heat.colors(100)))
plot(bp[[2]], main = &amp;quot;Transformed&amp;quot;, col = rev(heat.colors(100)))
plot(bp[[3]], main = &amp;quot;Change (U - T)&amp;quot;, col = rev(heat.colors(100)))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;par(mfrow=c(1,1))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So higher, “redder” values represent a greater probability of burning, but note that positive values in the “change” layer represent reduced burn probability, because it represents the difference &lt;em&gt;Untransformed - Transformed&lt;/em&gt;. Also note that the funny numbers around the border are metres from the South Pole (y-axis) and from the Greenwich Meridian (x-axis), because the data are projected with the &lt;a href=&#34;https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system&#34;&gt;&lt;strong&gt;UTM 34S coordinate reference system&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Where’s your house?&lt;/p&gt;
&lt;p&gt;Now let’s get the forest change layers from Poulsen and Hoffman 2015 and plot forest change around Table Mountain.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;f1944 &amp;lt;- readOGR(paste0(datwd, &amp;quot;forest/forestUTM1944.shp&amp;quot;), &amp;quot;forestUTM1944&amp;quot;) #Get the layers&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## OGR data source with driver: ESRI Shapefile 
## Source: &amp;quot;/Users/jasper/Dropbox/SAEON/Projects/Cape Peninsula/FireShadow/forest/forestUTM1944.shp&amp;quot;, layer: &amp;quot;forestUTM1944&amp;quot;
## with 224 features
## It has 7 fields&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;f2008 &amp;lt;- readOGR(paste0(datwd, &amp;quot;forest/forestUTM2008.shp&amp;quot;), &amp;quot;forestUTM2008&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## OGR data source with driver: ESRI Shapefile 
## Source: &amp;quot;/Users/jasper/Dropbox/SAEON/Projects/Cape Peninsula/FireShadow/forest/forestUTM2008.shp&amp;quot;, layer: &amp;quot;forestUTM2008&amp;quot;
## with 205 features
## It has 15 fields&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;###Ignore this code for now. It&amp;#39;s a nicer way of plotting the map, but...
# f2008[205,] #Orangekloof polygon needs fixing!!!
# f1944@data$id = rownames(f1944@data)
# f1944=gUnionCascaded(f1944,id=f1944$id)%&amp;gt;%
#   gSimplify(0.001,topologyPreserve = T) #Fix topology issues
# 
# f2008@data$id = rownames(f2008@data)
# f2008=gUnionCascaded(f2008,id=f2008$id)%&amp;gt;%
#   gSimplify(0.001,topologyPreserve = T) #Fix topology issues

# map &amp;lt;- ggplot(f2008) + 
# aes(long, lat, group = group, fill = &amp;quot;#4393C3&amp;quot;) + 
# geom_polygon(alpha = 0.5) +
# coord_equal() + 
# theme(legend.position=&amp;quot;none&amp;quot;)

sf1944 &amp;lt;- crop(f1944, extent(255000, 270000, 6230000, 6240000))
#sf2008 &amp;lt;- crop(f2008, extent(255000, 270000, 6230000, 6240000))

plot(sf1944, col = &amp;quot;forestgreen&amp;quot;, border = &amp;quot;white&amp;quot;)
plot(f2008, add = T, col = &amp;quot;green&amp;quot;, border = &amp;quot;white&amp;quot;)
plot(f1944, add = T, col = &amp;quot;forestgreen&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Here the dark green is the forest extent in 1944, while the light green indicates the additional forest extent in 2008 - lots of expansion!&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now I’d like to overlay the burn probabilities with the areas that were “stable fynbos” vs “stable forest” vs “forest expansion” over the 1944 to 2008 period and show you the difference as boxplots, but to work with them we’ll need them as raster data (i.e. gridded as opposed to polygons). So first I rasterize each layer to a 90m grid and plot fynbos (0 - grey), stable forest (2 - green) and areas of forest expansion (1 - yellow). Please ignore the confusing scale bar.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fr1944 &amp;lt;- rasterize(f1944, bp, fun = &amp;quot;count&amp;quot;, field = 1, background = 0) #create a raster with &amp;quot;1&amp;quot; where forest occurred
fr2008 &amp;lt;- rasterize(f2008, bp, fun = &amp;quot;count&amp;quot;, field = 1, background = 0) #create a raster with &amp;quot;1&amp;quot; where forest occurred

frDelta &amp;lt;- fr2008 + fr1944

plot(crop(frDelta, extent(255000, 270000, 6230000, 6240000)))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now we can extract them into one dataframe (i.e. a table of data) and bin them into vegetation change classes…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dat &amp;lt;- as.data.frame(na.omit(rasterToPoints(stack(bp, frDelta))))

dat$layer[which(dat$layer == 0)] &amp;lt;- &amp;quot;Stable Fynbos&amp;quot;
dat$layer[which(dat$layer == 1)] &amp;lt;- &amp;quot;Forest Gain&amp;quot;
dat$layer[which(dat$layer %in% c(2,3))] &amp;lt;- &amp;quot;Stable Forest&amp;quot; #Note there is some erroneous overlap in the 2008 polygons

dat$layer &amp;lt;- as.factor(dat$layer)

head(dat)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##        x       y untrans_homog_clip trans_homog_clip changeHomog_clip
## 1 259845 6244515           0.066660         0.009665         0.056995
## 2 259935 6244515           0.066940         0.008860         0.058080
## 3 260025 6244515           0.067385         0.008220         0.059165
## 4 260115 6244515           0.067505         0.007085         0.060420
## 5 259665 6244425           0.063040         0.010975         0.052065
## 6 259755 6244425           0.063715         0.010565         0.053150
##           layer
## 1 Stable Fynbos
## 2 Stable Fynbos
## 3 Stable Fynbos
## 4 Stable Fynbos
## 5 Stable Fynbos
## 6 Stable Fynbos&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So there’s the top few lines of the table above. Now we use these data to draw a box and whisker plot of the reduction in burn probability by class. Here the horizontal mid-line represents the midpoint of the observed values for each class (the median), the box represents the upper and lower quartiles (i.e. 50% of the records for each class fall inside the box), the “whiskers” represent ~75% of the data in each class, and the points (i.e. the black smudge above “Stable Fynbos”) represent outliers that are further from the rest of the data than we would expect.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;g &amp;lt;- ggplot(dat)
g &amp;lt;- g + stat_boxplot(aes(y = changeHomog_clip, x = layer, group = layer), position = &amp;quot;dodge&amp;quot;) + 
  ylab(&amp;quot;Reduction in burn probability&amp;quot;) + 
  xlab(&amp;quot;Vegetation Change&amp;quot;)
g #to plot&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;That “Forest Gain” and “Stable Forest” have much higher medians and “boxes” clearly indicates that forest has remained stable and/or expanded in the areas where there has been a reduction in burn probability. There are many possible reasons for the “outliers” in the “Stable Fynbos” class, but the two main reasons are likely to be that a) not all fynbos sites that have suffered a reduction in burn probability are able to sustain forest (e.g. too dry), and b) these sites may well be transitioning to forest, but more time is needed for them to do so.&lt;/p&gt;
&lt;p&gt;While this plot looks very convincing, unfortunately it would never fool journal reviewer number three…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=-VRBWLpYCPY&#34;&gt;&lt;img src=&#34;http://img.youtube.com/vi/-VRBWLpYCPY/0.jpg&#34; alt=&#34;journal reviewer number three&#34; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;They’ll argue there’s spatial autocorrelation (i.e. things that are close in space are likely to be similar anyway) and will want to see some fancy spatially explicit statistics that don’t tell you any more than this boxplot.&lt;/p&gt;
&lt;p&gt;So here are some convolutedly fancy stats for those of you who are interested. Skip to the brief discussion at the end if you’re not interested in the stats :)&lt;/p&gt;
&lt;p&gt;We’ll start by thinning the data a little by subsampling. Running a spatially explicit Bayesian model on the ~34000 data points (i.e. 90m grid cells) we have requires a very very big computer, and this is just a blog post. Let’s try 10% of the data and plot it to check that it’s representative of the full dataset (as plotted above).&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(1) #Pick a string of random numbers so that we can replicate the sampling

sdat &amp;lt;- dat[sample(1:nrow(dat), nrow(dat)/10),] #Take a 10% sample

g &amp;lt;- ggplot(sdat)
g &amp;lt;- g + stat_boxplot(aes(y = changeHomog_clip, x = layer, group = layer), position = &amp;quot;dodge&amp;quot;) + 
  ylab(&amp;quot;Reduction in burn probability&amp;quot;) + 
  xlab(&amp;quot;Vegetation Change Class&amp;quot;)
g #Plot the sample to see if it is representative of the whole&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Looks pretty representative.&lt;/p&gt;
&lt;p&gt;It turns out it takes ~12 hours to run the following code on the 10% subset of the data on a x86_64-apple-darwin13.4.0 MacBook Pro (so I’ve commented out the next code chunk so I don’t have to run it each time I compile this blog post). I think we’ll need to run the full dataset on a cluster…&lt;/p&gt;
&lt;p&gt;Skip this section if you’re more interested in the results.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# ### Set up a convolutedly long set of model inputs which I won&amp;#39;t eplain
# B &amp;lt;- as.matrix(c(1:3))
# p &amp;lt;- length(B)
# 
# sigma.sq &amp;lt;- 2
# tau.sq &amp;lt;- 0.1
# phi &amp;lt;- 3/0.5
# 
# n.samples &amp;lt;- 2000
# 
# starting &amp;lt;- list(&amp;quot;phi&amp;quot;=3/0.5, &amp;quot;sigma.sq&amp;quot;=50, &amp;quot;tau.sq&amp;quot;=1)
# 
# tuning &amp;lt;- list(&amp;quot;phi&amp;quot;=0.1, &amp;quot;sigma.sq&amp;quot;=0.1, &amp;quot;tau.sq&amp;quot;=0.1)
# 
# ### Set up 2 sets of different &amp;quot;prior beliefs&amp;quot; to see how much this affects the model - note that I&amp;#39;ve just gone with some simple ones here and should really explore a bigger range
# priors.1 &amp;lt;- list(&amp;quot;beta.Norm&amp;quot;=list(rep(0,p), diag(1000,p)),
#                  &amp;quot;phi.Unif&amp;quot;=c(3/1, 3/0.1), &amp;quot;sigma.sq.IG&amp;quot;=c(2, 2),
#                  &amp;quot;tau.sq.IG&amp;quot;=c(2, 0.1))
# 
# priors.2 &amp;lt;- list(&amp;quot;beta.Flat&amp;quot;, &amp;quot;phi.Unif&amp;quot;=c(3/1, 3/0.1),
#                  &amp;quot;sigma.sq.IG&amp;quot;=c(2, 2), &amp;quot;tau.sq.IG&amp;quot;=c(2, 0.1))
# 
# ### Choose a model for the spatial autocorrelation
# cov.model &amp;lt;- &amp;quot;exponential&amp;quot; #A very rapid decay model. This should be fair for our data, but I&amp;#39;ll need to play with this for publication
# 
# n.report &amp;lt;- 500
# verbose &amp;lt;- TRUE
# 
# ###Run the models
# m.1 &amp;lt;- spLM(changeHomog_clip~layer, coords=as.matrix(sdat[,1:2]),
#             data = sdat, starting=starting,
#             tuning=tuning, priors=priors.1, cov.model=cov.model,
#             n.samples=n.samples, verbose=verbose, n.report=n.report)
# 
# m.2 &amp;lt;- spLM(changeHomog_clip~layer, coords=as.matrix(sdat[,1:2]),
#             data = sdat, starting=starting,
#             tuning=tuning, priors=priors.2, cov.model=cov.model,
#             n.samples=n.samples, verbose=verbose, n.report=n.report)
# 
# burn.in &amp;lt;- 0.5*n.samples
# 
# ###Recover beta and spatial random effects
# m.1 &amp;lt;- spRecover(m.1, start=burn.in, verbose=FALSE)
# m.2 &amp;lt;- spRecover(m.2, start=burn.in, verbose=FALSE)
# 
# round(summary(m.1$p.theta.recover.samples)$quantiles[,c(3,1,5)],2)
# round(summary(m.2$p.theta.recover.samples)$quantiles[,c(3,1,5)],2)
# 
# round(summary(m.1$p.beta.recover.samples)$quantiles[,c(3,1,5)],2)
# round(summary(m.2$p.beta.recover.samples)$quantiles[,c(3,1,5)],2)
# 
# m.1.w.summary &amp;lt;- summary(mcmc(t(m.1$p.w.recover.samples)))$quantiles[,c(3,1,5)]
# m.2.w.summary &amp;lt;- summary(mcmc(t(m.2$p.w.recover.samples)))$quantiles[,c(3,1,5)]
#
# save(m.1, paste0(datwd, &amp;quot;model1.RData&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Here’s one I prepared earlier ;)&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;load(paste0(datwd, &amp;quot;model1.RData&amp;quot;)) #Get previously run model output

#round(summary(m.1$p.theta.recover.samples)$quantiles,2) #If you&amp;#39;re running this code this gives you the spatial autocorrelation estimates

round(summary(m.1$p.beta.recover.samples)$quantiles,3)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                      2.5%    25%    50%    75%  97.5%
## (Intercept)         0.009  0.016  0.020  0.024  0.032
## layerStable Forest -0.015 -0.005  0.000  0.004  0.013
## layerStable Fynbos -0.031 -0.023 -0.019 -0.015 -0.008&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So this gives us the median (50%) and quantiles (0.025, 0.25, 0.75, 0.975) of the posterior probability distributions of the estimated average values for each class. “Forest Gain” is the intercept, which is all positive (i.e. lower probability of burning), and overlaps with “Stable Forest”, but does not overlap with “Stable Fynbos”, which confirms what we knew already! Although it’s a little difficult to interpret. Let’s try a boxplot to illustrate this more clearly.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x &amp;lt;- as.data.frame(round(summary(m.1$p.beta.recover.samples)$quantiles,3))

rownames(x) &amp;lt;- levels(sdat$layer)
colnames(x) &amp;lt;- c(&amp;quot;min&amp;quot;, &amp;quot;lower&amp;quot;, &amp;quot;mid&amp;quot;, &amp;quot;upper&amp;quot;, &amp;quot;max&amp;quot;)
  
#m.1.w.summary &amp;lt;- summary(mcmc(t(m.1$p.w.recover.samples)))$quantiles[,c(3,1,5)]

Pa &amp;lt;-  ggplot(x,aes(rownames(x))) +
  geom_boxplot(aes(ymin=min,lower=lower,middle=mid,upper=upper,ymax=max),
              stat=&amp;quot;identity&amp;quot;) +
   ylab(&amp;quot;Reduction in burn probability&amp;quot;) + xlab(&amp;quot;Vegetation Change Class&amp;quot;)

Pa&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So the forest expanded at sites where the probability of burning has been reduced, because land cover transformation has created new “fire shadows”. Null hypothesis accepted?&lt;/p&gt;
&lt;p&gt;Note that there are a bunch of assumptions etc that I haven’t included here. E.g. having more people usually increases ignitions, resulting in more fires. This may also have a biased spatial pattern, like fires are most likely to start along the wildland-urban interface, etc.&lt;/p&gt;
&lt;p&gt;Either way, I think there are many reasons why this analysis is interesting despite it’s flaws, and I suspect the story is at least partially true. The real question is how can we manage this? Do we allow these areas to succeed to forest, despite the loss of fynbos biodiversity at these sites? And the risk of catestrophically big fires if a fire is started in the ~50-100 year period while the fynbos is being invaded by forest and is incredibly flammable?&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;For the reviewer #3’s among you - here are the model diagnostics:&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(m.1$p.beta.recover.samples)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-06-13-fire-shadows_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;It looks like the model converged nicely :)&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Fire!!!</title>
      <link>/post/fire/</link>
      <pubDate>Wed, 10 May 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/fire/</guid>
      <description>&lt;center&gt;
&lt;img src=&#34;/img/scienceinprogress/sip1.jpg&#34; /&gt;
&lt;/center&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;This is a quick and dirty analysis of the &lt;a href=&#34;http://bgis.sanbi.org/Projects/Detail/168&#34;&gt;&lt;strong&gt;CapeNature fire database&lt;/strong&gt;&lt;/a&gt; to see if the &lt;a href=&#34;http://www.ecologi.st/post/2017-04-01-Langrivier/&#34;&gt;&lt;strong&gt;major drought&lt;/strong&gt;&lt;/a&gt; that is currently being experienced in the Cape Floristic Region has had any impact on the occurrence or extent of wildfires.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Wildfires are an essential component of fynbos, but components of the fire regime such as return interval need to be within certain bounds of variability to maintain healthy ecosystems. Too frequent fire and many species do not get time to reproduce, too infrequent fire and plants senesce and/or are invaded by thicket and forest species, eventually excluding fire. Another concern is that the weather conditions in the first year or so after fire can have a big impact on community composition and the postfire recovery trajectory. In a &lt;a href=&#34;http://www.ecologi.st/post/intensifying-postfire-weather-and-biological-invasion-drive-species-loss-in-fynbos/&#34;&gt;&lt;strong&gt;recent long-term study&lt;/strong&gt;&lt;/a&gt;, some co-authors and I have shown that sites where fires were followed by summers with extreme hot and dry weather showed a significant decline in species diversity. Unfortunately, these extremes are becoming more frequent and intense. I may follow this post up with an analysis of fire*postfire weather to highlight areas that have already suffered abnormal extremes, but don’t hold your breath :)&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Note that I can make no guarantees of the accuracy of the fire data. In fact, it is safe to assume that they are far from perfect as the technologies available and the interest in and capacity for mapping fire scars has grown through time. Fire scars are predominantly mapped so that reserve managers know the age of the vegetation, and thus fuel load and fire risk, and there is little incentive to invest time in improving the older records when there are other more pressing issues to deal with. I’ve excluded all reserves that have no data prior to 1980, and have indicated 1980 on the plots as a suggested date from which we could possibly have more confidence in the data, but this is entirely my own assumption…&lt;/p&gt;
&lt;p&gt;Here’s a map of the fires in space. They essentially cover most of the mountainous regions of the Cape.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-05-09-fire_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now let’s look at the number of fires through time. Note that I have split fires into Winter (April to October) vs Summer (November to March) fires. Given that the Austral summer spans the change in calendar year I have labeled each summer based on the start year, e.g. the 2015/2016 fire season is labelled as the summer of 2015. Also note that the record ends in the winter of 2016 as data for the summer of 2016/2017 are still being compiled.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-05-09-fire_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Lots more fires in the last few years, with the top 6 in the last decade. But note that there may be many many small fires (e.g. due to arson) that are easily put out. A better reflection is burnt area as this integrates ignition frequency with the state (i.e. moisture content) of the fuel (i.e. vegetation) and the weather at the time of the fire.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-05-09-fire_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Still lots more burnt area in the past few years, but interestingly the 1988/1989, 1999/2000 and 2015/2016 fire seasons stand head and shoulders above the rest, while both 2014/2015 and 2015/2016 are in the top 5. It sounds like 2016/2017 may be a little lower in number of fires and burnt area than 2015/2016, but still very high relative to the record.&lt;/p&gt;
&lt;p&gt;There are some interestingly low years too (e.g. 1995/1996, 2006/2007, 2013/2014).&lt;/p&gt;
&lt;p&gt;What determined the years with particularly high vs particularly low numbers of fires and burnt area? It looks like I may well have to get stuck into the weather data, but it is likely to be much more complicated than that. A hot, dry year may bear many fires and large burnt areas, but this is not sustainable, because after a few years of these conditions there is less to be burnt. Similarly, one would assume that the accumulation of vegetation biomass is slower in hot, dry years, further reducing the probability of fires in subsequent years. One alternative hypothesis (and there are many) is that frequent fires and hotter, drier weather may shift the system to a grassier state, resulting in more frequent, but less intense fires. Lots of science to be done here…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Intensifying postfire weather and biological invasion drive species loss in fynbos</title>
      <link>/post/intensifying-postfire-weather-and-biological-invasion-drive-species-loss-in-fynbos/</link>
      <pubDate>Fri, 21 Apr 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/intensifying-postfire-weather-and-biological-invasion-drive-species-loss-in-fynbos/</guid>
      <description>&lt;p&gt;After a decade of hard slog I finally had a &lt;a href=&#34;http://www.pnas.org/content/early/2017/04/11/1619014114.abstract&#34;&gt;&lt;strong&gt;study come out this week&lt;/strong&gt;&lt;/a&gt; showing that increasingly prolonged periods of severe hot and dry weather during the first summer after wild fires is inhibiting vegetation recovery and causing loss of plant diversity in the Fynbos. If you don’t have access to the journal through the link above, I made a &lt;a href=&#34;https://www.youtube.com/watch?v=-xSHX8ZK_KM&#34;&gt;&lt;strong&gt;short video&lt;/strong&gt;&lt;/a&gt; explaining the general gist.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=-xSHX8ZK_KM&#34; title=&#34;Climate change impacts in Fynbos at the Cape of Good Hope Section of Table Mountain National Park&#34;&gt;&lt;img src=&#34;http://img.youtube.com/vi/-xSHX8ZK_KM/0.jpg&#34; alt=&#34;Climate change impacts in Fynbos at the Cape of Good Hope Section of Table Mountain National Park&#34; /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Otherwise &lt;a href=&#34;http://jslingsby.github.io/contact/&#34;&gt;&lt;strong&gt;shoot me a message&lt;/strong&gt;&lt;/a&gt; and I’ll send it to you. Besides being some of the first empirical evidence of a climate change impact on biodiversity in the Fynbos Biome, and in South Africa in general, it is a testament to the importance of long-term research, and taking one’s time to do it. But I’ll get back to that and give you the back history at a later stage. For now, I thought I’d just put it out there, and perhaps say a few words about why this is important.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/leuca.jpg&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Firstly, &lt;em&gt;you may wonder why this paper is important?&lt;/em&gt; While we’ve known that climate change will affect our ecosystems, we haven’t known how much the climate needs to change before we’ll detect an impact, or how that impact plays out in different ecosystems subject to different ecological processes. Our study not only shows that fynbos is already responding to changing climate, it demonstrates an important interaction between fire and climate change that may affect flammable ecosystems worldwide. The more we begin to understand these kinds of interactions and their impacts, the better we can anticipate what is to come, and the more prepared we can be.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/diastella.jpg&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Secondly, &lt;em&gt;why should we care about how fynbos will be affected by climate change?&lt;/em&gt; Beyond it’s sheer spectacular beauty, the usual argument about pharmaceutical potential, and the impact its loss would have on our national pride – fynbos being restricted to South Africa - perhaps the biggest concern is what would fill it’s place? “Nature abhors a vacuum” - to borrow from the physicists - and all indications are that the winners from climate change in the Cape are the invasive species from other Mediterranean type ecosystems like the pines, eucalypts and wattles. These invasive alien plants seriously alter landscape-level processes, using more water than the indigenous vegetation and greatly upping the game in terms of scale and impact of fires (a strong motivation for &lt;a href=&#34;https://www.environment.gov.za/projectsprogrammes#workingfor&#34;&gt;&lt;strong&gt;the Department for Environmental Affairs’ Working for/on programmes&lt;/strong&gt;&lt;/a&gt;). It’s &lt;a href=&#34;http://www.saeon.ac.za/enewsletter/archives/2017/february2017/doc02&#34;&gt;&lt;strong&gt;not like we have a lot of water to spare…&lt;/strong&gt;&lt;/a&gt;, and while everyone was shocked by the March 2015 fires in Cape Town &lt;a href=&#34;http://www.saeon.ac.za/enewsletter/archives/2015/april2015/doc01&#34;&gt;&lt;strong&gt;it’s impacts pale in comparison to those experienced in California, Australia and the Mediterranean Basin&lt;/strong&gt;.&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/deadconocarp.jpg&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Unfortunately our study doesn’t provide any simple solutions for adapting to or mitigating climate change impacts, but it does provide is some indication of which kinds of species seem to be more sensitive, some of which were surprising. For example, until now most researchers believed that species that resprout from underground storage organs after fire should be less sensitive to climate impacts, but we found that these were the most sensitive species. The loss of species that resprout could have serious implications for the post-fire recovery of vegetation, with knock-on effects for important ecosystem processes like hydrology, habitat provision, carbon uptake and the fire regime. This kind of information can guide future research efforts and helps us envision the potential range of future outcomes. Knowing which species may be most sensitive also helps guide monitoring programmes and management efforts like assisted dispersal or ex situ conservation, …if we can find ways to make these options affordable.&lt;/p&gt;
&lt;p&gt;Thanks &lt;a href=&#34;http://ottowhitehead.com/&#34;&gt;&lt;strong&gt;Otto&lt;/strong&gt;&lt;/a&gt; for the great pics!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>MODIS and Landsat primer for Hannah</title>
      <link>/post/modis-primer-for-hannah/</link>
      <pubDate>Tue, 04 Apr 2017 00:00:00 +0000</pubDate>
      
      <guid>/post/modis-primer-for-hannah/</guid>
      <description>&lt;p&gt;This is a quick primer on how to handle MODIS and Landsat NDVI data from &lt;a href=&#34;https://earthengine.google.com/&#34;&gt;&lt;strong&gt;Google Earth Engine (GEE)&lt;/strong&gt;&lt;/a&gt; in R. It’s primarily for my Honours student, Hannah Simon, but I thought why not make it public for all to share? I first posted the MODIS section and had Hannah play with the Landsat data as a learning exercise, so full credit to her for the Landsat code.&lt;/p&gt;
&lt;p&gt;For a general introduction for many of the functions used and handling spatial data in general see &lt;a href=&#34;https://jslingsby.github.io/post/2017-04-01-PrimerSpatialData/&#34;&gt;&lt;strong&gt;A Primer for Handling Spatial Data in R&lt;/strong&gt;&lt;/a&gt; posted previously.&lt;/p&gt;
&lt;p&gt;We start by getting the necessary libraries:&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#Get libraries
library(raster) #to handle rasters&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: methods&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: sp&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(rgdal) #to handle shapefiles&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## rgdal: version: 1.1-10, (SVN revision 622)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 1.11.4, released 2016/01/25
##  Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/3.3/Resources/library/rgdal/gdal
##  Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
##  Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.3/Resources/library/rgdal/proj
##  Linking to sp version: 1.2-3&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(reshape) #for data wrangling
library(ggplot2) #for pretty plotting
library(animation) #for silly animations

datwd &amp;lt;- &amp;quot;/Users/jasper/Documents/GIS/CFR/MODISforHannah/&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now let’s start with…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;div id=&#34;modis&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;MODIS&lt;/h2&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#Get data
mNDVI &amp;lt;- stack(paste0(datwd, &amp;quot;2017043_MODIS_v1g_JNP_MOD_NDVI.tif&amp;quot;)) #Note that the file has multiple bands so stack() is the easiest way to read all bands

mNDVI #See what the data look like&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : RasterStack 
## dimensions  : 15, 20, 300, 393  (nrow, ncol, ncell, nlayers)
## resolution  : 250, 250  (x, y)
## extent      : 361250, 366250, 6242250, 6246000  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
## names       : X2017043_//MOD_NDVI.1, X2017043_//MOD_NDVI.2, X2017043_//MOD_NDVI.3, X2017043_//MOD_NDVI.4, X2017043_//MOD_NDVI.5, X2017043_//MOD_NDVI.6, X2017043_//MOD_NDVI.7, X2017043_//MOD_NDVI.8, X2017043_//MOD_NDVI.9, X2017043_//OD_NDVI.10, X2017043_//OD_NDVI.11, X2017043_//OD_NDVI.12, X2017043_//OD_NDVI.13, X2017043_//OD_NDVI.14, X2017043_//OD_NDVI.15, ... 
## min values  :                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768, ... 
## max values  :                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767, ...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So we’ve pulled in the full record of NDVI from the “MODIS/MOD13Q1 16-day composite vegetation indices” product from the dawn of time (i.e. the 18th February 2000) until as recent as possible (6th March 2017), but you’ll notice the names in the raster, e.g. X2017043_MODIS_v1g_JNP_MOD_NDVI.1 aren’t very informative, simply numbering the layers from 1 to 393, but not giving us the dates… For some reason I still haven’t worked out how to embed the dates in the .tif raster exported from GEE, so I save them manually from the console into a text file (stone age, I know, sorry…).&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;metdat &amp;lt;- read.delim(paste0(datwd, &amp;quot;MODIS_metadata.txt&amp;quot;), sep = &amp;quot; &amp;quot;, header = F)

head(metdat)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   V1    V2                                   V3 V4    V5
## 1 0: Image MODIS/MOD13Q1/MOD13Q1_005_2000_02_18 (1 band)
## 2 1: Image MODIS/MOD13Q1/MOD13Q1_005_2000_03_05 (1 band)
## 3 2: Image MODIS/MOD13Q1/MOD13Q1_005_2000_03_21 (1 band)
## 4 3: Image MODIS/MOD13Q1/MOD13Q1_005_2000_04_06 (1 band)
## 5 4: Image MODIS/MOD13Q1/MOD13Q1_005_2000_04_22 (1 band)
## 6 5: Image MODIS/MOD13Q1/MOD13Q1_005_2000_05_08 (1 band)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Still not pretty, but getting closer…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;date &amp;lt;- substr(metdat[,3], start = 27, stop = 37)
date[1:5]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;2000_02_18&amp;quot; &amp;quot;2000_03_05&amp;quot; &amp;quot;2000_03_21&amp;quot; &amp;quot;2000_04_06&amp;quot; &amp;quot;2000_04_22&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;With a bit of squint-counting and trial and error we manage to use substr() to extract the dates!&lt;/p&gt;
&lt;p&gt;But for R to treat them as dates we need to tell it they are dates with as.Date(), and specify the date format (see ?strptime).&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;date &amp;lt;- as.Date(date, format = &amp;quot;%Y_%m_%d&amp;quot;)
date[1:5]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;2000-02-18&amp;quot; &amp;quot;2000-03-05&amp;quot; &amp;quot;2000-03-21&amp;quot; &amp;quot;2000-04-06&amp;quot; &amp;quot;2000-04-22&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Et voilà!&lt;/p&gt;
&lt;p&gt;So we now have a stack of MODIS NDVI images through time, and we know their dates. We can embed the dates into the raster like so:&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;names(mNDVI) &amp;lt;- date

mNDVI #Have another look at the data&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : RasterStack 
## dimensions  : 15, 20, 300, 393  (nrow, ncol, ncell, nlayers)
## resolution  : 250, 250  (x, y)
## extent      : 361250, 366250, 6242250, 6246000  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
## names       : X2000.02.18, X2000.03.05, X2000.03.21, X2000.04.06, X2000.04.22, X2000.05.08, X2000.05.24, X2000.06.09, X2000.06.25, X2000.07.11, X2000.07.27, X2000.08.12, X2000.08.28, X2000.09.13, X2000.09.29, ... 
## min values  :      -32768,      -32768,      -32768,      -32768,      -32768,      -32768,      -32768,      -32768,      -32768,      -32768,      -32768,      -32768,      -32768,      -32768,      -32768, ... 
## max values  :       32767,       32767,       32767,       32767,       32767,       32767,       32767,       32767,       32767,       32767,       32767,       32767,       32767,       32767,       32767, ...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Great! But now you’ll notice that the min and max values are rather strange (-32767 to 32767) when we know that NDVI can only range from -1 to 1, and rarely goes below 0. Very strange! Let’s have a look at our first image.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(mNDVI[[1]])&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;0 to 4000? Even stranger!&lt;/p&gt;
&lt;p&gt;It turns out the issue is that GEE has exported the data in what appears to be a strange format to reduce the file size. We need to tell R how to interpret it by setting a gain and offset.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;NAvalue(mNDVI)=-32767
offs(mNDVI)=0
gain(mNDVI)=.0001
plot(mNDVI[[1]])&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Much more reasonable!&lt;/p&gt;
&lt;p&gt;Ok, so now we can begin to look at our questions; namely, how does MODIS NDVI vary in space and time?&lt;/p&gt;
&lt;p&gt;But first, we should set our focal area.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;site &amp;lt;- readOGR(dsn=paste0(datwd, &amp;quot;Jonaskop 120m.kml&amp;quot;), layer=&amp;quot;Jonaskop 120m.kml&amp;quot;) # A Google Earth KML file&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## OGR data source with driver: KML 
## Source: &amp;quot;/Users/jasper/Documents/GIS/CFR/MODISforHannah/Jonaskop 120m.kml&amp;quot;, layer: &amp;quot;Jonaskop 120m.kml&amp;quot;
## with 1 features
## It has 2 fields&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning in readOGR(dsn = paste0(datwd, &amp;quot;Jonaskop 120m.kml&amp;quot;), layer =
## &amp;quot;Jonaskop 120m.kml&amp;quot;): Z-dimension discarded&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;site &amp;lt;- spTransform(site, CRS(proj4string(mNDVI))) #Reproject to match the projection of the MODIS data (UTM 34S in this case)

plot(mNDVI[[1]])
plot(site, add=T)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;It looks like we’re wrangling a lot more MODIS data than we need to. Let’s crop to out focal area…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mNDVI &amp;lt;- crop(mNDVI, site, snap = &amp;quot;out&amp;quot;) #&amp;quot;snap=&amp;quot;out&amp;quot;&amp;quot; adds a buffer around the site

plot(mNDVI[[1]])
plot(site, add=T)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;…and look at a few images through time.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(mNDVI) #Note that R limits it to the first 16 images&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Lots of variation in space! What about time?&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;if(!file.exists(&amp;quot;/Users/jasper/GIT/jslingsby.github.io_local/static/img/output/mNDVI.gif&amp;quot;)) { # Check if the file exists
  saveGIF({
    for (i in 1:dim(mNDVI)[3]) plot(mNDVI[[i]],
                      main=names(mNDVI)[i],
                      legend.lab=&amp;quot;NDVI&amp;quot;,
                      col=rev(terrain.colors(length(c(seq(0,.7,.05),1)))),
                      breaks=seq(0,.7,.05))}, 
    movie.name = &amp;quot;/Users/jasper/GIT/jslingsby.github.io_local/static/img/output/mNDVI.gif&amp;quot;, 
    ani.width = 600, ani.height = 500, 
    interval=.25)
}&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/output/mNDVI.gif&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;*NOTE: this writes a .gif to file and does not render in R (or R notebook), so I had to insert it in the Markdown script.&lt;/p&gt;
&lt;p&gt;You could make it a lot prettier, but still pretty fancy. Not very useful for the print edition though. How about just a simple line graph? this requires extracting the data to a data.frame.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dat &amp;lt;- as.data.frame(mNDVI)

dat[1:10,1:10] #look at the data&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    X2000.02.18 X2000.03.05 X2000.03.21 X2000.04.06 X2000.04.22 X2000.05.08
## 1       0.2889      0.3280      0.3723      0.3743      0.3979      0.3902
## 2       0.3127      0.3745      0.3850      0.3872      0.3680      0.4681
## 3       0.3205      0.3508      0.3909      0.3878      0.3647      0.4488
## 4       0.3256      0.3323      0.3823      0.4001      0.3542      0.4050
## 5       0.3206      0.3841      0.3934      0.3817      0.3864      0.3987
## 6       0.2866      0.3567      0.3723      0.3757      0.3799      0.4278
## 7       0.2866      0.3567      0.3832      0.3808      0.3510      0.4681
## 8       0.3340      0.3709      0.4215      0.3787      0.4191      0.4681
## 9       0.3205      0.4144      0.4215      0.4099      0.3900      0.4615
## 10      0.3256      0.4278      0.4363      0.4085      0.4115      0.4615
##    X2000.05.24 X2000.06.09 X2000.06.25 X2000.07.11
## 1       0.4644      0.4777      0.4730      0.4220
## 2       0.4704      0.4777      0.4730      0.4289
## 3       0.4698      0.4574      0.4340      0.4532
## 4       0.4596      0.4574      0.4636      0.4228
## 5       0.4522      0.4193      0.4636      0.4517
## 6       0.4493      0.4538      0.4091      0.4160
## 7       0.4043      0.4913      0.4730      0.4359
## 8       0.4885      0.4913      0.4616      0.4300
## 9       0.4318      0.4589      0.4908      0.4363
## 10      0.4212      0.4413      0.4697      0.4489&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So each date is a column and each cell in space is a row in our data frame. This isn’t ideal for plotting so let’s reshape the data into long format.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;rownames(dat) &amp;lt;- paste0(&amp;quot;A&amp;quot;,1:20) #Add dummy column labels

dat &amp;lt;- as.data.frame(t(dat)) #transpose data.frame

dat$Date &amp;lt;- as.Date(rownames(dat), format = &amp;quot;X%Y.%m.%d&amp;quot;)

dat &amp;lt;- melt(dat, id=c(&amp;quot;Date&amp;quot;))

head(dat)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##         Date variable  value
## 1 2000-02-18       A1 0.2889
## 2 2000-03-05       A1 0.3280
## 3 2000-03-21       A1 0.3723
## 4 2000-04-06       A1 0.3743
## 5 2000-04-22       A1 0.3979
## 6 2000-05-08       A1 0.3902&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now let’s make some pretty pictures!&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = dat, aes(x = Date, y = value, colour = variable)) + geom_line()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-15-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Pretty neat! It looks like our site burnt in the summer of 2000/2001. Now let’s split them up.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = dat, aes(x = Date, y = value, colour = variable)) + geom_line() + facet_wrap(~variable)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-16-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Well there’s definitely clear seasonality and, while subtle, there are differences among the cells. What do we see with…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;landsat&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Landsat&lt;/h2&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;First we read in the full record of data for Landsat 8 for our area of interest.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;lsNDVI &amp;lt;- stack(paste0(datwd,&amp;quot;Landsat/2017045_v1_LC8_L1T_TOA_Jonaskop_daily__2013-04-15-2017-03-25.tif&amp;quot;)) #note that I have used LC8 (LandSat 8)
lsNDVI&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## class       : RasterStack 
## dimensions  : 114, 157, 17898, 154  (nrow, ncol, ncell, nlayers)
## resolution  : 30, 30  (x, y)
## extent      : 361320, 366030, 6242370, 6245790  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=utm +zone=34 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 
## names       : X2017045_//17.03.25.1, X2017045_//17.03.25.2, X2017045_//17.03.25.3, X2017045_//17.03.25.4, X2017045_//17.03.25.5, X2017045_//17.03.25.6, X2017045_//17.03.25.7, X2017045_//17.03.25.8, X2017045_//17.03.25.9, X2017045_//7.03.25.10, X2017045_//7.03.25.11, X2017045_//7.03.25.12, X2017045_//7.03.25.13, X2017045_//7.03.25.14, X2017045_//7.03.25.15, ... 
## min values  :                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768,                -32768, ... 
## max values  :                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767,                 32767, ...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Then the metadata with dates.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;metdat2 &amp;lt;- read.delim(paste0(datwd,&amp;quot;Landsat/LC8_L1T_TOA_metadata.txt&amp;quot;), sep = &amp;quot; &amp;quot;, header = F) 
head(metdat2) #first few rows of metdat&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   V1         V2
## 1 0: 2013-04-15
## 2 1: 2013-04-22
## 3 2: 2013-05-17
## 4 3: 2013-05-24
## 5 4: 2013-06-09
## 6 5: 2013-06-18&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tail(metdat2) #last few rows of metdat (our data goes up to 25th march, 2017)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##       V1         V2
## 149 148: 2017-02-12
## 150 149: 2017-02-21
## 151 150: 2017-02-28
## 152 151: 2017-03-09
## 153 152: 2017-03-16
## 154 153: 2017-03-25&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Extract the dates, embed into the raster and have a look at the first scene.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;date2 &amp;lt;- substr(metdat2[,2], start = 0, stop = 10) #will extract YYYY_MM_DD
names(lsNDVI) &amp;lt;- date2 #assign the date to the &amp;#39;names&amp;#39; of each NDVI value
plot(lsNDVI[[1]]) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-19-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Looks good, but the scale’s all wrong again, so we need to fix the gain and offset&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;NAvalue(lsNDVI)=0
offs(lsNDVI)=-1.5
gain(lsNDVI)=.001
plot(lsNDVI[[1]])
plot(site, add=T)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-20-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Better! But still suspiscious… Note that I hacked the offset at -1.5 (it’s usually 2) I’ll need to recheck what the gain and offset values should be and fix this later…&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now let’s zoom in on our focal site&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;lsNDVI &amp;lt;- crop(lsNDVI, site, snap = &amp;quot;out&amp;quot;) #&amp;quot;snap=&amp;quot;out&amp;quot;&amp;quot; adds a buffer around the site

plot(lsNDVI[[1]])
plot(site, add=T)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-21-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now let’s have a look at the variation in both space and time.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(lsNDVI)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-22-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Lots of errors because of NA’s! It looks like some scenes are empty, while others are dominated by cloud (we applied a cloud masking algorithm in GEE). We’ll need to get rid of these. Note that this isn’t a problem with the MODIS data, because the MODIS data are an 8-day composite based on 2 scenes per day (i.e the choice of 16 scenes to make up one complete one). We can easily exclude the blank Landsat scenes by identifying those with NA values only (if the minimum or maximum value is NA, then there are no values other than NA).&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;metdat2 &amp;lt;- metdat2[-which(is.na(minValue(lsNDVI))),] #Drop empty scenes from metadata
lsNDVI &amp;lt;- lsNDVI[[-which(is.na(minValue(lsNDVI)))]] #Drop empty scenes from rasterStack&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Now we can look at variation through time using an animation as we did before. Note that in the previous plots the colour range varies. For the animation we need to set a fixed colour range so that a particular shade of green or yellow represents the same value across scenes. For the Landsat data these range from 0.255 to 0.555&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;if(!file.exists(&amp;quot;/Users/jasper/GIT/jslingsby.github.io_local/static/img/output/lsNDVI.gif&amp;quot;)) { # Check if the file exists
  saveGIF({
    for (i in 1:dim(lsNDVI)[3]) plot(lsNDVI[[i]],
                      main=names(lsNDVI)[i],
                      legend.lab=&amp;quot;NDVI&amp;quot;,
                      col=rev(terrain.colors(length(c(seq(min(minValue(lsNDVI)),max(maxValue(lsNDVI)),.01),1)))),
                      breaks=seq(min(minValue(lsNDVI)),max(maxValue(lsNDVI)),.01))}, 
    movie.name = &amp;quot;/Users/jasper/GIT/jslingsby.github.io_local/static/img/output/lsNDVI.gif&amp;quot;, 
    ani.width = 600, ani.height = 500, 
    interval=.25)
}&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;/img/output/lsNDVI.gif&#34; /&gt;

&lt;/div&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Looks like there’s generally lower NDVI in the lower righthand corner parhaps?&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Let’s look at some time-series graphs. First the data wrangling, then plotting; following just about the same formula as for the MODIS data.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ldat &amp;lt;- as.data.frame(lsNDVI)

#ldat[1:10,1:10] #look at the data

rownames(ldat) &amp;lt;- paste0(1:nrow(ldat)) #dummy column labels

ldat &amp;lt;- as.data.frame(t(ldat)) #transpose data.frame

ldat$Date &amp;lt;- as.Date(rownames(ldat), format = &amp;quot;X%Y.%m.%d&amp;quot;)

ldat &amp;lt;- melt(ldat, id=c(&amp;quot;Date&amp;quot;))

colnames(ldat)&amp;lt;- c(&amp;quot;Date&amp;quot;,&amp;quot;Pixel.Number&amp;quot;,&amp;quot;NDVI.Value&amp;quot;)

#head(ldat)

NDVIplot2 &amp;lt;- ggplot(data = ldat, aes(x = Date, y = NDVI.Value, colour = Pixel.Number)) + geom_line() + theme(legend.position=&amp;quot;none&amp;quot;) #remove legend as plot space cannot accommodate it - there are &amp;gt;800 pixels!

NDVIplot2 &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-25-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So we still pick up some nice seasonality! Note this is “zoom in” on just the last ~4 years. It is a bit messy with all &amp;gt;800 pixels though, so let’s select just a few.&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;Converting a rasterStack into a data.frame fills the dataframe with raster cell values by row from left to right and numbers them. We know there are 28 rows and 31 columns (= 868 pixels), so we can use this to sample cells of interest.&lt;/p&gt;
&lt;p&gt;This is how the grid is numbered:&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;matrix(1:868, 28, 31, byrow = T)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
##  [1,]    1    2    3    4    5    6    7    8    9    10    11    12    13
##  [2,]   32   33   34   35   36   37   38   39   40    41    42    43    44
##  [3,]   63   64   65   66   67   68   69   70   71    72    73    74    75
##  [4,]   94   95   96   97   98   99  100  101  102   103   104   105   106
##  [5,]  125  126  127  128  129  130  131  132  133   134   135   136   137
##  [6,]  156  157  158  159  160  161  162  163  164   165   166   167   168
##  [7,]  187  188  189  190  191  192  193  194  195   196   197   198   199
##  [8,]  218  219  220  221  222  223  224  225  226   227   228   229   230
##  [9,]  249  250  251  252  253  254  255  256  257   258   259   260   261
## [10,]  280  281  282  283  284  285  286  287  288   289   290   291   292
## [11,]  311  312  313  314  315  316  317  318  319   320   321   322   323
## [12,]  342  343  344  345  346  347  348  349  350   351   352   353   354
## [13,]  373  374  375  376  377  378  379  380  381   382   383   384   385
## [14,]  404  405  406  407  408  409  410  411  412   413   414   415   416
## [15,]  435  436  437  438  439  440  441  442  443   444   445   446   447
## [16,]  466  467  468  469  470  471  472  473  474   475   476   477   478
## [17,]  497  498  499  500  501  502  503  504  505   506   507   508   509
## [18,]  528  529  530  531  532  533  534  535  536   537   538   539   540
## [19,]  559  560  561  562  563  564  565  566  567   568   569   570   571
## [20,]  590  591  592  593  594  595  596  597  598   599   600   601   602
## [21,]  621  622  623  624  625  626  627  628  629   630   631   632   633
## [22,]  652  653  654  655  656  657  658  659  660   661   662   663   664
## [23,]  683  684  685  686  687  688  689  690  691   692   693   694   695
## [24,]  714  715  716  717  718  719  720  721  722   723   724   725   726
## [25,]  745  746  747  748  749  750  751  752  753   754   755   756   757
## [26,]  776  777  778  779  780  781  782  783  784   785   786   787   788
## [27,]  807  808  809  810  811  812  813  814  815   816   817   818   819
## [28,]  838  839  840  841  842  843  844  845  846   847   848   849   850
##       [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
##  [1,]    14    15    16    17    18    19    20    21    22    23    24
##  [2,]    45    46    47    48    49    50    51    52    53    54    55
##  [3,]    76    77    78    79    80    81    82    83    84    85    86
##  [4,]   107   108   109   110   111   112   113   114   115   116   117
##  [5,]   138   139   140   141   142   143   144   145   146   147   148
##  [6,]   169   170   171   172   173   174   175   176   177   178   179
##  [7,]   200   201   202   203   204   205   206   207   208   209   210
##  [8,]   231   232   233   234   235   236   237   238   239   240   241
##  [9,]   262   263   264   265   266   267   268   269   270   271   272
## [10,]   293   294   295   296   297   298   299   300   301   302   303
## [11,]   324   325   326   327   328   329   330   331   332   333   334
## [12,]   355   356   357   358   359   360   361   362   363   364   365
## [13,]   386   387   388   389   390   391   392   393   394   395   396
## [14,]   417   418   419   420   421   422   423   424   425   426   427
## [15,]   448   449   450   451   452   453   454   455   456   457   458
## [16,]   479   480   481   482   483   484   485   486   487   488   489
## [17,]   510   511   512   513   514   515   516   517   518   519   520
## [18,]   541   542   543   544   545   546   547   548   549   550   551
## [19,]   572   573   574   575   576   577   578   579   580   581   582
## [20,]   603   604   605   606   607   608   609   610   611   612   613
## [21,]   634   635   636   637   638   639   640   641   642   643   644
## [22,]   665   666   667   668   669   670   671   672   673   674   675
## [23,]   696   697   698   699   700   701   702   703   704   705   706
## [24,]   727   728   729   730   731   732   733   734   735   736   737
## [25,]   758   759   760   761   762   763   764   765   766   767   768
## [26,]   789   790   791   792   793   794   795   796   797   798   799
## [27,]   820   821   822   823   824   825   826   827   828   829   830
## [28,]   851   852   853   854   855   856   857   858   859   860   861
##       [,25] [,26] [,27] [,28] [,29] [,30] [,31]
##  [1,]    25    26    27    28    29    30    31
##  [2,]    56    57    58    59    60    61    62
##  [3,]    87    88    89    90    91    92    93
##  [4,]   118   119   120   121   122   123   124
##  [5,]   149   150   151   152   153   154   155
##  [6,]   180   181   182   183   184   185   186
##  [7,]   211   212   213   214   215   216   217
##  [8,]   242   243   244   245   246   247   248
##  [9,]   273   274   275   276   277   278   279
## [10,]   304   305   306   307   308   309   310
## [11,]   335   336   337   338   339   340   341
## [12,]   366   367   368   369   370   371   372
## [13,]   397   398   399   400   401   402   403
## [14,]   428   429   430   431   432   433   434
## [15,]   459   460   461   462   463   464   465
## [16,]   490   491   492   493   494   495   496
## [17,]   521   522   523   524   525   526   527
## [18,]   552   553   554   555   556   557   558
## [19,]   583   584   585   586   587   588   589
## [20,]   614   615   616   617   618   619   620
## [21,]   645   646   647   648   649   650   651
## [22,]   676   677   678   679   680   681   682
## [23,]   707   708   709   710   711   712   713
## [24,]   738   739   740   741   742   743   744
## [25,]   769   770   771   772   773   774   775
## [26,]   800   801   802   803   804   805   806
## [27,]   831   832   833   834   835   836   837
## [28,]   862   863   864   865   866   867   868&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;So let’s take a few from the bottom right (where the NDVI is generally low):&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;lowc &amp;lt;- c(614, 617, 707, 710)
highc &amp;lt;- c(128, 131, 221, 224)

lowdat &amp;lt;- subset(ldat, Pixel.Number%in%lowc)
highdat &amp;lt;- subset(ldat, Pixel.Number%in%highc)

NDVIplot_low &amp;lt;- ggplot(data = lowdat, aes(x = Date, y = NDVI.Value, colour = Pixel.Number)) + geom_line() #+ theme(legend.position=&amp;quot;none&amp;quot;) #remove legend as plot space cannot accommodate it - there are &amp;gt;800 pixels!

NDVIplot_low &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-27-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;p&gt;And a few from the top left (where the NDVI is generally high):&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;NDVIplot_high &amp;lt;- ggplot(data = highdat, aes(x = Date, y = NDVI.Value, colour = Pixel.Number)) + geom_line() #+ theme(legend.position=&amp;quot;none&amp;quot;) #remove legend as plot space cannot accommodate it - there are &amp;gt;800 pixels!

NDVIplot_high&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2017-04-03-modis-primer-for-hannah_files/figure-html/unnamed-chunk-28-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Publications</title>
      <link>/publications/</link>
      <pubDate>Fri, 31 Mar 2017 21:05:33 +0530</pubDate>
      
      <guid>/publications/</guid>
      <description>

&lt;h3 id=&#34;papers-and-peer-reviewed-book-chapters&#34;&gt;Papers and peer-reviewed book chapters&lt;/h3&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;script type=&#39;text/javascript&#39; src=&#39;https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js&#39;&gt;&lt;/script&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;2017&#34;&gt;2017&lt;/h4&gt;

&lt;p&gt;Slingsby, J.A., Merow, C., Aiello-Lammens, M., Allsopp, N., Hall, S., Mollmann, H.K., Turner, R., Wilson, A.M. and Silander, J.A., 2017. Intensifying postfire weather and biological invasion drive species loss in a Mediterranean-type biodiversity hotspot. Proceedings of the National Academy of Sciences. &lt;a href=&#34;http://dx.doi.org/10.1073/pnas.1619014114&#34;&gt;http://dx.doi.org/10.1073/pnas.1619014114&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1073/pnas.1619014114&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;le Roux, M. Marianne, Wilkin, Paul, Balkwill, Kevin, Boatwright, J. Stephen, Bytebier, Benny, Filer, Denis, Klak, Cornelia, Klopper, Ronell R., Koekemoer, Marinda, Livermore, Laurence, Lubke, Roy, Magee, Anthony R., Manning, John C., Paton, Alan, Pearce, Tim, Slingsby, Jasper, van Wyk, Ben-Erik, Victor, Janine E., von Staden, Lize, 2017. Producing a plant diversity portal for South Africa. Taxon. &lt;a href=&#34;https://doi.org/10.12705/662.9&#34;&gt;https://doi.org/10.12705/662.9&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.12705/662.9&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;Aiello-Lammens, M.E., Slingsby, J.A., Merow, C., Mollmann, H.K., Euston-Brown, D., Jones, C.S. &amp;amp; Silander Jr., J.A. 2017. Processes of community assembly in an environmentally heterogeneous, high biodiversity region. Ecography. 40: 561–576. &lt;a href=&#34;http://dx.doi.org/10.1111/ecog.01945&#34;&gt;http://dx.doi.org/10.1111/ecog.01945&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1111/ecog.01945&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;2016&#34;&gt;2016&lt;/h4&gt;

&lt;p&gt;Wigley, B.J., Slingsby, J.A., Díaz, S., Bond, W.J., Fritz, H. and Coetsee, C., 2016. Leaf traits of African woody savanna species across climate and soil fertility gradients: evidence for conservative versus acquisitive resource‐use strategies. Journal of Ecology, 104(5), pp.1357-1369. &lt;a href=&#34;http://dx.doi.org/10.1111/1365-2745.12598&#34;&gt;http://dx.doi.org/10.1111/1365-2745.12598&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1111/1365-2745.12598&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;Verboom, G.A., Herron, M.L., Moncrieff, G.R and Slingsby, J.A. 2016. Maintenance of species integrity in the context of a recent radiation: the case of Jamesbrittenia (Scrophulariaceae: Limoselleae) in southern Africa. Botanical Journal of the Linnean Society, 2016, 182, 115–139. &lt;a href=&#34;http://dx.doi.org/10.1111/boj.12447&#34;&gt;http://dx.doi.org/10.1111/boj.12447&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1111/boj.12447&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;2015&#34;&gt;2015&lt;/h4&gt;

&lt;p&gt;Daru, Barnabas H., Michelle van der Bank, Olivier Maurin, Kowiyou Yessoufou, Hanno Schaefer, Jasper A. Slingsby and T. Jonathan Davies. 2015. A novel phylogenetic regionalization of phytogeographic zones of southern Africa reveals their hidden evolutionary affinities. Journal of Biogeography 43: 155–166. &lt;a href=&#34;http://dx.doi.org/10.1111/jbi.12619&#34;&gt;http://dx.doi.org/10.1111/jbi.12619&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1111/jbi.12619&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;Molina-Venegas, R., Aparicio, A., Slingsby, J.A,;  Lavergne, S. &amp;amp; Arroyo, J. 2015. Investigating the evolutionary assembly of a Mediterranean biodiversity hotspot: deep phylogenetic signal in the distribution of eudicots across elevational belts. Journal of Biogeography 42:507-518. &lt;a href=&#34;http://dx.doi.org/10.1111/jbi.12398&#34;&gt;http://dx.doi.org/10.1111/jbi.12398&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1111/jbi.12398&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;Moncrieff, G.R., Scheiter, S., Slingsby, J.A. &amp;amp; Higgins, S.I. 2015. Understanding global change impacts on South African biomes using Dynamic Vegetation Models. South African Journal of Botany 101: 16-23. &lt;a href=&#34;http://dx.doi.org/10.1016/j.sajb.2015.02.004&#34;&gt;http://dx.doi.org/10.1016/j.sajb.2015.02.004&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1016/j.sajb.2015.02.004&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;Seymour, C.L., Simmons, R.E., Joseph, G.S. &amp;amp; Slingsby, J.A. 2015. On bird functional diversity: species richness and functional differentiation show contrasting responses to rainfall and vegetation structure in an arid landscape. Ecosystems. 18: 971–984. &lt;a href=&#34;http://dx.doi.org/10.1007/s10021-015-9875-8&#34;&gt;http://dx.doi.org/10.1007/s10021-015-9875-8&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1007/s10021-015-9875-8&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;2014&#34;&gt;2014&lt;/h4&gt;

&lt;p&gt;Ackerly, D.D., Stock, W.D., Slingsby, J.A. 2014. Geography, Climate, and biodiversity: the history and future of Mediterranean-type ecosystems. In Allsopp, N., Colville, J.F. and Verboom, G.A.(editors), Fynbos: Ecology, Evolution and Conservation in a Megadiverse Region. Oxford University Press, UK. &lt;a href=&#34;https://www.oxford.co.za/book/9780199679584-fynbos-ecology-evolution-and-conservation-of-a-megadiverse-regio#.WPtOslOGORs&#34;&gt;&lt;strong&gt;Buy book.&lt;/strong&gt;&lt;/a&gt; &lt;a href=&#34;http://jslingsby.github.io/contact/&#34;&gt;&lt;strong&gt;Request chapter&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Bouchenak-Khelladi, Y., Slingsby, J.A., Verboom, G. A. &amp;amp; Bond, W.J. 2014. Diversification of C4 grasses (Poaceae) does not coincide with their ecological dominance. American Journal of Botany 101:300-307. &lt;a href=&#34;http://dx.doi.org/10.3732/ajb.1300439&#34;&gt;http://dx.doi.org/10.3732/ajb.1300439&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.3732/ajb.1300439&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;Moore, C., Cumming, G.S., Slingsby, J. &amp;amp; Grewar, J. 2014. Tracking socioeconomic vulnerability using network analysis: insights from an avian influenza outbreak in an ostrich production network. PlosONE 9:e86973. &lt;a href=&#34;http://dx.doi.org/10.1371/journal.pone.0086973&#34;&gt;http://dx.doi.org/10.1371/journal.pone.0086973&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1371/journal.pone.0086973&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;Slingsby, J.A., Britton, M.N. &amp;amp; Verboom, G.A. 2014. Ecology limits the diversity of the Cape flora: phylogenetics and diversification of the genus Tetraria. Molecular Phylogenetics and Evolution 72:61-70. &lt;a href=&#34;http://dx.doi.org/10.1016/j.ympev.2013.11.017&#34;&gt;http://dx.doi.org/10.1016/j.ympev.2013.11.017&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1016/j.ympev.2013.11.017&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;
 

&lt;p&gt;Slingsby, J.A., Ackerly, D.D., Latimer, A.M., Linder, H.P. &amp;amp; Pauw, A. 2014. The assembly and function of Cape plant communities in a changing world. In Allsopp, N., Colville, J.F. and Verboom, G.A.(editors), Fynbos: Ecology, Evolution and Conservation in a Megadiverse Region. Oxford University Press, UK. &lt;a href=&#34;https://www.oxford.co.za/book/9780199679584-fynbos-ecology-evolution-and-conservation-of-a-megadiverse-regio#.WPtOslOGORs&#34;&gt;&lt;strong&gt;Buy book.&lt;/strong&gt;&lt;/a&gt; &lt;a href=&#34;http://jslingsby.github.io/contact/&#34;&gt;&lt;strong&gt;Request chapter&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;2013&#34;&gt;2013&lt;/h4&gt;

&lt;p&gt;Paxton, B.R., O’Brien, G.C., Slingsby, J.A. &amp;amp; Copin, R. 2013. Validation of the periodicity of growth increment deposition in otoliths from the larval and early juvenile stages of two cyprinids from the Orange–Vaal river system, South Africa. African Journal of Aquatic Science 38, Supplement 1:49-54. &lt;a href=&#34;http://dx.doi.org/10.2989/16085914.2013.775107&#34;&gt;http://dx.doi.org/10.2989/16085914.2013.775107&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.2989/16085914.2013.775107&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;Valsecchi, V., Chase, B.M., Slingsby, J., Carr, A.S.; Quick, L.J., Meadows, M.E., Cheddadi, R. &amp;amp; Reimer, P.J. 2013. A high resolution 15,600-year pollen and microcharcoal record from the Cederberg Mountains, South Africa. Palaeogeography, Palaeoclimatology, Palaeoecology 387:6-16. &lt;a href=&#34;http://dx.doi.org/10.1016/j.palaeo.2013.07.009&#34;&gt;http://dx.doi.org/10.1016/j.palaeo.2013.07.009&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1016/j.palaeo.2013.07.009&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;Viljoen, Jan-Adriaan; Muasya, A Muthama; Barrett, Russell L; Bruhl, Jeremy J; Gibbs, Adele K; Slingsby, Jasper A; Wilson, Karen L; Verboom, G Anthony. 2013. Radiation and repeated transoceanic dispersal of Schoeneae (Cyperaceae) through the southern hemisphere. American Journal of Botany, 100, 12, 2494-2508. &lt;a href=&#34;http://dx.doi.org/10.3732/ajb.1300105&#34;&gt;http://dx.doi.org/10.3732/ajb.1300105&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.3732/ajb.1300105&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;2012&#34;&gt;2012&lt;/h4&gt;

&lt;p&gt;Schurr, F.M., Esler, K.J., Slingsby, J.A. &amp;amp; Allsopp, N. 2012. Fynbos Proteaceae as a model organism for biodiversity research and conservation. South African Journal of Science 108:10-13. &lt;a href=&#34;http://dx.doi.org/10.4102/sajs.v108i11/12.1446&#34;&gt;http://dx.doi.org/10.4102/sajs.v108i11/12.1446&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.4102/sajs.v108i11/12.1446&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;2007&#34;&gt;2007&lt;/h4&gt;

&lt;p&gt;Thuiller, Wilfried; Slingsby, Jasper A; Privett, Sean DJ; Cowling, Richard M. 2007. Stochastic species turnover and stable coexistence in a species-rich, fire-prone plant community. PloS One, 2(9) e938. &lt;a href=&#34;https://doi.org/10.1371/journal.pone.0000938&#34;&gt;https://doi.org/10.1371/journal.pone.0000938&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1371/journal.pone.0000938 &#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;2006&#34;&gt;2006&lt;/h4&gt;

&lt;p&gt;Slingsby, Jasper A; Verboom, G Anthony. 2006. Phylogenetic relatedness limits co‐occurrence at fine spatial scales: evidence from the Schoenoid sedges (Cyperaceae: Schoeneae) of the Cape Floristic Region, South Africa. The American Naturalist, 168(1): 14-27. &lt;a href=&#34;https://doi.org/10.1086/505158&#34;&gt;https://doi.org/10.1086/505158&lt;/a&gt;&lt;/p&gt;

&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1086/505158&#34; data-hide-no-mentions=&#34;true&#34; data-hide-less-than=&#34;5&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h3 id=&#34;other-publications&#34;&gt;Other publications&lt;/h3&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;Slingsby, J.A., Slingsby, P.W.O. 2012. Mountain Fynbos &lt;em&gt;in&lt;/em&gt; A World in One Cubic Foot: Portraits of Biodiversity. David Liittschwager. The University of Chicago Press, Chicago. 224 pages&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Students</title>
      <link>/students/</link>
      <pubDate>Fri, 31 Mar 2017 21:05:33 +0530</pubDate>
      
      <guid>/students/</guid>
      <description>

&lt;h2 id=&#34;current&#34;&gt;Current&lt;/h2&gt;

&lt;h3 id=&#34;phd&#34;&gt;PhD&lt;/h3&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;nasiphi-ntshanga&#34;&gt;Nasiphi Ntshanga&lt;/h4&gt;

&lt;p&gt;Nasiphi is doing her PhD with &lt;a href=&#34;https://sites.google.com/site/serbanproches/Home&#34;&gt;&lt;strong&gt;&amp;#x15E;erban Proche&amp;#351;&lt;/strong&gt;&lt;/a&gt; and I, based at the School of Agricultural, Earth and Environmental Sciences, University of KwaZulu-Natal. Nasiphi is exploring the interactions between landscape transformation and other drivers of global change and their impacts on ecological processes and biodiversity in the Cape Floristic Region. Nasiphi is Chairperson of &lt;a href=&#34;https://sites.google.com/a/saeon.ac.za/saeon-gsn/home&#34;&gt;&lt;strong&gt;SAEON&amp;rsquo;s Graduate Student Network (GSN)&lt;/strong&gt;&lt;/a&gt; and recently won the talk for &lt;a href=&#34;http://ndaba-online.ukzn.ac.za/UkzndabaStory/1170/ukzn-student-wins-award-at-global-change-conference/&#34;&gt;&lt;strong&gt;best speaker at South Africa&amp;rsquo;s Third National Conference on Global Change in Durban in 2016&lt;/strong&gt;&lt;/a&gt;.
Contact Nasiphi: nasiphidotntshangaatgmaildotcom&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;nyasha-magadzire&#34;&gt;Nyasha Magadzire&lt;/h4&gt;

&lt;p&gt;Nyasha is doing her PhD with &lt;a href=&#34;http://www0.sun.ac.za/geography/people/dr-helen-de-klerk/&#34;&gt;&lt;strong&gt;Helen De Klerk&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;https://scholar.google.co.za/citations?user=psTb5kgAAAAJ&amp;amp;hl=en&#34;&gt;&lt;strong&gt;Karen Esler&lt;/strong&gt;&lt;/a&gt; and I, based in the Geography Department at Stellenbosch University. Her PhD is focused on testing the utility of remote sensing products as measures of ecological regime in predicting the distribution of vegetation types, communities and species across the CFR.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;martina-treurnicht-https-fynbosser-wordpress-com&#34;&gt;&lt;a href=&#34;https://fynbosser.wordpress.com/&#34;&gt;Martina Treurnicht&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Martina is doing her PhD with &lt;a href=&#34;https://www.sites.google.com/site/frankschurr/home&#34;&gt;&lt;strong&gt;Frank Schurr&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;https://www.uni-hohenheim.de/en/organization/person/dr-joern-pagel#contact&#34;&gt;&lt;strong&gt;Jörn Pagel&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;https://scholar.google.co.za/citations?user=psTb5kgAAAAJ&amp;amp;hl=en&#34;&gt;&lt;strong&gt;Karen Esler&lt;/strong&gt;&lt;/a&gt; and I. Her PhD, &amp;ldquo;Demographic and functional determinants of large-scale population dynamics and ecological niches of 26 serotinous Proteaceae species in the Cape Floristic Region (CFR, South Africa)&amp;rdquo; is split between the Department of Conservation Ecology, Stellenbosch University (South Africa) and the Department Landscape and Plant Ecology, University of Hohenheim (Germany). Martina recently won the &lt;a href=&#34;http://www.britishecologicalsociety.org/publications/best-paper-by-an-early-career-researcher/harper-prize/&#34;&gt;&lt;strong&gt;Harper Prize for best paper by an early career researcher published in the Journal of Ecology in 2016&lt;/strong&gt;&lt;/a&gt; for her paper &lt;a href=&#34;http://onlinelibrary.wiley.com/doi/10.1111/1365-2745.12508/full&#34;&gt;&lt;strong&gt;Environmental drivers of demographic variation across the global geographical range of 26 plant species&lt;/strong&gt;&lt;/a&gt;. I only joined Martina&amp;rsquo;s supervision team after the paper had been submitted, but I&amp;rsquo;ll claim fame by association :)&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h3 id=&#34;msc&#34;&gt;MSc&lt;/h3&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;maphale-matlala-http-www-sanbi-org-staff-matlalam&#34;&gt;&lt;a href=&#34;http://www.sanbi.org/staff/matlalam&#34;&gt;Maphale Matlala&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Maphale has just begun her MSc with &lt;a href=&#34;http://www.stats.uct.ac.za/stats/people/academic/altwegg&#34;&gt;&lt;strong&gt;Res Altwegg&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;http://www.sanbi.org/staff/skownoa&#34;&gt;&lt;strong&gt;Andrew Skowno&lt;/strong&gt;&lt;/a&gt; and I. Maphale&amp;rsquo;s thesis will compare South Africa&amp;rsquo;s Ecosystem Threat Assessment approach with the &lt;a href=&#34;http://iucnrle.org/&#34;&gt;&lt;strong&gt;IUCN&amp;rsquo;s new Red List of Ecosystems&lt;/strong&gt;&lt;/a&gt; methodology.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;francois-becker&#34;&gt;Francois Becker&lt;/h4&gt;

&lt;p&gt;Francois is registered at the University of Cape Town, doing his MSc on &amp;ldquo;Estimating the global population size of animals that are hard to find: the case of Rose&amp;rsquo;s mountain toadlet&amp;rdquo; with &lt;a href=&#34;http://krystaltolley.wixsite.com/krystaltolley&#34;&gt;&lt;strong&gt;Krystal Tolley&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;http://www.stats.uct.ac.za/stats/people/academic/altwegg&#34;&gt;&lt;strong&gt;Res Altwegg&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;http://john.measey.com/&#34;&gt;&lt;strong&gt;John Measey&lt;/strong&gt;&lt;/a&gt; and I.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h3 id=&#34;bsc-hons&#34;&gt;BSc(Hons)&lt;/h3&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;hannah-simon&#34;&gt;Hannah Simon&lt;/h4&gt;

&lt;p&gt;Hannah is doing her BSc(Hons) at the University of Cape Town with &lt;a href=&#34;http://agwest.yolasite.com/&#34;&gt;&lt;strong&gt;Adam West&lt;/strong&gt;&lt;/a&gt; and I, looking at &lt;em&gt;Unpacking a pixel. The role of biodiversity in driving seasonal NDVI values in Fynbos&lt;/em&gt;. Her project aims to use high-resolution UAV NDVI imagery of selected sites in the fynbos coupled with vegetation surveys and satellite imagery to identify the components of the flora that show seasonal responses in NDVI.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;eleanor-weideman&#34;&gt;Eleanor Weideman&lt;/h4&gt;

&lt;p&gt;Eleanor is doing her BSc(Hons) at the University of Cape Town with &lt;a href=&#34;https://scholar.google.co.za/citations?user=sRFFlPAAAAAJ&amp;amp;hl=en&#34;&gt;&lt;strong&gt;Bernard Coetzee&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;http://www.biologicalsciences.uct.ac.za/bio/staff/academic/thomson&#34;&gt;&lt;strong&gt;Robert Thomson&lt;/strong&gt;&lt;/a&gt; and I, following up on a &lt;a href=&#34;http://onlinelibrary.wiley.com/doi/10.1002/ece3.2389/full&#34;&gt;&lt;strong&gt;study recently published&lt;/strong&gt;&lt;/a&gt; by Bernard in collaboration with Steven Chown that looked at bird diversity along a land use/land cover gradient in Limpopo province. Eleanor is using this dataset to look at changes in bird functional and phylogenetic diversity along the gradient.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h2 id=&#34;former-students&#34;&gt;Former students&lt;/h2&gt;

&lt;h3 id=&#34;postdocs&#34;&gt;Postdocs&lt;/h3&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;glenn-moncrieff-2015-2017&#34;&gt;Glenn Moncrieff 2015-2017&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://scholar.google.co.za/citations?user=_FFdaCUAAAAJ&amp;amp;hl=en&#34;&gt;&lt;strong&gt;Glenn&lt;/strong&gt;&lt;/a&gt; and I have been been working on various projects relating to Dynamic Vegetation Models, developing biodiversity monitoring tools based on remote-sensing, and scaling up between vegetation community data and broader ecosystem properties. He is currently taking a small vacation in the field of data science at &lt;a href=&#34;https://www.ixioanalytics.com/&#34;&gt;&lt;strong&gt;Ixio Analytics&lt;/strong&gt;&lt;/a&gt; before he intends to continue his domination of global ecology.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;nicola-stevens-2014-2015&#34;&gt;Nicola Stevens 2014-2015&lt;/h4&gt;

&lt;p&gt;Nicola started a postdoc working on developing Fynbos biodiversity monitoring tools based on remote-sensing and scaling up between vegetation community data and broader ecosystem properties, but moved on to a great opportunity working with &lt;a href=&#34;https://www.researchgate.net/profile/Guy_Midgley&#34;&gt;&lt;strong&gt;Prof Guy Midgley&lt;/strong&gt;&lt;/a&gt; which allowed her to persue her core interests in bush encroachment.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;christopher-trisos-2014-2015&#34;&gt;Christopher Trisos 2014-2015&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;http://www.sesync.org/users/ctrisos&#34;&gt;&lt;strong&gt;Chris&lt;/strong&gt;&lt;/a&gt; is a great and enthusiastic mind and dabbled with many projects, but never really sunk his teeth into anything. There may be a paper on dispersal rates in &lt;em&gt;Proteaceae&lt;/em&gt; coming at some stage (Chris?), but I&amp;rsquo;m not holding my breath&amp;hellip; Chris had a great opportunity to take up a joint postdoc between the &lt;a href=&#34;http://www.sesync.org/&#34;&gt;&lt;strong&gt;National Socio-Environmental Synthesis Centre (SESYNC) at the University of Maryland&lt;/strong&gt;&lt;/a&gt; and the &lt;a href=&#34;http://jetzlab.yale.edu/people/christopher-trisos&#34;&gt;&lt;strong&gt;Jetz Lab&lt;/strong&gt;&lt;/a&gt; at Yale that it would have been silly to turn down.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;genevieve-thompson-2012-2014&#34;&gt;Genevieve Thompson 2012-2014&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://www.researchgate.net/profile/Genevieve_Thompson2&#34;&gt;&lt;strong&gt;Gen&amp;rsquo;s&lt;/strong&gt;&lt;/a&gt; postdoc focused on building a genus-level phylogeny of the plants of South Africa to explore patterns of phylogenetic diversity and the evolutionary transitions required to cross biome boundaries in South Africa with &lt;a href=&#34;http://www.kew.org/science/who-we-are-and-what-we-do/people/f%C3%A9lix-forest&#34;&gt;&lt;strong&gt;Felix Forest&lt;/strong&gt;&lt;/a&gt; and &lt;a href=&#34;https://www.researchgate.net/profile/Jonathan_Colville&#34;&gt;&lt;strong&gt;Jonathan Colville&lt;/strong&gt;&lt;/a&gt;. Gen now works on genomics at the &lt;a href=&#34;http://www.arc.agric.za/Pages/Home.aspx&#34;&gt;&lt;em&gt;Agricultural Research Council in Pretoria&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h3 id=&#34;msc-1&#34;&gt;MSc&lt;/h3&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;annabelle-rogers&#34;&gt;Annabelle Rogers&lt;/h4&gt;

&lt;p&gt;Annabelle did her MSc with Prof &lt;a href=&#34;http://www.biologicalsciences.uct.ac.za/bio/staff/academic/february&#34;&gt;&lt;strong&gt;Ed February&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;https://scholar.google.co.za/citations?user=_FFdaCUAAAAJ&amp;amp;hl=en&#34;&gt;&lt;strong&gt;Glenn Moncrieff&lt;/strong&gt;&lt;/a&gt; and I. Her thesis &lt;em&gt;Modification of fire catchments drive vegetation change on the Cape Peninsula&lt;/em&gt; used fire models to explore how land cover transformation altered the flow of fire across the Cape Peninsula, showing a close corresponence between areas that now experience less risk of fire and the expansion of forest into fynbos. Annabelle recieved her MSc Cum Laude in 2017.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;kobus-kellermann&#34;&gt;Kobus Kellermann&lt;/h4&gt;

&lt;p&gt;Kobus did his MSc with Prof &lt;a href=&#34;http://www.biologicalsciences.uct.ac.za/bio/staff/academic/february&#34;&gt;&lt;strong&gt;Ed February&lt;/strong&gt;&lt;/a&gt; and I on a dissertation titled &lt;em&gt;Hydraulic trait variation in Protea repens with change in climate in space and time.&lt;/em&gt; Kobus graduated in 2016.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h4 id=&#34;christine-moore&#34;&gt;Christine Moore&lt;/h4&gt;

&lt;p&gt;Christine did her MSc at the University of Cape Town&amp;rsquo;s Percy Fitzpatrick Institute of African Ornithology and DST-NRF Centre of Excellence for Conservation Biology. Her dissertation, &lt;em&gt;Understanding Highly Pathogenic Avian influenza Outbreaks in the Western Cape Ostrich Industry: Did Network Dynamics Enhance Vulnerability?&lt;/em&gt;, was supervised by &lt;a href=&#34;https://www.coralcoe.org.au/person/gscumming&#34;&gt;&lt;strong&gt;Prof Graeme Cumming&lt;/strong&gt;&lt;/a&gt; and I.&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;h3 id=&#34;bsc-hons-1&#34;&gt;BSc(Hons)&lt;/h3&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;Nicola Rule, 2015, University of Cape Town, cosupervised with Prof &lt;a href=&#34;http://www.biologicalsciences.uct.ac.za/bio/staff/academic/february&#34;&gt;&lt;strong&gt;Ed February&lt;/strong&gt;&lt;/a&gt; on a project titled &lt;em&gt;The effects of climate change on the xylem anatomy of Protea repens&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;Thomas Morris, 2012, University of Cape Town, cosupervised with Prof Jeremy Midgley on a project titled &lt;em&gt;Monitoring the Knysna forest; species, community and forest responses&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;Wade Lane, 2011, University of Cape Town, cosupervised with Prof Terry Hedderson and Dr Claudine Ah-Peng on a project titled &lt;em&gt;What processes govern the ground bryophyte community assemblage along an altitudinal gradient on the island of La Réunion?&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;Stuart Hall, 2010, University of Cape Town, cosupervised with Prof Jeremy Midgley on a project titled &lt;em&gt;Vegetation change and vegetation type stability in the Cape of Good Hope Nature Reserve 1966–2010&lt;/em&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Get in touch</title>
      <link>/contact/</link>
      <pubDate>Sun, 06 Nov 2016 13:00:25 +0530</pubDate>
      
      <guid>/contact/</guid>
      <description></description>
    </item>
    
    <item>
      <title>About me</title>
      <link>/about/</link>
      <pubDate>Sat, 05 Nov 2016 21:05:33 +0530</pubDate>
      
      <guid>/about/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;/img/about.jpg&#34; alt=&#34;This is me&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I am an ecologist based at the &lt;a href=&#34;http://www.saeon-fynbos.org&#34;&gt;&lt;strong&gt;Fynbos Node&lt;/strong&gt;&lt;/a&gt; of the &lt;a href=&#34;http://www.saeon.ac.za/&#34;&gt;&lt;strong&gt;South African Environmental Observation Network (SAEON)&lt;/strong&gt;&lt;/a&gt;, in Cape Town.&lt;/p&gt;

&lt;p&gt;I created this (personal) site because it&amp;rsquo;s handy to be able to serve webpages for various applications and I got sick of having RPubs webpages floating all over the place.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m also considering using it as an Open Lab Book in the interests of supporting &lt;a href=&#34;https://en.wikipedia.org/wiki/Open_notebook_science&#34;&gt;&lt;strong&gt;Open Notebook Science&lt;/strong&gt;&lt;/a&gt;. There are many motivations for doing this, but primarily I believe that science should be fully transparent and repeatable. This is especially true for science that pertains to issues that affect human well-being. This is an audacious goal, and I imagine will require a fair amount of discipline and dedication, so we&amp;rsquo;ll see how well I do&amp;hellip;&lt;/p&gt;

&lt;p&gt;Lastly, but not least(ly?), I hope that this site will help me communicate my science and what I do to a broader (including non-scientific) audience. With that in mind, I hope to keep the writing as non-technical as possible (other than the R tutorials - sorry), but please forgive me if I fail dismally! Note that I include R code where relevant for those interested (mostly my students), but if you&amp;rsquo;re not interested in the code you can just ignore the code chunks and focus on the text and figures. I may just slip some nons(ci)ense in every here and there too&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>